import{useLocale as D,useKeys as N}from"@vuepress/helper/client";import{ref as p,computed as S,defineComponent as B,toRefs as F,h as n}from"vue";import{useRouter as K,useRouteLocale as U}from"vuepress/client";import{SEARCH_INDEX as j}from"@internal/searchIndex";const k=p(j),_=()=>k;__VUEPRESS_DEV__&&(import.meta.webpackHot||import.meta.hot)&&(__VUE_HMR_RUNTIME__.updateSearchIndex=e=>{k.value=e});const H=/[^\u0000-\u007F]/,P=e=>e.split(/\s+/g).map(t=>t.trim()).filter(Boolean),I=e=>e.replaceAll(/[-/\\^$*+?.()|[\]{}]/g,String.raw`\$&`),b=(e,t)=>{const c=t.join(" "),l=P(e);if(H.test(e))return l.some(o=>c.toLowerCase().includes(o));const v=e.endsWith(" ");return new RegExp(`${l.map((o,s)=>l.length===s+1&&!v?`(?=.*\\b${I(o)})`:`(?=.*\\b${I(o)}\\b)`).join("")}.+`,"gi").test(c)},E=({searchIndex:e,routeLocale:t,query:c,maxSuggestions:l})=>{const v=S(()=>e.value.filter(o=>o.pathLocale===t.value));return S(()=>{const o=c.value.trim().toLowerCase();if(!o)return[];const s=[],f=(a,u)=>{b(o,[u.title])&&s.push({link:`${a.path}#${u.slug}`,title:a.title,header:u.title});for(const i of u.children){if(s.length>=l.value)return;f(a,i)}};for(const a of v.value){if(s.length>=l.value)break;if(b(o,[a.title,...a.extraFields])){s.push({link:a.path,title:a.title});continue}for(const u of a.headers){if(s.length>=l.value)break;f(a,u)}}return s})},$=e=>{const t=p(0);return{focusIndex:t,focusNext:()=>{t.value<e.value.length-1?t.value+=1:t.value=0},focusPrev:()=>{t.value>0?t.value-=1:t.value=e.value.length-1}}},V=B({name:"SearchBox",props:{locales:{type:Object,default:()=>({})},hotKeys:Array,maxSuggestions:{type:Number,default:5}},setup(e){const{locales:t,hotKeys:c,maxSuggestions:l}=F(e),v=D(t),o=K(),s=U(),f=_(),a=p(null),u=p(!1),i=p(""),g=E({searchIndex:f,routeLocale:s,query:i,maxSuggestions:l}),{focusIndex:h,focusNext:L,focusPrev:R}=$(g);N(c,()=>{a.value?.focus()});const m=S(()=>u.value&&g.value.length>0),M=()=>{m.value&&R()},A=()=>{m.value&&L()},y=r=>{if(!m.value)return;const d=g.value[r];d&&o.push(d.link).then(()=>{i.value="",h.value=0})};return()=>n("form",{class:"search-box",role:"search"},[n("input",{ref:a,type:"search",placeholder:v.value.placeholder,autocomplete:"off",spellcheck:!1,value:i.value,onFocus:()=>{u.value=!0},onBlur:()=>{u.value=!1},onInput:r=>{i.value=r.target.value},onKeydown:r=>{switch(r.key){case"ArrowUp":{M();break}case"ArrowDown":{A();break}case"Enter":{r.preventDefault(),y(h.value);break}}}}),m.value&&n("ul",{class:"suggestions",onMouseleave:()=>{h.value=-1}},g.value.map(({link:r,title:d,header:w},x)=>n("li",{class:["suggestion",{focus:h.value===x}],onMouseenter:()=>{h.value=x},onMousedown:()=>{y(x)}},n("a",{href:r,onClick:C=>{C.preventDefault()}},[n("span",{class:"page-title"},d),w&&n("span",{class:"page-header"},`> ${w}`)]))))])}});export{V as SearchBox,b as isQueryMatched,k as searchIndex,_ as useSearchIndex,E as useSearchSuggestions,$ as useSuggestionsFocus};
//# sourceMappingURL=index.js.map
