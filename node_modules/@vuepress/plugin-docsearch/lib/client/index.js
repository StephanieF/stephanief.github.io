import{ref as h,isRef as R,computed as m,inject as $,readonly as B,defineComponent as I,onMounted as A,h as v,watch as K}from"vue";import{useRouter as O,useRouteLocale as f,useLang as L}from"vuepress/client";import{isMacOS as y,isiPad as k,deepAssign as S,isFunction as T,isiPhone as x}from"@vuepress/helper/client";import{useEventListener as F,watchImmediate as D}from"@vueuse/core";import{debounce as U}from"ts-debounce";import{removeLeadingSlash as V,resolveRoutePathFromUrl as N,isString as j}from"vuepress/shared";const q=(e,t)=>{const a=F("keydown",r=>{const{keyboardShortcuts:o={}}=e.value,n=o["Ctrl/Cmd+K"]!==!1&&r.key==="k"&&(y()||k()?r.metaKey:r.ctrlKey),c=o["/"]!==!1&&r.key==="/";(n||c)&&(r.preventDefault(),t(),a())})},H=()=>{const e=O();return{transformItems:t=>t.map(a=>({...a,url:`${__VUEPRESS_BASE__}${V(N(a.url,__DOCSEARCH_INDEX_BASE__))}`})),navigator:{navigate:({itemUrl:t})=>{e.push(t.replace(__VUEPRESS_BASE__,"/"))}},transformSearchClient:t=>({...t,search:U(t.search,500)})}},l=__DOCSEARCH_OPTIONS__,i=h(l),g=Symbol(__VUEPRESS_DEV__?"docsearch":""),M=e=>{R(e)?D(()=>e.value,t=>{i.value=S({},l,t)}):T(e)?D(m(e),t=>{i.value=S({},l,t)}):i.value=S({},l,e)},E=()=>{const e=$(g),t=f();return m(()=>({...e.value,...e.value.locales?.[t.value]}))},W=e=>{e.provide(g,B(i))},X=(e,t=[])=>[`lang:${e}`,...Array.isArray(t)?t:[t]],z=({indices:e,indexName:t,searchParameters:a},r)=>(e??[{name:t??"",searchParameters:a}]).map(o=>{if(j(o))return{name:o,searchParameters:{facetFilters:`lang:${r}`}};const{searchParameters:n,...c}=o;return{...c,searchParameters:{...n,facetFilters:X(r,n?.facetFilters)}}}),G=({buttonText:e="Search",buttonAriaLabel:t=e}={})=>{const a=!__VUEPRESS_SSR__&&(y()||k()||x());return`<button type="button" aria-label="${t}" aria-keyshortcuts="${a?"Command":"Control"}+k" class="DocSearch DocSearch-Button"><span class="DocSearch-Button-Container"><svg width="20" height="20" viewBox="0 0 24 24" aria-hidden="true" class="DocSearch-Search-Icon"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">${e}</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key ${a?"":"DocSearch-Button-Key--ctrl"}">${a?"âŒ˜":"Ctrl"}</kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button>`},b=()=>{if(document.querySelector(".DocSearch-Modal"))return;const e=new Event("keydown");e.key="k",e.metaKey=!0,window.dispatchEvent(e),setTimeout(b,16)},J=e=>{const t="algolia-preconnect";("requestIdleCallback"in window?window.requestIdleCallback:setTimeout)(()=>{if(document.head.querySelector(`#${t}`))return;const a=document.createElement("link");a.id=t,a.rel="preconnect",a.href=`https://${e}-dsn.algolia.net`,a.crossOrigin="",document.head.append(a)})},Q=I({name:"DocSearch",props:{containerId:{type:String,default:"docsearch-container"},options:{type:Object,default:()=>({})}},setup(e){const t=E(),a=H(),r=L(),o=f(),n=h(!1),c=h(!1),s=m(()=>{const{locales:u={},...d}=e.options;return{...t.value,...d,...u[o.value]}}),p=async()=>{if(__VUEPRESS_SSR__)return;const{default:u}=await import("@docsearch/js"),{indexName:d,indices:C,searchParameters:P,...w}=s.value;u({...a,...w,container:`#${e.containerId}`,indices:z({indices:C,indexName:d,searchParameters:P},r.value)}),n.value=!0},_=()=>{c.value||n.value||(c.value=!0,p(),b(),K(o,p))};return q(s,_),A(()=>{J(s.value.appId)}),()=>[v("div",{id:e.containerId,style:{display:n.value?"block":"none"}}),n.value?null:v("div",{class:"docsearch-placeholder",onClick:_,innerHTML:G(s.value.translations?.button)})]}});export{Q as DocSearch,M as defineDocSearchConfig,W as injectDocSearchConfig,E as useDocSearchOptions};
//# sourceMappingURL=index.js.map
