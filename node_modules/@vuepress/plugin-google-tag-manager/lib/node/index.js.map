{"version":3,"file":"index.js","sources":["../../src/node/googleTagManagerPlugin.ts"],"sourcesContent":["import type { Plugin, PluginObject } from 'vuepress/core'\nimport { logger } from 'vuepress/utils'\n\n/**\n * Options for @vuepress/plugin-google-tag-manager\n */\nexport interface GoogleTagManagerPluginOptions {\n  /**\n   * The Container ID of Google Tag Manager which should start with `'GTM-'`.\n   */\n  id: string\n}\n\nexport const googleTagManagerPlugin =\n  (options: GoogleTagManagerPluginOptions): Plugin =>\n  (app) => {\n    const plugin: PluginObject = {\n      name: '@vuepress/plugin-google-tag-manager',\n    }\n\n    if (!options.id) {\n      logger.warn(`[${plugin.name}] 'id' is required`)\n      return plugin\n    }\n\n    // enable plugin in build mode or debug mode\n    if (app.env.isBuild || app.env.isDebug)\n      return {\n        ...plugin,\n\n        onInitialized: () => {\n          app.options.head.push([\n            'script',\n            {},\n            `\\\n((w,d,s,l,i)=>{\\\nw[l]=w[l]||[];\\\nw[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});\\\nvar f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';\\\nj.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;\\\nf.parentNode.insertBefore(j,f);\\\n})(window,document,'script','dataLayer','${options.id}');\\\n`,\n          ])\n        },\n      }\n\n    return plugin\n  }\n"],"names":["googleTagManagerPlugin","options","app","plugin","logger"],"mappings":"wCAaa,MAAAA,EACVC,GACAC,GAAQ,CACP,MAAMC,EAAuB,CAC3B,KAAM,qCACR,EAEA,OAAKF,EAAQ,GAMTC,EAAI,IAAI,SAAWA,EAAI,IAAI,QACtB,CACL,GAAGC,EAEH,cAAe,IAAM,CACnBD,EAAI,QAAQ,KAAK,KAAK,CACpB,SACA,CACA,EAAA,gUAO+BD,EAAQ,EAAE,KAE3C,CAAC,CACH,CACF,EAEKE,GA1BLC,EAAO,KAAK,IAAID,EAAO,IAAI,oBAAoB,EACxCA,EA0BX"}