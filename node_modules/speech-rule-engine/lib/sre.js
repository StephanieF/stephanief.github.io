!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.SRE=e():t.SRE=e()}(this,()=>(()=>{var __webpack_modules__={95(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{f:()=>SystemExternal});var _variables_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(679),_lib_external_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(751);const windowSupported=!("undefined"==typeof window),documentSupported=windowSupported&&!(void 0===window.document),webworker=!("undefined"==typeof DedicatedWorkerGlobalScope),nodeRequire=()=>{try{return eval("require")}catch(t){return t=>null}},SystemExternal={extRequire:t=>"undefined"!=typeof process&&"undefined"!=typeof require?nodeRequire()(t):null,windowSupported,documentSupported,webworker,xmldom:_lib_external_js__WEBPACK_IMPORTED_MODULE_1__.Gb,document:_lib_external_js__WEBPACK_IMPORTED_MODULE_1__.Al,fs:documentSupported||webworker?null:nodeRequire()("fs"),url:_variables_js__WEBPACK_IMPORTED_MODULE_0__.u.url,jsonPath:function(){if(documentSupported||webworker)return _variables_js__WEBPACK_IMPORTED_MODULE_0__.u.url;if(process.env.SRE_JSON_PATH||__webpack_require__.g.SRE_JSON_PATH)return process.env.SRE_JSON_PATH||__webpack_require__.g.SRE_JSON_PATH;try{return nodeRequire().resolve("speech-rule-engine").replace(/sre\.js$/,"")+"mathmaps"}catch(t){}try{return nodeRequire().resolve(".").replace(/sre\.js$/,"")+"mathmaps"}catch(t){}return"undefined"!=typeof __dirname?__dirname+(__dirname.match(/lib?$/)?"/mathmaps":"/lib/mathmaps"):process.cwd()+"/lib/mathmaps"}(),xpath:_lib_external_js__WEBPACK_IMPORTED_MODULE_1__.Oe}},159(t,e,n){"use strict";var r=n(870).freeze;e.XML_ENTITIES=r({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),e.HTML_ENTITIES=r({Aacute:"\xc1",aacute:"\xe1",Abreve:"\u0102",abreve:"\u0103",ac:"\u223e",acd:"\u223f",acE:"\u223e\u0333",Acirc:"\xc2",acirc:"\xe2",acute:"\xb4",Acy:"\u0410",acy:"\u0430",AElig:"\xc6",aelig:"\xe6",af:"\u2061",Afr:"\u{1d504}",afr:"\u{1d51e}",Agrave:"\xc0",agrave:"\xe0",alefsym:"\u2135",aleph:"\u2135",Alpha:"\u0391",alpha:"\u03b1",Amacr:"\u0100",amacr:"\u0101",amalg:"\u2a3f",AMP:"&",amp:"&",And:"\u2a53",and:"\u2227",andand:"\u2a55",andd:"\u2a5c",andslope:"\u2a58",andv:"\u2a5a",ang:"\u2220",ange:"\u29a4",angle:"\u2220",angmsd:"\u2221",angmsdaa:"\u29a8",angmsdab:"\u29a9",angmsdac:"\u29aa",angmsdad:"\u29ab",angmsdae:"\u29ac",angmsdaf:"\u29ad",angmsdag:"\u29ae",angmsdah:"\u29af",angrt:"\u221f",angrtvb:"\u22be",angrtvbd:"\u299d",angsph:"\u2222",angst:"\xc5",angzarr:"\u237c",Aogon:"\u0104",aogon:"\u0105",Aopf:"\u{1d538}",aopf:"\u{1d552}",ap:"\u2248",apacir:"\u2a6f",apE:"\u2a70",ape:"\u224a",apid:"\u224b",apos:"'",ApplyFunction:"\u2061",approx:"\u2248",approxeq:"\u224a",Aring:"\xc5",aring:"\xe5",Ascr:"\u{1d49c}",ascr:"\u{1d4b6}",Assign:"\u2254",ast:"*",asymp:"\u2248",asympeq:"\u224d",Atilde:"\xc3",atilde:"\xe3",Auml:"\xc4",auml:"\xe4",awconint:"\u2233",awint:"\u2a11",backcong:"\u224c",backepsilon:"\u03f6",backprime:"\u2035",backsim:"\u223d",backsimeq:"\u22cd",Backslash:"\u2216",Barv:"\u2ae7",barvee:"\u22bd",Barwed:"\u2306",barwed:"\u2305",barwedge:"\u2305",bbrk:"\u23b5",bbrktbrk:"\u23b6",bcong:"\u224c",Bcy:"\u0411",bcy:"\u0431",bdquo:"\u201e",becaus:"\u2235",Because:"\u2235",because:"\u2235",bemptyv:"\u29b0",bepsi:"\u03f6",bernou:"\u212c",Bernoullis:"\u212c",Beta:"\u0392",beta:"\u03b2",beth:"\u2136",between:"\u226c",Bfr:"\u{1d505}",bfr:"\u{1d51f}",bigcap:"\u22c2",bigcirc:"\u25ef",bigcup:"\u22c3",bigodot:"\u2a00",bigoplus:"\u2a01",bigotimes:"\u2a02",bigsqcup:"\u2a06",bigstar:"\u2605",bigtriangledown:"\u25bd",bigtriangleup:"\u25b3",biguplus:"\u2a04",bigvee:"\u22c1",bigwedge:"\u22c0",bkarow:"\u290d",blacklozenge:"\u29eb",blacksquare:"\u25aa",blacktriangle:"\u25b4",blacktriangledown:"\u25be",blacktriangleleft:"\u25c2",blacktriangleright:"\u25b8",blank:"\u2423",blk12:"\u2592",blk14:"\u2591",blk34:"\u2593",block:"\u2588",bne:"=\u20e5",bnequiv:"\u2261\u20e5",bNot:"\u2aed",bnot:"\u2310",Bopf:"\u{1d539}",bopf:"\u{1d553}",bot:"\u22a5",bottom:"\u22a5",bowtie:"\u22c8",boxbox:"\u29c9",boxDL:"\u2557",boxDl:"\u2556",boxdL:"\u2555",boxdl:"\u2510",boxDR:"\u2554",boxDr:"\u2553",boxdR:"\u2552",boxdr:"\u250c",boxH:"\u2550",boxh:"\u2500",boxHD:"\u2566",boxHd:"\u2564",boxhD:"\u2565",boxhd:"\u252c",boxHU:"\u2569",boxHu:"\u2567",boxhU:"\u2568",boxhu:"\u2534",boxminus:"\u229f",boxplus:"\u229e",boxtimes:"\u22a0",boxUL:"\u255d",boxUl:"\u255c",boxuL:"\u255b",boxul:"\u2518",boxUR:"\u255a",boxUr:"\u2559",boxuR:"\u2558",boxur:"\u2514",boxV:"\u2551",boxv:"\u2502",boxVH:"\u256c",boxVh:"\u256b",boxvH:"\u256a",boxvh:"\u253c",boxVL:"\u2563",boxVl:"\u2562",boxvL:"\u2561",boxvl:"\u2524",boxVR:"\u2560",boxVr:"\u255f",boxvR:"\u255e",boxvr:"\u251c",bprime:"\u2035",Breve:"\u02d8",breve:"\u02d8",brvbar:"\xa6",Bscr:"\u212c",bscr:"\u{1d4b7}",bsemi:"\u204f",bsim:"\u223d",bsime:"\u22cd",bsol:"\\",bsolb:"\u29c5",bsolhsub:"\u27c8",bull:"\u2022",bullet:"\u2022",bump:"\u224e",bumpE:"\u2aae",bumpe:"\u224f",Bumpeq:"\u224e",bumpeq:"\u224f",Cacute:"\u0106",cacute:"\u0107",Cap:"\u22d2",cap:"\u2229",capand:"\u2a44",capbrcup:"\u2a49",capcap:"\u2a4b",capcup:"\u2a47",capdot:"\u2a40",CapitalDifferentialD:"\u2145",caps:"\u2229\ufe00",caret:"\u2041",caron:"\u02c7",Cayleys:"\u212d",ccaps:"\u2a4d",Ccaron:"\u010c",ccaron:"\u010d",Ccedil:"\xc7",ccedil:"\xe7",Ccirc:"\u0108",ccirc:"\u0109",Cconint:"\u2230",ccups:"\u2a4c",ccupssm:"\u2a50",Cdot:"\u010a",cdot:"\u010b",cedil:"\xb8",Cedilla:"\xb8",cemptyv:"\u29b2",cent:"\xa2",CenterDot:"\xb7",centerdot:"\xb7",Cfr:"\u212d",cfr:"\u{1d520}",CHcy:"\u0427",chcy:"\u0447",check:"\u2713",checkmark:"\u2713",Chi:"\u03a7",chi:"\u03c7",cir:"\u25cb",circ:"\u02c6",circeq:"\u2257",circlearrowleft:"\u21ba",circlearrowright:"\u21bb",circledast:"\u229b",circledcirc:"\u229a",circleddash:"\u229d",CircleDot:"\u2299",circledR:"\xae",circledS:"\u24c8",CircleMinus:"\u2296",CirclePlus:"\u2295",CircleTimes:"\u2297",cirE:"\u29c3",cire:"\u2257",cirfnint:"\u2a10",cirmid:"\u2aef",cirscir:"\u29c2",ClockwiseContourIntegral:"\u2232",CloseCurlyDoubleQuote:"\u201d",CloseCurlyQuote:"\u2019",clubs:"\u2663",clubsuit:"\u2663",Colon:"\u2237",colon:":",Colone:"\u2a74",colone:"\u2254",coloneq:"\u2254",comma:",",commat:"@",comp:"\u2201",compfn:"\u2218",complement:"\u2201",complexes:"\u2102",cong:"\u2245",congdot:"\u2a6d",Congruent:"\u2261",Conint:"\u222f",conint:"\u222e",ContourIntegral:"\u222e",Copf:"\u2102",copf:"\u{1d554}",coprod:"\u2210",Coproduct:"\u2210",COPY:"\xa9",copy:"\xa9",copysr:"\u2117",CounterClockwiseContourIntegral:"\u2233",crarr:"\u21b5",Cross:"\u2a2f",cross:"\u2717",Cscr:"\u{1d49e}",cscr:"\u{1d4b8}",csub:"\u2acf",csube:"\u2ad1",csup:"\u2ad0",csupe:"\u2ad2",ctdot:"\u22ef",cudarrl:"\u2938",cudarrr:"\u2935",cuepr:"\u22de",cuesc:"\u22df",cularr:"\u21b6",cularrp:"\u293d",Cup:"\u22d3",cup:"\u222a",cupbrcap:"\u2a48",CupCap:"\u224d",cupcap:"\u2a46",cupcup:"\u2a4a",cupdot:"\u228d",cupor:"\u2a45",cups:"\u222a\ufe00",curarr:"\u21b7",curarrm:"\u293c",curlyeqprec:"\u22de",curlyeqsucc:"\u22df",curlyvee:"\u22ce",curlywedge:"\u22cf",curren:"\xa4",curvearrowleft:"\u21b6",curvearrowright:"\u21b7",cuvee:"\u22ce",cuwed:"\u22cf",cwconint:"\u2232",cwint:"\u2231",cylcty:"\u232d",Dagger:"\u2021",dagger:"\u2020",daleth:"\u2138",Darr:"\u21a1",dArr:"\u21d3",darr:"\u2193",dash:"\u2010",Dashv:"\u2ae4",dashv:"\u22a3",dbkarow:"\u290f",dblac:"\u02dd",Dcaron:"\u010e",dcaron:"\u010f",Dcy:"\u0414",dcy:"\u0434",DD:"\u2145",dd:"\u2146",ddagger:"\u2021",ddarr:"\u21ca",DDotrahd:"\u2911",ddotseq:"\u2a77",deg:"\xb0",Del:"\u2207",Delta:"\u0394",delta:"\u03b4",demptyv:"\u29b1",dfisht:"\u297f",Dfr:"\u{1d507}",dfr:"\u{1d521}",dHar:"\u2965",dharl:"\u21c3",dharr:"\u21c2",DiacriticalAcute:"\xb4",DiacriticalDot:"\u02d9",DiacriticalDoubleAcute:"\u02dd",DiacriticalGrave:"`",DiacriticalTilde:"\u02dc",diam:"\u22c4",Diamond:"\u22c4",diamond:"\u22c4",diamondsuit:"\u2666",diams:"\u2666",die:"\xa8",DifferentialD:"\u2146",digamma:"\u03dd",disin:"\u22f2",div:"\xf7",divide:"\xf7",divideontimes:"\u22c7",divonx:"\u22c7",DJcy:"\u0402",djcy:"\u0452",dlcorn:"\u231e",dlcrop:"\u230d",dollar:"$",Dopf:"\u{1d53b}",dopf:"\u{1d555}",Dot:"\xa8",dot:"\u02d9",DotDot:"\u20dc",doteq:"\u2250",doteqdot:"\u2251",DotEqual:"\u2250",dotminus:"\u2238",dotplus:"\u2214",dotsquare:"\u22a1",doublebarwedge:"\u2306",DoubleContourIntegral:"\u222f",DoubleDot:"\xa8",DoubleDownArrow:"\u21d3",DoubleLeftArrow:"\u21d0",DoubleLeftRightArrow:"\u21d4",DoubleLeftTee:"\u2ae4",DoubleLongLeftArrow:"\u27f8",DoubleLongLeftRightArrow:"\u27fa",DoubleLongRightArrow:"\u27f9",DoubleRightArrow:"\u21d2",DoubleRightTee:"\u22a8",DoubleUpArrow:"\u21d1",DoubleUpDownArrow:"\u21d5",DoubleVerticalBar:"\u2225",DownArrow:"\u2193",Downarrow:"\u21d3",downarrow:"\u2193",DownArrowBar:"\u2913",DownArrowUpArrow:"\u21f5",DownBreve:"\u0311",downdownarrows:"\u21ca",downharpoonleft:"\u21c3",downharpoonright:"\u21c2",DownLeftRightVector:"\u2950",DownLeftTeeVector:"\u295e",DownLeftVector:"\u21bd",DownLeftVectorBar:"\u2956",DownRightTeeVector:"\u295f",DownRightVector:"\u21c1",DownRightVectorBar:"\u2957",DownTee:"\u22a4",DownTeeArrow:"\u21a7",drbkarow:"\u2910",drcorn:"\u231f",drcrop:"\u230c",Dscr:"\u{1d49f}",dscr:"\u{1d4b9}",DScy:"\u0405",dscy:"\u0455",dsol:"\u29f6",Dstrok:"\u0110",dstrok:"\u0111",dtdot:"\u22f1",dtri:"\u25bf",dtrif:"\u25be",duarr:"\u21f5",duhar:"\u296f",dwangle:"\u29a6",DZcy:"\u040f",dzcy:"\u045f",dzigrarr:"\u27ff",Eacute:"\xc9",eacute:"\xe9",easter:"\u2a6e",Ecaron:"\u011a",ecaron:"\u011b",ecir:"\u2256",Ecirc:"\xca",ecirc:"\xea",ecolon:"\u2255",Ecy:"\u042d",ecy:"\u044d",eDDot:"\u2a77",Edot:"\u0116",eDot:"\u2251",edot:"\u0117",ee:"\u2147",efDot:"\u2252",Efr:"\u{1d508}",efr:"\u{1d522}",eg:"\u2a9a",Egrave:"\xc8",egrave:"\xe8",egs:"\u2a96",egsdot:"\u2a98",el:"\u2a99",Element:"\u2208",elinters:"\u23e7",ell:"\u2113",els:"\u2a95",elsdot:"\u2a97",Emacr:"\u0112",emacr:"\u0113",empty:"\u2205",emptyset:"\u2205",EmptySmallSquare:"\u25fb",emptyv:"\u2205",EmptyVerySmallSquare:"\u25ab",emsp:"\u2003",emsp13:"\u2004",emsp14:"\u2005",ENG:"\u014a",eng:"\u014b",ensp:"\u2002",Eogon:"\u0118",eogon:"\u0119",Eopf:"\u{1d53c}",eopf:"\u{1d556}",epar:"\u22d5",eparsl:"\u29e3",eplus:"\u2a71",epsi:"\u03b5",Epsilon:"\u0395",epsilon:"\u03b5",epsiv:"\u03f5",eqcirc:"\u2256",eqcolon:"\u2255",eqsim:"\u2242",eqslantgtr:"\u2a96",eqslantless:"\u2a95",Equal:"\u2a75",equals:"=",EqualTilde:"\u2242",equest:"\u225f",Equilibrium:"\u21cc",equiv:"\u2261",equivDD:"\u2a78",eqvparsl:"\u29e5",erarr:"\u2971",erDot:"\u2253",Escr:"\u2130",escr:"\u212f",esdot:"\u2250",Esim:"\u2a73",esim:"\u2242",Eta:"\u0397",eta:"\u03b7",ETH:"\xd0",eth:"\xf0",Euml:"\xcb",euml:"\xeb",euro:"\u20ac",excl:"!",exist:"\u2203",Exists:"\u2203",expectation:"\u2130",ExponentialE:"\u2147",exponentiale:"\u2147",fallingdotseq:"\u2252",Fcy:"\u0424",fcy:"\u0444",female:"\u2640",ffilig:"\ufb03",fflig:"\ufb00",ffllig:"\ufb04",Ffr:"\u{1d509}",ffr:"\u{1d523}",filig:"\ufb01",FilledSmallSquare:"\u25fc",FilledVerySmallSquare:"\u25aa",fjlig:"fj",flat:"\u266d",fllig:"\ufb02",fltns:"\u25b1",fnof:"\u0192",Fopf:"\u{1d53d}",fopf:"\u{1d557}",ForAll:"\u2200",forall:"\u2200",fork:"\u22d4",forkv:"\u2ad9",Fouriertrf:"\u2131",fpartint:"\u2a0d",frac12:"\xbd",frac13:"\u2153",frac14:"\xbc",frac15:"\u2155",frac16:"\u2159",frac18:"\u215b",frac23:"\u2154",frac25:"\u2156",frac34:"\xbe",frac35:"\u2157",frac38:"\u215c",frac45:"\u2158",frac56:"\u215a",frac58:"\u215d",frac78:"\u215e",frasl:"\u2044",frown:"\u2322",Fscr:"\u2131",fscr:"\u{1d4bb}",gacute:"\u01f5",Gamma:"\u0393",gamma:"\u03b3",Gammad:"\u03dc",gammad:"\u03dd",gap:"\u2a86",Gbreve:"\u011e",gbreve:"\u011f",Gcedil:"\u0122",Gcirc:"\u011c",gcirc:"\u011d",Gcy:"\u0413",gcy:"\u0433",Gdot:"\u0120",gdot:"\u0121",gE:"\u2267",ge:"\u2265",gEl:"\u2a8c",gel:"\u22db",geq:"\u2265",geqq:"\u2267",geqslant:"\u2a7e",ges:"\u2a7e",gescc:"\u2aa9",gesdot:"\u2a80",gesdoto:"\u2a82",gesdotol:"\u2a84",gesl:"\u22db\ufe00",gesles:"\u2a94",Gfr:"\u{1d50a}",gfr:"\u{1d524}",Gg:"\u22d9",gg:"\u226b",ggg:"\u22d9",gimel:"\u2137",GJcy:"\u0403",gjcy:"\u0453",gl:"\u2277",gla:"\u2aa5",glE:"\u2a92",glj:"\u2aa4",gnap:"\u2a8a",gnapprox:"\u2a8a",gnE:"\u2269",gne:"\u2a88",gneq:"\u2a88",gneqq:"\u2269",gnsim:"\u22e7",Gopf:"\u{1d53e}",gopf:"\u{1d558}",grave:"`",GreaterEqual:"\u2265",GreaterEqualLess:"\u22db",GreaterFullEqual:"\u2267",GreaterGreater:"\u2aa2",GreaterLess:"\u2277",GreaterSlantEqual:"\u2a7e",GreaterTilde:"\u2273",Gscr:"\u{1d4a2}",gscr:"\u210a",gsim:"\u2273",gsime:"\u2a8e",gsiml:"\u2a90",Gt:"\u226b",GT:">",gt:">",gtcc:"\u2aa7",gtcir:"\u2a7a",gtdot:"\u22d7",gtlPar:"\u2995",gtquest:"\u2a7c",gtrapprox:"\u2a86",gtrarr:"\u2978",gtrdot:"\u22d7",gtreqless:"\u22db",gtreqqless:"\u2a8c",gtrless:"\u2277",gtrsim:"\u2273",gvertneqq:"\u2269\ufe00",gvnE:"\u2269\ufe00",Hacek:"\u02c7",hairsp:"\u200a",half:"\xbd",hamilt:"\u210b",HARDcy:"\u042a",hardcy:"\u044a",hArr:"\u21d4",harr:"\u2194",harrcir:"\u2948",harrw:"\u21ad",Hat:"^",hbar:"\u210f",Hcirc:"\u0124",hcirc:"\u0125",hearts:"\u2665",heartsuit:"\u2665",hellip:"\u2026",hercon:"\u22b9",Hfr:"\u210c",hfr:"\u{1d525}",HilbertSpace:"\u210b",hksearow:"\u2925",hkswarow:"\u2926",hoarr:"\u21ff",homtht:"\u223b",hookleftarrow:"\u21a9",hookrightarrow:"\u21aa",Hopf:"\u210d",hopf:"\u{1d559}",horbar:"\u2015",HorizontalLine:"\u2500",Hscr:"\u210b",hscr:"\u{1d4bd}",hslash:"\u210f",Hstrok:"\u0126",hstrok:"\u0127",HumpDownHump:"\u224e",HumpEqual:"\u224f",hybull:"\u2043",hyphen:"\u2010",Iacute:"\xcd",iacute:"\xed",ic:"\u2063",Icirc:"\xce",icirc:"\xee",Icy:"\u0418",icy:"\u0438",Idot:"\u0130",IEcy:"\u0415",iecy:"\u0435",iexcl:"\xa1",iff:"\u21d4",Ifr:"\u2111",ifr:"\u{1d526}",Igrave:"\xcc",igrave:"\xec",ii:"\u2148",iiiint:"\u2a0c",iiint:"\u222d",iinfin:"\u29dc",iiota:"\u2129",IJlig:"\u0132",ijlig:"\u0133",Im:"\u2111",Imacr:"\u012a",imacr:"\u012b",image:"\u2111",ImaginaryI:"\u2148",imagline:"\u2110",imagpart:"\u2111",imath:"\u0131",imof:"\u22b7",imped:"\u01b5",Implies:"\u21d2",in:"\u2208",incare:"\u2105",infin:"\u221e",infintie:"\u29dd",inodot:"\u0131",Int:"\u222c",int:"\u222b",intcal:"\u22ba",integers:"\u2124",Integral:"\u222b",intercal:"\u22ba",Intersection:"\u22c2",intlarhk:"\u2a17",intprod:"\u2a3c",InvisibleComma:"\u2063",InvisibleTimes:"\u2062",IOcy:"\u0401",iocy:"\u0451",Iogon:"\u012e",iogon:"\u012f",Iopf:"\u{1d540}",iopf:"\u{1d55a}",Iota:"\u0399",iota:"\u03b9",iprod:"\u2a3c",iquest:"\xbf",Iscr:"\u2110",iscr:"\u{1d4be}",isin:"\u2208",isindot:"\u22f5",isinE:"\u22f9",isins:"\u22f4",isinsv:"\u22f3",isinv:"\u2208",it:"\u2062",Itilde:"\u0128",itilde:"\u0129",Iukcy:"\u0406",iukcy:"\u0456",Iuml:"\xcf",iuml:"\xef",Jcirc:"\u0134",jcirc:"\u0135",Jcy:"\u0419",jcy:"\u0439",Jfr:"\u{1d50d}",jfr:"\u{1d527}",jmath:"\u0237",Jopf:"\u{1d541}",jopf:"\u{1d55b}",Jscr:"\u{1d4a5}",jscr:"\u{1d4bf}",Jsercy:"\u0408",jsercy:"\u0458",Jukcy:"\u0404",jukcy:"\u0454",Kappa:"\u039a",kappa:"\u03ba",kappav:"\u03f0",Kcedil:"\u0136",kcedil:"\u0137",Kcy:"\u041a",kcy:"\u043a",Kfr:"\u{1d50e}",kfr:"\u{1d528}",kgreen:"\u0138",KHcy:"\u0425",khcy:"\u0445",KJcy:"\u040c",kjcy:"\u045c",Kopf:"\u{1d542}",kopf:"\u{1d55c}",Kscr:"\u{1d4a6}",kscr:"\u{1d4c0}",lAarr:"\u21da",Lacute:"\u0139",lacute:"\u013a",laemptyv:"\u29b4",lagran:"\u2112",Lambda:"\u039b",lambda:"\u03bb",Lang:"\u27ea",lang:"\u27e8",langd:"\u2991",langle:"\u27e8",lap:"\u2a85",Laplacetrf:"\u2112",laquo:"\xab",Larr:"\u219e",lArr:"\u21d0",larr:"\u2190",larrb:"\u21e4",larrbfs:"\u291f",larrfs:"\u291d",larrhk:"\u21a9",larrlp:"\u21ab",larrpl:"\u2939",larrsim:"\u2973",larrtl:"\u21a2",lat:"\u2aab",lAtail:"\u291b",latail:"\u2919",late:"\u2aad",lates:"\u2aad\ufe00",lBarr:"\u290e",lbarr:"\u290c",lbbrk:"\u2772",lbrace:"{",lbrack:"[",lbrke:"\u298b",lbrksld:"\u298f",lbrkslu:"\u298d",Lcaron:"\u013d",lcaron:"\u013e",Lcedil:"\u013b",lcedil:"\u013c",lceil:"\u2308",lcub:"{",Lcy:"\u041b",lcy:"\u043b",ldca:"\u2936",ldquo:"\u201c",ldquor:"\u201e",ldrdhar:"\u2967",ldrushar:"\u294b",ldsh:"\u21b2",lE:"\u2266",le:"\u2264",LeftAngleBracket:"\u27e8",LeftArrow:"\u2190",Leftarrow:"\u21d0",leftarrow:"\u2190",LeftArrowBar:"\u21e4",LeftArrowRightArrow:"\u21c6",leftarrowtail:"\u21a2",LeftCeiling:"\u2308",LeftDoubleBracket:"\u27e6",LeftDownTeeVector:"\u2961",LeftDownVector:"\u21c3",LeftDownVectorBar:"\u2959",LeftFloor:"\u230a",leftharpoondown:"\u21bd",leftharpoonup:"\u21bc",leftleftarrows:"\u21c7",LeftRightArrow:"\u2194",Leftrightarrow:"\u21d4",leftrightarrow:"\u2194",leftrightarrows:"\u21c6",leftrightharpoons:"\u21cb",leftrightsquigarrow:"\u21ad",LeftRightVector:"\u294e",LeftTee:"\u22a3",LeftTeeArrow:"\u21a4",LeftTeeVector:"\u295a",leftthreetimes:"\u22cb",LeftTriangle:"\u22b2",LeftTriangleBar:"\u29cf",LeftTriangleEqual:"\u22b4",LeftUpDownVector:"\u2951",LeftUpTeeVector:"\u2960",LeftUpVector:"\u21bf",LeftUpVectorBar:"\u2958",LeftVector:"\u21bc",LeftVectorBar:"\u2952",lEg:"\u2a8b",leg:"\u22da",leq:"\u2264",leqq:"\u2266",leqslant:"\u2a7d",les:"\u2a7d",lescc:"\u2aa8",lesdot:"\u2a7f",lesdoto:"\u2a81",lesdotor:"\u2a83",lesg:"\u22da\ufe00",lesges:"\u2a93",lessapprox:"\u2a85",lessdot:"\u22d6",lesseqgtr:"\u22da",lesseqqgtr:"\u2a8b",LessEqualGreater:"\u22da",LessFullEqual:"\u2266",LessGreater:"\u2276",lessgtr:"\u2276",LessLess:"\u2aa1",lesssim:"\u2272",LessSlantEqual:"\u2a7d",LessTilde:"\u2272",lfisht:"\u297c",lfloor:"\u230a",Lfr:"\u{1d50f}",lfr:"\u{1d529}",lg:"\u2276",lgE:"\u2a91",lHar:"\u2962",lhard:"\u21bd",lharu:"\u21bc",lharul:"\u296a",lhblk:"\u2584",LJcy:"\u0409",ljcy:"\u0459",Ll:"\u22d8",ll:"\u226a",llarr:"\u21c7",llcorner:"\u231e",Lleftarrow:"\u21da",llhard:"\u296b",lltri:"\u25fa",Lmidot:"\u013f",lmidot:"\u0140",lmoust:"\u23b0",lmoustache:"\u23b0",lnap:"\u2a89",lnapprox:"\u2a89",lnE:"\u2268",lne:"\u2a87",lneq:"\u2a87",lneqq:"\u2268",lnsim:"\u22e6",loang:"\u27ec",loarr:"\u21fd",lobrk:"\u27e6",LongLeftArrow:"\u27f5",Longleftarrow:"\u27f8",longleftarrow:"\u27f5",LongLeftRightArrow:"\u27f7",Longleftrightarrow:"\u27fa",longleftrightarrow:"\u27f7",longmapsto:"\u27fc",LongRightArrow:"\u27f6",Longrightarrow:"\u27f9",longrightarrow:"\u27f6",looparrowleft:"\u21ab",looparrowright:"\u21ac",lopar:"\u2985",Lopf:"\u{1d543}",lopf:"\u{1d55d}",loplus:"\u2a2d",lotimes:"\u2a34",lowast:"\u2217",lowbar:"_",LowerLeftArrow:"\u2199",LowerRightArrow:"\u2198",loz:"\u25ca",lozenge:"\u25ca",lozf:"\u29eb",lpar:"(",lparlt:"\u2993",lrarr:"\u21c6",lrcorner:"\u231f",lrhar:"\u21cb",lrhard:"\u296d",lrm:"\u200e",lrtri:"\u22bf",lsaquo:"\u2039",Lscr:"\u2112",lscr:"\u{1d4c1}",Lsh:"\u21b0",lsh:"\u21b0",lsim:"\u2272",lsime:"\u2a8d",lsimg:"\u2a8f",lsqb:"[",lsquo:"\u2018",lsquor:"\u201a",Lstrok:"\u0141",lstrok:"\u0142",Lt:"\u226a",LT:"<",lt:"<",ltcc:"\u2aa6",ltcir:"\u2a79",ltdot:"\u22d6",lthree:"\u22cb",ltimes:"\u22c9",ltlarr:"\u2976",ltquest:"\u2a7b",ltri:"\u25c3",ltrie:"\u22b4",ltrif:"\u25c2",ltrPar:"\u2996",lurdshar:"\u294a",luruhar:"\u2966",lvertneqq:"\u2268\ufe00",lvnE:"\u2268\ufe00",macr:"\xaf",male:"\u2642",malt:"\u2720",maltese:"\u2720",Map:"\u2905",map:"\u21a6",mapsto:"\u21a6",mapstodown:"\u21a7",mapstoleft:"\u21a4",mapstoup:"\u21a5",marker:"\u25ae",mcomma:"\u2a29",Mcy:"\u041c",mcy:"\u043c",mdash:"\u2014",mDDot:"\u223a",measuredangle:"\u2221",MediumSpace:"\u205f",Mellintrf:"\u2133",Mfr:"\u{1d510}",mfr:"\u{1d52a}",mho:"\u2127",micro:"\xb5",mid:"\u2223",midast:"*",midcir:"\u2af0",middot:"\xb7",minus:"\u2212",minusb:"\u229f",minusd:"\u2238",minusdu:"\u2a2a",MinusPlus:"\u2213",mlcp:"\u2adb",mldr:"\u2026",mnplus:"\u2213",models:"\u22a7",Mopf:"\u{1d544}",mopf:"\u{1d55e}",mp:"\u2213",Mscr:"\u2133",mscr:"\u{1d4c2}",mstpos:"\u223e",Mu:"\u039c",mu:"\u03bc",multimap:"\u22b8",mumap:"\u22b8",nabla:"\u2207",Nacute:"\u0143",nacute:"\u0144",nang:"\u2220\u20d2",nap:"\u2249",napE:"\u2a70\u0338",napid:"\u224b\u0338",napos:"\u0149",napprox:"\u2249",natur:"\u266e",natural:"\u266e",naturals:"\u2115",nbsp:"\xa0",nbump:"\u224e\u0338",nbumpe:"\u224f\u0338",ncap:"\u2a43",Ncaron:"\u0147",ncaron:"\u0148",Ncedil:"\u0145",ncedil:"\u0146",ncong:"\u2247",ncongdot:"\u2a6d\u0338",ncup:"\u2a42",Ncy:"\u041d",ncy:"\u043d",ndash:"\u2013",ne:"\u2260",nearhk:"\u2924",neArr:"\u21d7",nearr:"\u2197",nearrow:"\u2197",nedot:"\u2250\u0338",NegativeMediumSpace:"\u200b",NegativeThickSpace:"\u200b",NegativeThinSpace:"\u200b",NegativeVeryThinSpace:"\u200b",nequiv:"\u2262",nesear:"\u2928",nesim:"\u2242\u0338",NestedGreaterGreater:"\u226b",NestedLessLess:"\u226a",NewLine:"\n",nexist:"\u2204",nexists:"\u2204",Nfr:"\u{1d511}",nfr:"\u{1d52b}",ngE:"\u2267\u0338",nge:"\u2271",ngeq:"\u2271",ngeqq:"\u2267\u0338",ngeqslant:"\u2a7e\u0338",nges:"\u2a7e\u0338",nGg:"\u22d9\u0338",ngsim:"\u2275",nGt:"\u226b\u20d2",ngt:"\u226f",ngtr:"\u226f",nGtv:"\u226b\u0338",nhArr:"\u21ce",nharr:"\u21ae",nhpar:"\u2af2",ni:"\u220b",nis:"\u22fc",nisd:"\u22fa",niv:"\u220b",NJcy:"\u040a",njcy:"\u045a",nlArr:"\u21cd",nlarr:"\u219a",nldr:"\u2025",nlE:"\u2266\u0338",nle:"\u2270",nLeftarrow:"\u21cd",nleftarrow:"\u219a",nLeftrightarrow:"\u21ce",nleftrightarrow:"\u21ae",nleq:"\u2270",nleqq:"\u2266\u0338",nleqslant:"\u2a7d\u0338",nles:"\u2a7d\u0338",nless:"\u226e",nLl:"\u22d8\u0338",nlsim:"\u2274",nLt:"\u226a\u20d2",nlt:"\u226e",nltri:"\u22ea",nltrie:"\u22ec",nLtv:"\u226a\u0338",nmid:"\u2224",NoBreak:"\u2060",NonBreakingSpace:"\xa0",Nopf:"\u2115",nopf:"\u{1d55f}",Not:"\u2aec",not:"\xac",NotCongruent:"\u2262",NotCupCap:"\u226d",NotDoubleVerticalBar:"\u2226",NotElement:"\u2209",NotEqual:"\u2260",NotEqualTilde:"\u2242\u0338",NotExists:"\u2204",NotGreater:"\u226f",NotGreaterEqual:"\u2271",NotGreaterFullEqual:"\u2267\u0338",NotGreaterGreater:"\u226b\u0338",NotGreaterLess:"\u2279",NotGreaterSlantEqual:"\u2a7e\u0338",NotGreaterTilde:"\u2275",NotHumpDownHump:"\u224e\u0338",NotHumpEqual:"\u224f\u0338",notin:"\u2209",notindot:"\u22f5\u0338",notinE:"\u22f9\u0338",notinva:"\u2209",notinvb:"\u22f7",notinvc:"\u22f6",NotLeftTriangle:"\u22ea",NotLeftTriangleBar:"\u29cf\u0338",NotLeftTriangleEqual:"\u22ec",NotLess:"\u226e",NotLessEqual:"\u2270",NotLessGreater:"\u2278",NotLessLess:"\u226a\u0338",NotLessSlantEqual:"\u2a7d\u0338",NotLessTilde:"\u2274",NotNestedGreaterGreater:"\u2aa2\u0338",NotNestedLessLess:"\u2aa1\u0338",notni:"\u220c",notniva:"\u220c",notnivb:"\u22fe",notnivc:"\u22fd",NotPrecedes:"\u2280",NotPrecedesEqual:"\u2aaf\u0338",NotPrecedesSlantEqual:"\u22e0",NotReverseElement:"\u220c",NotRightTriangle:"\u22eb",NotRightTriangleBar:"\u29d0\u0338",NotRightTriangleEqual:"\u22ed",NotSquareSubset:"\u228f\u0338",NotSquareSubsetEqual:"\u22e2",NotSquareSuperset:"\u2290\u0338",NotSquareSupersetEqual:"\u22e3",NotSubset:"\u2282\u20d2",NotSubsetEqual:"\u2288",NotSucceeds:"\u2281",NotSucceedsEqual:"\u2ab0\u0338",NotSucceedsSlantEqual:"\u22e1",NotSucceedsTilde:"\u227f\u0338",NotSuperset:"\u2283\u20d2",NotSupersetEqual:"\u2289",NotTilde:"\u2241",NotTildeEqual:"\u2244",NotTildeFullEqual:"\u2247",NotTildeTilde:"\u2249",NotVerticalBar:"\u2224",npar:"\u2226",nparallel:"\u2226",nparsl:"\u2afd\u20e5",npart:"\u2202\u0338",npolint:"\u2a14",npr:"\u2280",nprcue:"\u22e0",npre:"\u2aaf\u0338",nprec:"\u2280",npreceq:"\u2aaf\u0338",nrArr:"\u21cf",nrarr:"\u219b",nrarrc:"\u2933\u0338",nrarrw:"\u219d\u0338",nRightarrow:"\u21cf",nrightarrow:"\u219b",nrtri:"\u22eb",nrtrie:"\u22ed",nsc:"\u2281",nsccue:"\u22e1",nsce:"\u2ab0\u0338",Nscr:"\u{1d4a9}",nscr:"\u{1d4c3}",nshortmid:"\u2224",nshortparallel:"\u2226",nsim:"\u2241",nsime:"\u2244",nsimeq:"\u2244",nsmid:"\u2224",nspar:"\u2226",nsqsube:"\u22e2",nsqsupe:"\u22e3",nsub:"\u2284",nsubE:"\u2ac5\u0338",nsube:"\u2288",nsubset:"\u2282\u20d2",nsubseteq:"\u2288",nsubseteqq:"\u2ac5\u0338",nsucc:"\u2281",nsucceq:"\u2ab0\u0338",nsup:"\u2285",nsupE:"\u2ac6\u0338",nsupe:"\u2289",nsupset:"\u2283\u20d2",nsupseteq:"\u2289",nsupseteqq:"\u2ac6\u0338",ntgl:"\u2279",Ntilde:"\xd1",ntilde:"\xf1",ntlg:"\u2278",ntriangleleft:"\u22ea",ntrianglelefteq:"\u22ec",ntriangleright:"\u22eb",ntrianglerighteq:"\u22ed",Nu:"\u039d",nu:"\u03bd",num:"#",numero:"\u2116",numsp:"\u2007",nvap:"\u224d\u20d2",nVDash:"\u22af",nVdash:"\u22ae",nvDash:"\u22ad",nvdash:"\u22ac",nvge:"\u2265\u20d2",nvgt:">\u20d2",nvHarr:"\u2904",nvinfin:"\u29de",nvlArr:"\u2902",nvle:"\u2264\u20d2",nvlt:"<\u20d2",nvltrie:"\u22b4\u20d2",nvrArr:"\u2903",nvrtrie:"\u22b5\u20d2",nvsim:"\u223c\u20d2",nwarhk:"\u2923",nwArr:"\u21d6",nwarr:"\u2196",nwarrow:"\u2196",nwnear:"\u2927",Oacute:"\xd3",oacute:"\xf3",oast:"\u229b",ocir:"\u229a",Ocirc:"\xd4",ocirc:"\xf4",Ocy:"\u041e",ocy:"\u043e",odash:"\u229d",Odblac:"\u0150",odblac:"\u0151",odiv:"\u2a38",odot:"\u2299",odsold:"\u29bc",OElig:"\u0152",oelig:"\u0153",ofcir:"\u29bf",Ofr:"\u{1d512}",ofr:"\u{1d52c}",ogon:"\u02db",Ograve:"\xd2",ograve:"\xf2",ogt:"\u29c1",ohbar:"\u29b5",ohm:"\u03a9",oint:"\u222e",olarr:"\u21ba",olcir:"\u29be",olcross:"\u29bb",oline:"\u203e",olt:"\u29c0",Omacr:"\u014c",omacr:"\u014d",Omega:"\u03a9",omega:"\u03c9",Omicron:"\u039f",omicron:"\u03bf",omid:"\u29b6",ominus:"\u2296",Oopf:"\u{1d546}",oopf:"\u{1d560}",opar:"\u29b7",OpenCurlyDoubleQuote:"\u201c",OpenCurlyQuote:"\u2018",operp:"\u29b9",oplus:"\u2295",Or:"\u2a54",or:"\u2228",orarr:"\u21bb",ord:"\u2a5d",order:"\u2134",orderof:"\u2134",ordf:"\xaa",ordm:"\xba",origof:"\u22b6",oror:"\u2a56",orslope:"\u2a57",orv:"\u2a5b",oS:"\u24c8",Oscr:"\u{1d4aa}",oscr:"\u2134",Oslash:"\xd8",oslash:"\xf8",osol:"\u2298",Otilde:"\xd5",otilde:"\xf5",Otimes:"\u2a37",otimes:"\u2297",otimesas:"\u2a36",Ouml:"\xd6",ouml:"\xf6",ovbar:"\u233d",OverBar:"\u203e",OverBrace:"\u23de",OverBracket:"\u23b4",OverParenthesis:"\u23dc",par:"\u2225",para:"\xb6",parallel:"\u2225",parsim:"\u2af3",parsl:"\u2afd",part:"\u2202",PartialD:"\u2202",Pcy:"\u041f",pcy:"\u043f",percnt:"%",period:".",permil:"\u2030",perp:"\u22a5",pertenk:"\u2031",Pfr:"\u{1d513}",pfr:"\u{1d52d}",Phi:"\u03a6",phi:"\u03c6",phiv:"\u03d5",phmmat:"\u2133",phone:"\u260e",Pi:"\u03a0",pi:"\u03c0",pitchfork:"\u22d4",piv:"\u03d6",planck:"\u210f",planckh:"\u210e",plankv:"\u210f",plus:"+",plusacir:"\u2a23",plusb:"\u229e",pluscir:"\u2a22",plusdo:"\u2214",plusdu:"\u2a25",pluse:"\u2a72",PlusMinus:"\xb1",plusmn:"\xb1",plussim:"\u2a26",plustwo:"\u2a27",pm:"\xb1",Poincareplane:"\u210c",pointint:"\u2a15",Popf:"\u2119",popf:"\u{1d561}",pound:"\xa3",Pr:"\u2abb",pr:"\u227a",prap:"\u2ab7",prcue:"\u227c",prE:"\u2ab3",pre:"\u2aaf",prec:"\u227a",precapprox:"\u2ab7",preccurlyeq:"\u227c",Precedes:"\u227a",PrecedesEqual:"\u2aaf",PrecedesSlantEqual:"\u227c",PrecedesTilde:"\u227e",preceq:"\u2aaf",precnapprox:"\u2ab9",precneqq:"\u2ab5",precnsim:"\u22e8",precsim:"\u227e",Prime:"\u2033",prime:"\u2032",primes:"\u2119",prnap:"\u2ab9",prnE:"\u2ab5",prnsim:"\u22e8",prod:"\u220f",Product:"\u220f",profalar:"\u232e",profline:"\u2312",profsurf:"\u2313",prop:"\u221d",Proportion:"\u2237",Proportional:"\u221d",propto:"\u221d",prsim:"\u227e",prurel:"\u22b0",Pscr:"\u{1d4ab}",pscr:"\u{1d4c5}",Psi:"\u03a8",psi:"\u03c8",puncsp:"\u2008",Qfr:"\u{1d514}",qfr:"\u{1d52e}",qint:"\u2a0c",Qopf:"\u211a",qopf:"\u{1d562}",qprime:"\u2057",Qscr:"\u{1d4ac}",qscr:"\u{1d4c6}",quaternions:"\u210d",quatint:"\u2a16",quest:"?",questeq:"\u225f",QUOT:'"',quot:'"',rAarr:"\u21db",race:"\u223d\u0331",Racute:"\u0154",racute:"\u0155",radic:"\u221a",raemptyv:"\u29b3",Rang:"\u27eb",rang:"\u27e9",rangd:"\u2992",range:"\u29a5",rangle:"\u27e9",raquo:"\xbb",Rarr:"\u21a0",rArr:"\u21d2",rarr:"\u2192",rarrap:"\u2975",rarrb:"\u21e5",rarrbfs:"\u2920",rarrc:"\u2933",rarrfs:"\u291e",rarrhk:"\u21aa",rarrlp:"\u21ac",rarrpl:"\u2945",rarrsim:"\u2974",Rarrtl:"\u2916",rarrtl:"\u21a3",rarrw:"\u219d",rAtail:"\u291c",ratail:"\u291a",ratio:"\u2236",rationals:"\u211a",RBarr:"\u2910",rBarr:"\u290f",rbarr:"\u290d",rbbrk:"\u2773",rbrace:"}",rbrack:"]",rbrke:"\u298c",rbrksld:"\u298e",rbrkslu:"\u2990",Rcaron:"\u0158",rcaron:"\u0159",Rcedil:"\u0156",rcedil:"\u0157",rceil:"\u2309",rcub:"}",Rcy:"\u0420",rcy:"\u0440",rdca:"\u2937",rdldhar:"\u2969",rdquo:"\u201d",rdquor:"\u201d",rdsh:"\u21b3",Re:"\u211c",real:"\u211c",realine:"\u211b",realpart:"\u211c",reals:"\u211d",rect:"\u25ad",REG:"\xae",reg:"\xae",ReverseElement:"\u220b",ReverseEquilibrium:"\u21cb",ReverseUpEquilibrium:"\u296f",rfisht:"\u297d",rfloor:"\u230b",Rfr:"\u211c",rfr:"\u{1d52f}",rHar:"\u2964",rhard:"\u21c1",rharu:"\u21c0",rharul:"\u296c",Rho:"\u03a1",rho:"\u03c1",rhov:"\u03f1",RightAngleBracket:"\u27e9",RightArrow:"\u2192",Rightarrow:"\u21d2",rightarrow:"\u2192",RightArrowBar:"\u21e5",RightArrowLeftArrow:"\u21c4",rightarrowtail:"\u21a3",RightCeiling:"\u2309",RightDoubleBracket:"\u27e7",RightDownTeeVector:"\u295d",RightDownVector:"\u21c2",RightDownVectorBar:"\u2955",RightFloor:"\u230b",rightharpoondown:"\u21c1",rightharpoonup:"\u21c0",rightleftarrows:"\u21c4",rightleftharpoons:"\u21cc",rightrightarrows:"\u21c9",rightsquigarrow:"\u219d",RightTee:"\u22a2",RightTeeArrow:"\u21a6",RightTeeVector:"\u295b",rightthreetimes:"\u22cc",RightTriangle:"\u22b3",RightTriangleBar:"\u29d0",RightTriangleEqual:"\u22b5",RightUpDownVector:"\u294f",RightUpTeeVector:"\u295c",RightUpVector:"\u21be",RightUpVectorBar:"\u2954",RightVector:"\u21c0",RightVectorBar:"\u2953",ring:"\u02da",risingdotseq:"\u2253",rlarr:"\u21c4",rlhar:"\u21cc",rlm:"\u200f",rmoust:"\u23b1",rmoustache:"\u23b1",rnmid:"\u2aee",roang:"\u27ed",roarr:"\u21fe",robrk:"\u27e7",ropar:"\u2986",Ropf:"\u211d",ropf:"\u{1d563}",roplus:"\u2a2e",rotimes:"\u2a35",RoundImplies:"\u2970",rpar:")",rpargt:"\u2994",rppolint:"\u2a12",rrarr:"\u21c9",Rrightarrow:"\u21db",rsaquo:"\u203a",Rscr:"\u211b",rscr:"\u{1d4c7}",Rsh:"\u21b1",rsh:"\u21b1",rsqb:"]",rsquo:"\u2019",rsquor:"\u2019",rthree:"\u22cc",rtimes:"\u22ca",rtri:"\u25b9",rtrie:"\u22b5",rtrif:"\u25b8",rtriltri:"\u29ce",RuleDelayed:"\u29f4",ruluhar:"\u2968",rx:"\u211e",Sacute:"\u015a",sacute:"\u015b",sbquo:"\u201a",Sc:"\u2abc",sc:"\u227b",scap:"\u2ab8",Scaron:"\u0160",scaron:"\u0161",sccue:"\u227d",scE:"\u2ab4",sce:"\u2ab0",Scedil:"\u015e",scedil:"\u015f",Scirc:"\u015c",scirc:"\u015d",scnap:"\u2aba",scnE:"\u2ab6",scnsim:"\u22e9",scpolint:"\u2a13",scsim:"\u227f",Scy:"\u0421",scy:"\u0441",sdot:"\u22c5",sdotb:"\u22a1",sdote:"\u2a66",searhk:"\u2925",seArr:"\u21d8",searr:"\u2198",searrow:"\u2198",sect:"\xa7",semi:";",seswar:"\u2929",setminus:"\u2216",setmn:"\u2216",sext:"\u2736",Sfr:"\u{1d516}",sfr:"\u{1d530}",sfrown:"\u2322",sharp:"\u266f",SHCHcy:"\u0429",shchcy:"\u0449",SHcy:"\u0428",shcy:"\u0448",ShortDownArrow:"\u2193",ShortLeftArrow:"\u2190",shortmid:"\u2223",shortparallel:"\u2225",ShortRightArrow:"\u2192",ShortUpArrow:"\u2191",shy:"\xad",Sigma:"\u03a3",sigma:"\u03c3",sigmaf:"\u03c2",sigmav:"\u03c2",sim:"\u223c",simdot:"\u2a6a",sime:"\u2243",simeq:"\u2243",simg:"\u2a9e",simgE:"\u2aa0",siml:"\u2a9d",simlE:"\u2a9f",simne:"\u2246",simplus:"\u2a24",simrarr:"\u2972",slarr:"\u2190",SmallCircle:"\u2218",smallsetminus:"\u2216",smashp:"\u2a33",smeparsl:"\u29e4",smid:"\u2223",smile:"\u2323",smt:"\u2aaa",smte:"\u2aac",smtes:"\u2aac\ufe00",SOFTcy:"\u042c",softcy:"\u044c",sol:"/",solb:"\u29c4",solbar:"\u233f",Sopf:"\u{1d54a}",sopf:"\u{1d564}",spades:"\u2660",spadesuit:"\u2660",spar:"\u2225",sqcap:"\u2293",sqcaps:"\u2293\ufe00",sqcup:"\u2294",sqcups:"\u2294\ufe00",Sqrt:"\u221a",sqsub:"\u228f",sqsube:"\u2291",sqsubset:"\u228f",sqsubseteq:"\u2291",sqsup:"\u2290",sqsupe:"\u2292",sqsupset:"\u2290",sqsupseteq:"\u2292",squ:"\u25a1",Square:"\u25a1",square:"\u25a1",SquareIntersection:"\u2293",SquareSubset:"\u228f",SquareSubsetEqual:"\u2291",SquareSuperset:"\u2290",SquareSupersetEqual:"\u2292",SquareUnion:"\u2294",squarf:"\u25aa",squf:"\u25aa",srarr:"\u2192",Sscr:"\u{1d4ae}",sscr:"\u{1d4c8}",ssetmn:"\u2216",ssmile:"\u2323",sstarf:"\u22c6",Star:"\u22c6",star:"\u2606",starf:"\u2605",straightepsilon:"\u03f5",straightphi:"\u03d5",strns:"\xaf",Sub:"\u22d0",sub:"\u2282",subdot:"\u2abd",subE:"\u2ac5",sube:"\u2286",subedot:"\u2ac3",submult:"\u2ac1",subnE:"\u2acb",subne:"\u228a",subplus:"\u2abf",subrarr:"\u2979",Subset:"\u22d0",subset:"\u2282",subseteq:"\u2286",subseteqq:"\u2ac5",SubsetEqual:"\u2286",subsetneq:"\u228a",subsetneqq:"\u2acb",subsim:"\u2ac7",subsub:"\u2ad5",subsup:"\u2ad3",succ:"\u227b",succapprox:"\u2ab8",succcurlyeq:"\u227d",Succeeds:"\u227b",SucceedsEqual:"\u2ab0",SucceedsSlantEqual:"\u227d",SucceedsTilde:"\u227f",succeq:"\u2ab0",succnapprox:"\u2aba",succneqq:"\u2ab6",succnsim:"\u22e9",succsim:"\u227f",SuchThat:"\u220b",Sum:"\u2211",sum:"\u2211",sung:"\u266a",Sup:"\u22d1",sup:"\u2283",sup1:"\xb9",sup2:"\xb2",sup3:"\xb3",supdot:"\u2abe",supdsub:"\u2ad8",supE:"\u2ac6",supe:"\u2287",supedot:"\u2ac4",Superset:"\u2283",SupersetEqual:"\u2287",suphsol:"\u27c9",suphsub:"\u2ad7",suplarr:"\u297b",supmult:"\u2ac2",supnE:"\u2acc",supne:"\u228b",supplus:"\u2ac0",Supset:"\u22d1",supset:"\u2283",supseteq:"\u2287",supseteqq:"\u2ac6",supsetneq:"\u228b",supsetneqq:"\u2acc",supsim:"\u2ac8",supsub:"\u2ad4",supsup:"\u2ad6",swarhk:"\u2926",swArr:"\u21d9",swarr:"\u2199",swarrow:"\u2199",swnwar:"\u292a",szlig:"\xdf",Tab:"\t",target:"\u2316",Tau:"\u03a4",tau:"\u03c4",tbrk:"\u23b4",Tcaron:"\u0164",tcaron:"\u0165",Tcedil:"\u0162",tcedil:"\u0163",Tcy:"\u0422",tcy:"\u0442",tdot:"\u20db",telrec:"\u2315",Tfr:"\u{1d517}",tfr:"\u{1d531}",there4:"\u2234",Therefore:"\u2234",therefore:"\u2234",Theta:"\u0398",theta:"\u03b8",thetasym:"\u03d1",thetav:"\u03d1",thickapprox:"\u2248",thicksim:"\u223c",ThickSpace:"\u205f\u200a",thinsp:"\u2009",ThinSpace:"\u2009",thkap:"\u2248",thksim:"\u223c",THORN:"\xde",thorn:"\xfe",Tilde:"\u223c",tilde:"\u02dc",TildeEqual:"\u2243",TildeFullEqual:"\u2245",TildeTilde:"\u2248",times:"\xd7",timesb:"\u22a0",timesbar:"\u2a31",timesd:"\u2a30",tint:"\u222d",toea:"\u2928",top:"\u22a4",topbot:"\u2336",topcir:"\u2af1",Topf:"\u{1d54b}",topf:"\u{1d565}",topfork:"\u2ada",tosa:"\u2929",tprime:"\u2034",TRADE:"\u2122",trade:"\u2122",triangle:"\u25b5",triangledown:"\u25bf",triangleleft:"\u25c3",trianglelefteq:"\u22b4",triangleq:"\u225c",triangleright:"\u25b9",trianglerighteq:"\u22b5",tridot:"\u25ec",trie:"\u225c",triminus:"\u2a3a",TripleDot:"\u20db",triplus:"\u2a39",trisb:"\u29cd",tritime:"\u2a3b",trpezium:"\u23e2",Tscr:"\u{1d4af}",tscr:"\u{1d4c9}",TScy:"\u0426",tscy:"\u0446",TSHcy:"\u040b",tshcy:"\u045b",Tstrok:"\u0166",tstrok:"\u0167",twixt:"\u226c",twoheadleftarrow:"\u219e",twoheadrightarrow:"\u21a0",Uacute:"\xda",uacute:"\xfa",Uarr:"\u219f",uArr:"\u21d1",uarr:"\u2191",Uarrocir:"\u2949",Ubrcy:"\u040e",ubrcy:"\u045e",Ubreve:"\u016c",ubreve:"\u016d",Ucirc:"\xdb",ucirc:"\xfb",Ucy:"\u0423",ucy:"\u0443",udarr:"\u21c5",Udblac:"\u0170",udblac:"\u0171",udhar:"\u296e",ufisht:"\u297e",Ufr:"\u{1d518}",ufr:"\u{1d532}",Ugrave:"\xd9",ugrave:"\xf9",uHar:"\u2963",uharl:"\u21bf",uharr:"\u21be",uhblk:"\u2580",ulcorn:"\u231c",ulcorner:"\u231c",ulcrop:"\u230f",ultri:"\u25f8",Umacr:"\u016a",umacr:"\u016b",uml:"\xa8",UnderBar:"_",UnderBrace:"\u23df",UnderBracket:"\u23b5",UnderParenthesis:"\u23dd",Union:"\u22c3",UnionPlus:"\u228e",Uogon:"\u0172",uogon:"\u0173",Uopf:"\u{1d54c}",uopf:"\u{1d566}",UpArrow:"\u2191",Uparrow:"\u21d1",uparrow:"\u2191",UpArrowBar:"\u2912",UpArrowDownArrow:"\u21c5",UpDownArrow:"\u2195",Updownarrow:"\u21d5",updownarrow:"\u2195",UpEquilibrium:"\u296e",upharpoonleft:"\u21bf",upharpoonright:"\u21be",uplus:"\u228e",UpperLeftArrow:"\u2196",UpperRightArrow:"\u2197",Upsi:"\u03d2",upsi:"\u03c5",upsih:"\u03d2",Upsilon:"\u03a5",upsilon:"\u03c5",UpTee:"\u22a5",UpTeeArrow:"\u21a5",upuparrows:"\u21c8",urcorn:"\u231d",urcorner:"\u231d",urcrop:"\u230e",Uring:"\u016e",uring:"\u016f",urtri:"\u25f9",Uscr:"\u{1d4b0}",uscr:"\u{1d4ca}",utdot:"\u22f0",Utilde:"\u0168",utilde:"\u0169",utri:"\u25b5",utrif:"\u25b4",uuarr:"\u21c8",Uuml:"\xdc",uuml:"\xfc",uwangle:"\u29a7",vangrt:"\u299c",varepsilon:"\u03f5",varkappa:"\u03f0",varnothing:"\u2205",varphi:"\u03d5",varpi:"\u03d6",varpropto:"\u221d",vArr:"\u21d5",varr:"\u2195",varrho:"\u03f1",varsigma:"\u03c2",varsubsetneq:"\u228a\ufe00",varsubsetneqq:"\u2acb\ufe00",varsupsetneq:"\u228b\ufe00",varsupsetneqq:"\u2acc\ufe00",vartheta:"\u03d1",vartriangleleft:"\u22b2",vartriangleright:"\u22b3",Vbar:"\u2aeb",vBar:"\u2ae8",vBarv:"\u2ae9",Vcy:"\u0412",vcy:"\u0432",VDash:"\u22ab",Vdash:"\u22a9",vDash:"\u22a8",vdash:"\u22a2",Vdashl:"\u2ae6",Vee:"\u22c1",vee:"\u2228",veebar:"\u22bb",veeeq:"\u225a",vellip:"\u22ee",Verbar:"\u2016",verbar:"|",Vert:"\u2016",vert:"|",VerticalBar:"\u2223",VerticalLine:"|",VerticalSeparator:"\u2758",VerticalTilde:"\u2240",VeryThinSpace:"\u200a",Vfr:"\u{1d519}",vfr:"\u{1d533}",vltri:"\u22b2",vnsub:"\u2282\u20d2",vnsup:"\u2283\u20d2",Vopf:"\u{1d54d}",vopf:"\u{1d567}",vprop:"\u221d",vrtri:"\u22b3",Vscr:"\u{1d4b1}",vscr:"\u{1d4cb}",vsubnE:"\u2acb\ufe00",vsubne:"\u228a\ufe00",vsupnE:"\u2acc\ufe00",vsupne:"\u228b\ufe00",Vvdash:"\u22aa",vzigzag:"\u299a",Wcirc:"\u0174",wcirc:"\u0175",wedbar:"\u2a5f",Wedge:"\u22c0",wedge:"\u2227",wedgeq:"\u2259",weierp:"\u2118",Wfr:"\u{1d51a}",wfr:"\u{1d534}",Wopf:"\u{1d54e}",wopf:"\u{1d568}",wp:"\u2118",wr:"\u2240",wreath:"\u2240",Wscr:"\u{1d4b2}",wscr:"\u{1d4cc}",xcap:"\u22c2",xcirc:"\u25ef",xcup:"\u22c3",xdtri:"\u25bd",Xfr:"\u{1d51b}",xfr:"\u{1d535}",xhArr:"\u27fa",xharr:"\u27f7",Xi:"\u039e",xi:"\u03be",xlArr:"\u27f8",xlarr:"\u27f5",xmap:"\u27fc",xnis:"\u22fb",xodot:"\u2a00",Xopf:"\u{1d54f}",xopf:"\u{1d569}",xoplus:"\u2a01",xotime:"\u2a02",xrArr:"\u27f9",xrarr:"\u27f6",Xscr:"\u{1d4b3}",xscr:"\u{1d4cd}",xsqcup:"\u2a06",xuplus:"\u2a04",xutri:"\u25b3",xvee:"\u22c1",xwedge:"\u22c0",Yacute:"\xdd",yacute:"\xfd",YAcy:"\u042f",yacy:"\u044f",Ycirc:"\u0176",ycirc:"\u0177",Ycy:"\u042b",ycy:"\u044b",yen:"\xa5",Yfr:"\u{1d51c}",yfr:"\u{1d536}",YIcy:"\u0407",yicy:"\u0457",Yopf:"\u{1d550}",yopf:"\u{1d56a}",Yscr:"\u{1d4b4}",yscr:"\u{1d4ce}",YUcy:"\u042e",yucy:"\u044e",Yuml:"\u0178",yuml:"\xff",Zacute:"\u0179",zacute:"\u017a",Zcaron:"\u017d",zcaron:"\u017e",Zcy:"\u0417",zcy:"\u0437",Zdot:"\u017b",zdot:"\u017c",zeetrf:"\u2128",ZeroWidthSpace:"\u200b",Zeta:"\u0396",zeta:"\u03b6",Zfr:"\u2128",zfr:"\u{1d537}",ZHcy:"\u0416",zhcy:"\u0436",zigrarr:"\u21dd",Zopf:"\u2124",zopf:"\u{1d56b}",Zscr:"\u{1d4b5}",zscr:"\u{1d4cf}",zwj:"\u200d",zwnj:"\u200c"}),e.entityMap=e.HTML_ENTITIES},546(t,e,n){"use strict";var r=n(870);e.assign=r.assign,e.hasDefaultHTMLNamespace=r.hasDefaultHTMLNamespace,e.isHTMLMimeType=r.isHTMLMimeType,e.isValidMimeType=r.isValidMimeType,e.MIME_TYPE=r.MIME_TYPE,e.NAMESPACE=r.NAMESPACE;var o=n(767);e.DOMException=o.DOMException,e.DOMExceptionName=o.DOMExceptionName,e.ExceptionCode=o.ExceptionCode,e.ParseError=o.ParseError;var i=n(786);e.Attr=i.Attr,e.CDATASection=i.CDATASection,e.CharacterData=i.CharacterData,e.Comment=i.Comment,e.Document=i.Document,e.DocumentFragment=i.DocumentFragment,e.DocumentType=i.DocumentType,e.DOMImplementation=i.DOMImplementation,e.Element=i.Element,e.Entity=i.Entity,e.EntityReference=i.EntityReference,e.LiveNodeList=i.LiveNodeList,e.NamedNodeMap=i.NamedNodeMap,e.Node=i.Node,e.NodeList=i.NodeList,e.Notation=i.Notation,e.ProcessingInstruction=i.ProcessingInstruction,e.Text=i.Text,e.XMLSerializer=i.XMLSerializer;var s=n(576);e.DOMParser=s.DOMParser,e.normalizeLineEndings=s.normalizeLineEndings,e.onErrorStopParsing=s.onErrorStopParsing,e.onWarningStopParsing=s.onWarningStopParsing},576(t,e,n){"use strict";var r=n(870),o=n(786),i=n(767),s=n(159),a=n(802),c=o.DOMImplementation,l=r.hasDefaultHTMLNamespace,u=r.isHTMLMimeType,h=r.isValidMimeType,d=r.MIME_TYPE,p=r.NAMESPACE,f=i.ParseError,m=a.XMLReader;function g(t){return t.replace(/\r[\n\u0085]/g,"\n").replace(/[\r\u0085\u2028\u2029]/g,"\n")}function E(t){if(void 0===(t=t||{}).locator&&(t.locator=!0),this.assign=t.assign||r.assign,this.domHandler=t.domHandler||N,this.onError=t.onError||t.errorHandler,t.errorHandler&&"function"!=typeof t.errorHandler)throw new TypeError("errorHandler object is no longer supported, switch to onError!");t.errorHandler&&t.errorHandler("warning","The `errorHandler` option has been deprecated, use `onError` instead!",this),this.normalizeLineEndings=t.normalizeLineEndings||g,this.locator=!!t.locator,this.xmlns=this.assign(Object.create(null),t.xmlns)}function N(t){var e=t||{};this.mimeType=e.mimeType||d.XML_APPLICATION,this.defaultNamespace=e.defaultNamespace||null,this.cdata=!1,this.currentElement=void 0,this.doc=void 0,this.locator=void 0,this.onError=e.onError}function S(t,e){e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber}function T(t,e,n){return"string"==typeof t?t.substr(e,n):t.length>=e+n||e?new java.lang.String(t,e,n)+"":t}function I(t,e){t.currentElement?t.currentElement.appendChild(e):t.doc.appendChild(e)}E.prototype.parseFromString=function(t,e){if(!h(e))throw new TypeError('DOMParser.parseFromString: the provided mimeType "'+e+'" is not valid.');var n=this.assign(Object.create(null),this.xmlns),o=s.XML_ENTITIES,i=n[""]||null;l(e)?(o=s.HTML_ENTITIES,i=p.HTML):e===d.XML_SVG_IMAGE&&(i=p.SVG),n[""]=i,n.xml=n.xml||p.XML;var a=new this.domHandler({mimeType:e,defaultNamespace:i,onError:this.onError}),c=this.locator?{}:void 0;this.locator&&a.setDocumentLocator(c);var u=new m;return u.errorHandler=a,u.domBuilder=a,!r.isHTMLMimeType(e)&&"string"!=typeof t&&u.errorHandler.fatalError("source is not a string"),u.parse(this.normalizeLineEndings(String(t)),n,o),a.doc.documentElement||u.errorHandler.fatalError("missing root element"),a.doc},N.prototype={startDocument:function(){var t=new c;this.doc=u(this.mimeType)?t.createHTMLDocument(!1):t.createDocument(this.defaultNamespace,"")},startElement:function(t,e,n,r){var o=this.doc,i=o.createElementNS(t,n||e),s=r.length;I(this,i),this.currentElement=i,this.locator&&S(this.locator,i);for(var a=0;a<s;a++){t=r.getURI(a);var c=r.getValue(a),l=(n=r.getQName(a),o.createAttributeNS(t,n));this.locator&&S(r.getLocator(a),l),l.value=l.nodeValue=c,i.setAttributeNode(l)}},endElement:function(t,e,n){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(t,e){},endPrefixMapping:function(t){},processingInstruction:function(t,e){var n=this.doc.createProcessingInstruction(t,e);this.locator&&S(this.locator,n),I(this,n)},ignorableWhitespace:function(t,e,n){},characters:function(t,e,n){if(t=T.apply(this,arguments)){if(this.cdata)var r=this.doc.createCDATASection(t);else r=this.doc.createTextNode(t);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(t)&&this.doc.appendChild(r),this.locator&&S(this.locator,r)}},skippedEntity:function(t){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(t){t&&(t.lineNumber=0),this.locator=t},comment:function(t,e,n){t=T.apply(this,arguments);var r=this.doc.createComment(t);this.locator&&S(this.locator,r),I(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(t,e,n,r){var o=this.doc.implementation;if(o&&o.createDocumentType){var i=o.createDocumentType(t,e,n,r);this.locator&&S(this.locator,i),I(this,i),this.doc.doctype=i}},reportError:function(t,e){if("function"==typeof this.onError)try{this.onError(t,e,this)}catch(n){throw new f("Reporting "+t+' "'+e+'" caused '+n,this.locator)}else console.error("[xmldom "+t+"]\t"+e,function(t){if(t)return"\n@#[line:"+t.lineNumber+",col:"+t.columnNumber+"]"}(this.locator))},warning:function(t){this.reportError("warning",t)},error:function(t){this.reportError("error",t)},fatalError:function(t){throw this.reportError("fatalError",t),new f(t,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(t){N.prototype[t]=function(){return null}}),e.__DOMHandler=N,e.DOMParser=E,e.normalizeLineEndings=g,e.onErrorStopParsing=function(t){if("error"===t)throw"onErrorStopParsing"},e.onWarningStopParsing=function(){throw"onWarningStopParsing"}},679(t,e,n){"use strict";n.d(e,{u:()=>r});class r{static ensureLocale(t,e){return r.LOCALES.get(t)?t:(console.error(`Locale ${t} does not exist! Using ${r.LOCALES.get(e)} instead.`),e)}}r.VERSION="5.0.0-beta.6",r.LOCALES=new Map([["af","Afrikaans"],["ca","Catalan"],["da","Danish"],["de","German"],["en","English"],["es","Spanish"],["euro","Euro"],["fr","French"],["hi","Hindi"],["it","Italian"],["ko","Korean"],["nb","Bokm\xe5l"],["nn","Nynorsk"],["sv","Swedish"],["nemeth","Nemeth"]]),r.mathjaxVersion="4.0.0",r.url="https://cdn.jsdelivr.net/npm/speech-rule-engine@"+r.VERSION+"/lib/mathmaps"},731(t,e){"use strict";function n(t){try{"function"!=typeof t&&(t=RegExp);var e=new t("\u{1d306}","u").exec("\u{1d306}");return!!e&&2===e[0].length}catch(t){}return!1}var r=n();function o(t){if("["!==t.source[0])throw new Error(t+" can not be used with chars");return t.source.slice(1,t.source.lastIndexOf("]"))}function i(t,e){if("["!==t.source[0])throw new Error("/"+t.source+"/ can not be used with chars_without");if(!e||"string"!=typeof e)throw new Error(JSON.stringify(e)+" is not a valid search");if(-1===t.source.indexOf(e))throw new Error('"'+e+'" is not is /'+t.source+"/");if("-"===e&&1!==t.source.indexOf(e))throw new Error('"'+e+'" is not at the first postion of /'+t.source+"/");return new RegExp(t.source.replace(e,""),r?"u":"")}function s(t){var e=this;return new RegExp(Array.prototype.slice.call(arguments).map(function(t){var n="string"==typeof t;if(n&&void 0===e&&"|"===t)throw new Error("use regg instead of reg to wrap expressions with `|`!");return n?t:t.source}).join(""),r?"mu":"m")}function a(t){if(0===arguments.length)throw new Error("no parameters provided");return s.apply(a,["(?:"].concat(Array.prototype.slice.call(arguments),[")"]))}var c=/[-\x09\x0A\x0D\x20-\x2C\x2E-\uD7FF\uE000-\uFFFD]/;r&&(c=s("[",o(c),"\\u{10000}-\\u{10FFFF}","]"));var l=/[\x20\x09\x0D\x0A]/,u=o(l),h=s(l,"+"),d=s(l,"*"),p=/[:_a-zA-Z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;r&&(p=s("[",o(p),"\\u{10000}-\\u{10FFFF}","]"));var f=s("[",o(p),o(/[-.0-9\xB7]/),o(/[\u0300-\u036F\u203F-\u2040]/),"]"),m=s(p,f,"*"),g=s(f,"+"),E=s("&",m,";"),N=a(/&#[0-9]+;|&#x[0-9a-fA-F]+;/),S=a(E,"|",N),T=s("%",m,";"),I=a(s('"',a(/[^%&"]/,"|",T,"|",S),"*",'"'),"|",s("'",a(/[^%&']/,"|",T,"|",S),"*","'")),A=a('"',a(/[^<&"]/,"|",S),"*",'"',"|","'",a(/[^<&']/,"|",S),"*","'"),b=s(i(p,":"),i(f,":"),"*"),R=s(b,a(":",b),"?"),O=s("^",R,"$"),y=s("(",R,")"),C=a(/"[^"]*"|'[^']*'/),L=s(/^<\?/,"(",m,")",a(h,"(",c,"*?)"),"?",/\?>/),M=/[\x20\x0D\x0Aa-zA-Z0-9-'()+,./:=?;!*#@$_%]/,_=a('"',M,'*"',"|","'",i(M,"'"),"*'"),v="\x3c!--",w=s(v,a(i(c,"-"),"|",s("-",i(c,"-"))),"*","--\x3e"),D="#PCDATA",P=a(s(/\(/,d,D,a(d,/\|/,d,R),"*",d,/\)\*/),"|",s(/\(/,d,D,d,/\)/)),x=a("EMPTY","|","ANY","|",P,"|",s(/\([^>]+\)/,/[?*+]?/)),U=s("<!ELEMENT",h,a(R,"|",T),h,a(x,"|",T),d,">"),F=s("NOTATION",h,/\(/,d,m,a(d,/\|/,d,m),"*",d,/\)/),k=s(/\(/,d,g,a(d,/\|/,d,g),"*",d,/\)/),B=a(F,"|",k),G=a(/CDATA|ID|IDREF|IDREFS|ENTITY|ENTITIES|NMTOKEN|NMTOKENS/,"|",B),V=a(/#REQUIRED|#IMPLIED/,"|",a(a("#FIXED",h),"?",A)),H=s("<!ATTLIST",h,m,a(h,m,h,G,h,V),"*",d,">"),j="about:legacy-compat",q=a('"'+j+'"',"|","'"+j+"'"),$="SYSTEM",Y="PUBLIC",X=a(a($,h,C),"|",a(Y,h,_,h,C)),W=s("^",a(a($,h,"(?<SystemLiteralOnly>",C,")"),"|",a(Y,h,"(?<PubidLiteral>",_,")",h,"(?<SystemLiteral>",C,")"))),K=a(h,"NDATA",h,m),z="<!ENTITY",Q=s(z,h,m,h,a(I,"|",a(X,K,"?")),d,">"),J=a(I,"|",X),Z=a(Q,"|",s(z,h,"%",h,m,h,J,d,">")),tt=s(Y,h,_),et=s("<!NOTATION",h,m,h,a(X,"|",tt),d,">"),nt=s(d,"=",d),rt=/1[.]\d+/,ot=s(h,"version",nt,a("'",rt,"'","|",'"',rt,'"')),it=/[A-Za-z][-A-Za-z0-9._]*/,st=s(/^<\?xml/,ot,a(h,"encoding",nt,a('"',it,'"',"|","'",it,"'")),"?",a(h,"standalone",nt,a("'",a("yes","|","no"),"'","|",'"',a("yes","|","no"),'"')),"?",d,/\?>/),at=s(c,"*?",/\]\]>/),ct=s(/<!\[CDATA\[/,at);e.chars=o,e.chars_without=i,e.detectUnicodeSupport=n,e.reg=s,e.regg=a,e.ABOUT_LEGACY_COMPAT=j,e.ABOUT_LEGACY_COMPAT_SystemLiteral=q,e.AttlistDecl=H,e.CDATA_START="<![CDATA[",e.CDATA_END="]]>",e.CDSect=ct,e.Char=c,e.Comment=w,e.COMMENT_START=v,e.COMMENT_END="--\x3e",e.DOCTYPE_DECL_START="<!DOCTYPE",e.elementdecl=U,e.EntityDecl=Z,e.EntityValue=I,e.ExternalID=X,e.ExternalID_match=W,e.Name=m,e.NotationDecl=et,e.Reference=S,e.PEReference=T,e.PI=L,e.PUBLIC=Y,e.PubidLiteral=_,e.QName=R,e.QName_exact=O,e.QName_group=y,e.S=h,e.SChar_s=u,e.S_OPT=d,e.SYSTEM=$,e.SystemLiteral=C,e.UNICODE_REPLACEMENT_CHARACTER="\ufffd",e.UNICODE_SUPPORT=r,e.XMLDecl=st},751(t,e,n){"use strict";var r,o;n.d(e,{Al:()=>c,Gb:()=>a,Oe:()=>h});var i=n(546),s=n(999);const a=r||(r=n.t(i,2)),c=(new a.DOMImplementation).createDocument("",""),l=(null===(o||(o=n.t(s,2)))||void 0===(o||(o=n.t(s,2)))?void 0:s.install)||window.wgxpath.install,u=function(){const t={document:{},XPathResult:{}};return l(t),t.document.XPathResult=t.XPathResult,t.document}(),h={currentDocument:c,evaluate:u.evaluate,result:u.XPathResult,createNSResolver:u.createNSResolver}},767(t,e,n){"use strict";function r(t,e){t.prototype=Object.create(Error.prototype,{constructor:{value:t},name:{value:t.name,enumerable:!0,writable:e}})}var o=n(870).freeze({Error:"Error",IndexSizeError:"IndexSizeError",DomstringSizeError:"DomstringSizeError",HierarchyRequestError:"HierarchyRequestError",WrongDocumentError:"WrongDocumentError",InvalidCharacterError:"InvalidCharacterError",NoDataAllowedError:"NoDataAllowedError",NoModificationAllowedError:"NoModificationAllowedError",NotFoundError:"NotFoundError",NotSupportedError:"NotSupportedError",InUseAttributeError:"InUseAttributeError",InvalidStateError:"InvalidStateError",SyntaxError:"SyntaxError",InvalidModificationError:"InvalidModificationError",NamespaceError:"NamespaceError",InvalidAccessError:"InvalidAccessError",ValidationError:"ValidationError",TypeMismatchError:"TypeMismatchError",SecurityError:"SecurityError",NetworkError:"NetworkError",AbortError:"AbortError",URLMismatchError:"URLMismatchError",QuotaExceededError:"QuotaExceededError",TimeoutError:"TimeoutError",InvalidNodeTypeError:"InvalidNodeTypeError",DataCloneError:"DataCloneError",EncodingError:"EncodingError",NotReadableError:"NotReadableError",UnknownError:"UnknownError",ConstraintError:"ConstraintError",DataError:"DataError",TransactionInactiveError:"TransactionInactiveError",ReadOnlyError:"ReadOnlyError",VersionError:"VersionError",OperationError:"OperationError",NotAllowedError:"NotAllowedError",OptOutError:"OptOutError"}),i=Object.keys(o);function s(t){return"number"==typeof t&&t>=1&&t<=25}function a(t,e){var n;s(t)?(this.name=i[t],this.message=e||""):(this.message=t,this.name="string"==typeof(n=e)&&n.substring(n.length-o.Error.length)===o.Error?e:o.Error),Error.captureStackTrace&&Error.captureStackTrace(this,a)}r(a,!0),Object.defineProperties(a.prototype,{code:{enumerable:!0,get:function(){var t=i.indexOf(this.name);return s(t)?t:0}}});for(var c={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25},l=Object.entries(c),u=0;u<l.length;u++){a[l[u][0]]=l[u][1]}function h(t,e){this.message=t,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,h)}r(h),e.DOMException=a,e.DOMExceptionName=o,e.ExceptionCode=c,e.ParseError=h},786(t,e,n){"use strict";var r=n(870),o=r.find,i=r.hasDefaultHTMLNamespace,s=r.hasOwn,a=r.isHTMLMimeType,c=r.isHTMLRawTextElement,l=r.isHTMLVoidElement,u=r.MIME_TYPE,h=r.NAMESPACE,d=Symbol(),p=n(767),f=p.DOMException,m=p.DOMExceptionName,g=n(731);function E(t){if(t!==d)throw new TypeError("Illegal constructor")}function N(t){return""!==t}function S(t,e){return s(t,e)||(t[e]=!0),t}function T(t){if(!t)return[];var e=function(t){return t?t.split(/[\t\n\f\r ]+/).filter(N):[]}(t);return Object.keys(e.reduce(S,{}))}function I(t){if(!g.QName_exact.test(t))throw new f(f.INVALID_CHARACTER_ERR,'invalid character in qualified name "'+t+'"')}function A(t,e){I(e),t=t||null;var n=null,o=e;if(e.indexOf(":")>=0){var i=e.split(":");n=i[0],o=i[1]}if(null!==n&&null===t)throw new f(f.NAMESPACE_ERR,"prefix is non-null and namespace is null");if("xml"===n&&t!==r.NAMESPACE.XML)throw new f(f.NAMESPACE_ERR,'prefix is "xml" and namespace is not the XML namespace');if(("xmlns"===n||"xmlns"===e)&&t!==r.NAMESPACE.XMLNS)throw new f(f.NAMESPACE_ERR,'either qualifiedName or prefix is "xmlns" and namespace is not the XMLNS namespace');if(t===r.NAMESPACE.XMLNS&&"xmlns"!==n&&"xmlns"!==e)throw new f(f.NAMESPACE_ERR,'namespace is the XMLNS namespace and neither qualifiedName nor prefix is "xmlns"');return[t,n,o]}function b(t,e){for(var n in t)s(t,n)&&(e[n]=t[n])}function R(t,e){var n=t.prototype;if(!(n instanceof e)){function r(){}r.prototype=e.prototype,b(n,r=new r),t.prototype=n=r}n.constructor!=t&&("function"!=typeof t&&console.error("unknown Class:"+t),n.constructor=t)}var O={},y=O.ELEMENT_NODE=1,C=O.ATTRIBUTE_NODE=2,L=O.TEXT_NODE=3,M=O.CDATA_SECTION_NODE=4,_=O.ENTITY_REFERENCE_NODE=5,v=O.ENTITY_NODE=6,w=O.PROCESSING_INSTRUCTION_NODE=7,D=O.COMMENT_NODE=8,P=O.DOCUMENT_NODE=9,x=O.DOCUMENT_TYPE_NODE=10,U=O.DOCUMENT_FRAGMENT_NODE=11,F=O.NOTATION_NODE=12,k=r.freeze({DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32});function B(t,e){if(e.length<t.length)return B(e,t);var n=null;for(var r in t){if(t[r]!==e[r])return n;n=t[r]}return n}function G(t){return t.guid||(t.guid=Math.random()),t.guid}function V(){}function H(t,e){this._node=t,this._refresh=e,j(this)}function j(t){var e=t._node._inc||t._node.ownerDocument._inc;if(t._inc!==e){var n=t._refresh(t._node);if(_t(t,"length",n.length),!t.$$length||n.length<t.$$length)for(var r=n.length;r in t;r++)s(t,r)&&delete t[r];b(n,t),t._inc=e}}function q(){}function $(t,e){for(var n=0;n<t.length;){if(t[n]===e)return n;n++}}function Y(t,e,n,r){if(r?e[$(e,r)]=n:(e[e.length]=n,e.length++),t){n.ownerElement=t;var o=t.ownerDocument;o&&(r&&Z(o,t,r),function(t,e,n){t&&t._inc++;var r=n.namespaceURI;r===h.XMLNS&&(e._nsMap[n.prefix?n.localName:""]=n.value)}(o,t,n))}}function X(t,e,n){var r=$(e,n);if(r>=0){for(var o=e.length-1;r<=o;)e[r]=e[++r];if(e.length=o,t){var i=t.ownerDocument;i&&Z(i,t,n),n.ownerElement=null}}}function W(){}function K(t){E(t)}function z(t){return("<"==t?"&lt;":">"==t&&"&gt;")||"&"==t&&"&amp;"||'"'==t&&"&quot;"||"&#"+t.charCodeAt()+";"}function Q(t,e){if(e(t))return!0;if(t=t.firstChild)do{if(Q(t,e))return!0}while(t=t.nextSibling)}function J(t,e){E(t);var n=e||{};this.ownerDocument=this,this.contentType=n.contentType||u.XML_APPLICATION,this.type=a(this.contentType)?"html":"xml"}function Z(t,e,n,r){t&&t._inc++,n.namespaceURI===h.XMLNS&&delete e._nsMap[n.prefix?n.localName:""]}function tt(t,e,n){if(t&&t._inc){t._inc++;var r=e.childNodes;if(n&&!n.nextSibling)r[r.length++]=n;else{for(var o=e.firstChild,i=0;o;)r[i++]=o,o=o.nextSibling;r.length=i,delete r[r.length]}}}function et(t,e){if(t!==e.parentNode)throw new f(f.NOT_FOUND_ERR,"child's parent is not parent");var n=e.previousSibling,r=e.nextSibling;return n?n.nextSibling=r:t.firstChild=r,r?r.previousSibling=n:t.lastChild=n,tt(t.ownerDocument,t),e.parentNode=null,e.previousSibling=null,e.nextSibling=null,e}function nt(t){return t&&t.nodeType===K.DOCUMENT_TYPE_NODE}function rt(t){return t&&t.nodeType===K.ELEMENT_NODE}function ot(t){return t&&t.nodeType===K.TEXT_NODE}function it(t,e){var n=t.childNodes||[];if(o(n,rt)||nt(e))return!1;var r=o(n,nt);return!(e&&r&&n.indexOf(r)>n.indexOf(e))}function st(t,e){var n=t.childNodes||[];if(o(n,function(t){return rt(t)&&t!==e}))return!1;var r=o(n,nt);return!(e&&r&&n.indexOf(r)>n.indexOf(e))}function at(t,e,n){if(!function(t){return t&&(t.nodeType===K.DOCUMENT_NODE||t.nodeType===K.DOCUMENT_FRAGMENT_NODE||t.nodeType===K.ELEMENT_NODE)}(t))throw new f(f.HIERARCHY_REQUEST_ERR,"Unexpected parent node type "+t.nodeType);if(n&&n.parentNode!==t)throw new f(f.NOT_FOUND_ERR,"child not in parent");if(!function(t){return t&&(t.nodeType===K.CDATA_SECTION_NODE||t.nodeType===K.COMMENT_NODE||t.nodeType===K.DOCUMENT_FRAGMENT_NODE||t.nodeType===K.DOCUMENT_TYPE_NODE||t.nodeType===K.ELEMENT_NODE||t.nodeType===K.PROCESSING_INSTRUCTION_NODE||t.nodeType===K.TEXT_NODE)}(e)||nt(e)&&t.nodeType!==K.DOCUMENT_NODE)throw new f(f.HIERARCHY_REQUEST_ERR,"Unexpected node type "+e.nodeType+" for parent node type "+t.nodeType)}function ct(t,e,n){var r=t.childNodes||[],i=e.childNodes||[];if(e.nodeType===K.DOCUMENT_FRAGMENT_NODE){var s=i.filter(rt);if(s.length>1||o(i,ot))throw new f(f.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(1===s.length&&!it(t,n))throw new f(f.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(rt(e)&&!it(t,n))throw new f(f.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(nt(e)){if(o(r,nt))throw new f(f.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var a=o(r,rt);if(n&&r.indexOf(a)<r.indexOf(n))throw new f(f.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element");if(!n&&a)throw new f(f.HIERARCHY_REQUEST_ERR,"Doctype can not be appended since element is present")}}function lt(t,e,n){var r=t.childNodes||[],i=e.childNodes||[];if(e.nodeType===K.DOCUMENT_FRAGMENT_NODE){var s=i.filter(rt);if(s.length>1||o(i,ot))throw new f(f.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(1===s.length&&!st(t,n))throw new f(f.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(rt(e)&&!st(t,n))throw new f(f.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(nt(e)){function c(t){return nt(t)&&t!==n}if(o(r,c))throw new f(f.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var a=o(r,rt);if(n&&r.indexOf(a)<r.indexOf(n))throw new f(f.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element")}}function ut(t,e,n,r){at(t,e,n),t.nodeType===K.DOCUMENT_NODE&&(r||ct)(t,e,n);var o=e.parentNode;if(o&&o.removeChild(e),e.nodeType===U){var i=e.firstChild;if(null==i)return e;var s=e.lastChild}else i=s=e;var a=n?n.previousSibling:t.lastChild;i.previousSibling=a,s.nextSibling=n,a?a.nextSibling=i:t.firstChild=i,null==n?t.lastChild=s:n.previousSibling=s;do{i.parentNode=t}while(i!==s&&(i=i.nextSibling));return tt(t.ownerDocument||t,t,e),e.nodeType==U&&(e.firstChild=e.lastChild=null),e}function ht(t){E(t),this._nsMap=Object.create(null)}function dt(t){E(t),this.namespaceURI=null,this.prefix=null,this.ownerElement=null}function pt(t){E(t)}function ft(t){E(t)}function mt(t){E(t)}function gt(t){E(t)}function Et(t){E(t)}function Nt(t){E(t)}function St(t){E(t)}function Tt(t){E(t)}function It(t){E(t)}function At(t){E(t)}function bt(){}function Rt(t){var e=[],n=this.nodeType===P&&this.documentElement||this,r=n.prefix,o=n.namespaceURI;if(o&&null==r&&null==(r=n.lookupPrefix(o)))var i=[{namespace:o,prefix:null}];return Ct(this,e,t,i),e.join("")}function Ot(t,e,n){var r=t.prefix||"",o=t.namespaceURI;if(!o)return!1;if("xml"===r&&o===h.XML||o===h.XMLNS)return!1;for(var i=n.length;i--;){var s=n[i];if(s.prefix===r)return s.namespace!==o}return!0}function yt(t,e,n){t.push(" ",e,'="',n.replace(/[<>&"\t\n\r]/g,z),'"')}function Ct(t,e,n,r){r||(r=[]);var o="html"===(t.nodeType===P?t:t.ownerDocument).type;if(n){if(!(t=n(t)))return;if("string"==typeof t)return void e.push(t)}switch(t.nodeType){case y:var i=t.attributes,s=i.length,a=t.firstChild,u=t.tagName,d=u;if(!o&&!t.prefix&&t.namespaceURI){for(var p,f=0;f<i.length;f++)if("xmlns"===i.item(f).name){p=i.item(f).value;break}if(!p)for(var m=r.length-1;m>=0;m--){if(""===(E=r[m]).prefix&&E.namespace===t.namespaceURI){p=E.namespace;break}}if(p!==t.namespaceURI)for(m=r.length-1;m>=0;m--){var E;if((E=r[m]).namespace===t.namespaceURI){E.prefix&&(d=E.prefix+":"+u);break}}}e.push("<",d);for(var N=0;N<s;N++){"xmlns"==(S=i.item(N)).prefix?r.push({prefix:S.localName,namespace:S.value}):"xmlns"==S.nodeName&&r.push({prefix:"",namespace:S.value})}for(N=0;N<s;N++){var S,T,I;if(Ot(S=i.item(N),0,r))yt(e,(T=S.prefix||"")?"xmlns:"+T:"xmlns",I=S.namespaceURI),r.push({prefix:T,namespace:I});Ct(S,e,n,r)}if(u===d&&Ot(t,0,r))yt(e,(T=t.prefix||"")?"xmlns:"+T:"xmlns",I=t.namespaceURI),r.push({prefix:T,namespace:I});var A=!a;if(A&&(o||t.namespaceURI===h.HTML)&&(A=l(u)),A)e.push("/>");else{if(e.push(">"),o&&c(u))for(;a;)a.data?e.push(a.data):Ct(a,e,n,r.slice()),a=a.nextSibling;else for(;a;)Ct(a,e,n,r.slice()),a=a.nextSibling;e.push("</",d,">")}return;case P:case U:for(a=t.firstChild;a;)Ct(a,e,n,r.slice()),a=a.nextSibling;return;case C:return yt(e,t.name,t.value);case L:return e.push(t.data.replace(/[<&>]/g,z));case M:return e.push(g.CDATA_START,t.data,g.CDATA_END);case D:return e.push(g.COMMENT_START,t.data,g.COMMENT_END);case x:var b=t.publicId,R=t.systemId;return e.push(g.DOCTYPE_DECL_START," ",t.name),b?(e.push(" ",g.PUBLIC," ",b),R&&"."!==R&&e.push(" ",R)):R&&"."!==R&&e.push(" ",g.SYSTEM," ",R),t.internalSubset&&e.push(" [",t.internalSubset,"]"),void e.push(">");case w:return e.push("<?",t.target," ",t.data,"?>");case _:return e.push("&",t.nodeName,";");default:e.push("??",t.nodeName)}}function Lt(t,e,n){var r;switch(e.nodeType){case y:(r=e.cloneNode(!1)).ownerDocument=t;case U:break;case C:n=!0}if(r||(r=e.cloneNode(!1)),r.ownerDocument=t,r.parentNode=null,n)for(var o=e.firstChild;o;)r.appendChild(Lt(t,o,n)),o=o.nextSibling;return r}function Mt(t,e,n){var r=new e.constructor(d);for(var o in e)if(s(e,o)){var i=e[o];"object"!=typeof i&&i!=r[o]&&(r[o]=i)}switch(e.childNodes&&(r.childNodes=new V),r.ownerDocument=t,r.nodeType){case y:var a=e.attributes,c=r.attributes=new q,l=a.length;c._ownerElement=r;for(var u=0;u<l;u++)r.setAttributeNode(Mt(t,a.item(u),!0));break;case C:n=!0}if(n)for(var h=e.firstChild;h;)r.appendChild(Mt(t,h,n)),h=h.nextSibling;return r}function _t(t,e,n){t[e]=n}V.prototype={length:0,item:function(t){return t>=0&&t<this.length?this[t]:null},toString:function(t){for(var e=[],n=0;n<this.length;n++)Ct(this[n],e,t);return e.join("")},filter:function(t){return Array.prototype.filter.call(this,t)},indexOf:function(t){return Array.prototype.indexOf.call(this,t)}},V.prototype[Symbol.iterator]=function(){var t=this,e=0;return{next:function(){return e<t.length?{value:t[e++],done:!1}:{done:!0}},return:function(){return{done:!0}}}},H.prototype.item=function(t){return j(this),this[t]||null},R(H,V),q.prototype={length:0,item:V.prototype.item,getNamedItem:function(t){this._ownerElement&&this._ownerElement._isInHTMLDocumentAndNamespace()&&(t=t.toLowerCase());for(var e=0;e<this.length;){var n=this[e];if(n.nodeName===t)return n;e++}return null},setNamedItem:function(t){var e=t.ownerElement;if(e&&e!==this._ownerElement)throw new f(f.INUSE_ATTRIBUTE_ERR);var n=this.getNamedItemNS(t.namespaceURI,t.localName);return n===t?t:(Y(this._ownerElement,this,t,n),n)},setNamedItemNS:function(t){return this.setNamedItem(t)},removeNamedItem:function(t){var e=this.getNamedItem(t);if(!e)throw new f(f.NOT_FOUND_ERR,t);return X(this._ownerElement,this,e),e},removeNamedItemNS:function(t,e){var n=this.getNamedItemNS(t,e);if(!n)throw new f(f.NOT_FOUND_ERR,t?t+" : "+e:e);return X(this._ownerElement,this,n),n},getNamedItemNS:function(t,e){t||(t=null);for(var n=0;n<this.length;){var r=this[n];if(r.localName===e&&r.namespaceURI===t)return r;n++}return null}},q.prototype[Symbol.iterator]=function(){var t=this,e=0;return{next:function(){return e<t.length?{value:t[e++],done:!1}:{done:!0}},return:function(){return{done:!0}}}},W.prototype={hasFeature:function(t,e){return!0},createDocument:function(t,e,n){var r=u.XML_APPLICATION;t===h.HTML?r=u.XML_XHTML_APPLICATION:t===h.SVG&&(r=u.XML_SVG_IMAGE);var o=new J(d,{contentType:r});if(o.implementation=this,o.childNodes=new V,o.doctype=n||null,n&&o.appendChild(n),e){var i=o.createElementNS(t,e);o.appendChild(i)}return o},createDocumentType:function(t,e,n,r){I(t);var o=new Et(d);return o.name=t,o.nodeName=t,o.publicId=e||"",o.systemId=n||"",o.internalSubset=r||"",o.childNodes=new V,o},createHTMLDocument:function(t){var e=new J(d,{contentType:u.HTML});if(e.implementation=this,e.childNodes=new V,!1!==t){e.doctype=this.createDocumentType("html"),e.doctype.ownerDocument=e,e.appendChild(e.doctype);var n=e.createElement("html");e.appendChild(n);var r=e.createElement("head");if(n.appendChild(r),"string"==typeof t){var o=e.createElement("title");o.appendChild(e.createTextNode(t)),r.appendChild(o)}n.appendChild(e.createElement("body"))}return e}},K.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,parentNode:null,get parentElement(){return this.parentNode&&this.parentNode.nodeType===this.ELEMENT_NODE?this.parentNode:null},childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,baseURI:"about:blank",get isConnected(){var t=this.getRootNode();return t&&t.nodeType===t.DOCUMENT_NODE},contains:function(t){if(!t)return!1;var e=t;do{if(this===e)return!0;e=t.parentNode}while(e);return!1},getRootNode:function(t){var e=this;do{if(!e.parentNode)return e;e=e.parentNode}while(e)},isEqualNode:function(t){if(!t)return!1;if(this.nodeType!==t.nodeType)return!1;switch(this.nodeType){case this.DOCUMENT_TYPE_NODE:if(this.name!==t.name)return!1;if(this.publicId!==t.publicId)return!1;if(this.systemId!==t.systemId)return!1;break;case this.ELEMENT_NODE:if(this.namespaceURI!==t.namespaceURI)return!1;if(this.prefix!==t.prefix)return!1;if(this.localName!==t.localName)return!1;if(this.attributes.length!==t.attributes.length)return!1;for(var e=0;e<this.attributes.length;e++){var n=this.attributes.item(e);if(!n.isEqualNode(t.getAttributeNodeNS(n.namespaceURI,n.localName)))return!1}break;case this.ATTRIBUTE_NODE:if(this.namespaceURI!==t.namespaceURI)return!1;if(this.localName!==t.localName)return!1;if(this.value!==t.value)return!1;break;case this.PROCESSING_INSTRUCTION_NODE:if(this.target!==t.target||this.data!==t.data)return!1;break;case this.TEXT_NODE:case this.COMMENT_NODE:if(this.data!==t.data)return!1}if(this.childNodes.length!==t.childNodes.length)return!1;for(e=0;e<this.childNodes.length;e++)if(!this.childNodes[e].isEqualNode(t.childNodes[e]))return!1;return!0},isSameNode:function(t){return this===t},insertBefore:function(t,e){return ut(this,t,e)},replaceChild:function(t,e){ut(this,t,e,lt),e&&this.removeChild(e)},removeChild:function(t){return et(this,t)},appendChild:function(t){return this.insertBefore(t,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(t){return Mt(this.ownerDocument||this,this,t)},normalize:function(){for(var t=this.firstChild;t;){var e=t.nextSibling;e&&e.nodeType==L&&t.nodeType==L?(this.removeChild(e),t.appendData(e.data)):(t.normalize(),t=e)}},isSupported:function(t,e){return this.ownerDocument.implementation.hasFeature(t,e)},lookupPrefix:function(t){for(var e=this;e;){var n=e._nsMap;if(n)for(var r in n)if(s(n,r)&&n[r]===t)return r;e=e.nodeType==C?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(t){for(var e=this;e;){var n=e._nsMap;if(n&&s(n,t))return n[t];e=e.nodeType==C?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(t){return null==this.lookupPrefix(t)},compareDocumentPosition:function(t){if(this===t)return 0;var e=t,n=this,r=null,o=null;if(e instanceof dt&&(e=(r=e).ownerElement),n instanceof dt&&(n=(o=n).ownerElement,r&&e&&n===e))for(var i,s=0;i=n.attributes[s];s++){if(i===r)return k.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+k.DOCUMENT_POSITION_PRECEDING;if(i===o)return k.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+k.DOCUMENT_POSITION_FOLLOWING}if(!e||!n||n.ownerDocument!==e.ownerDocument)return k.DOCUMENT_POSITION_DISCONNECTED+k.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+(G(n.ownerDocument)>G(e.ownerDocument)?k.DOCUMENT_POSITION_FOLLOWING:k.DOCUMENT_POSITION_PRECEDING);if(o&&e===n)return k.DOCUMENT_POSITION_CONTAINS+k.DOCUMENT_POSITION_PRECEDING;if(r&&e===n)return k.DOCUMENT_POSITION_CONTAINED_BY+k.DOCUMENT_POSITION_FOLLOWING;for(var a=[],c=e.parentNode;c;){if(!o&&c===n)return k.DOCUMENT_POSITION_CONTAINED_BY+k.DOCUMENT_POSITION_FOLLOWING;a.push(c),c=c.parentNode}a.reverse();for(var l=[],u=n.parentNode;u;){if(!r&&u===e)return k.DOCUMENT_POSITION_CONTAINS+k.DOCUMENT_POSITION_PRECEDING;l.push(u),u=u.parentNode}l.reverse();var h=B(a,l);for(var d in h.childNodes){var p=h.childNodes[d];if(p===n)return k.DOCUMENT_POSITION_FOLLOWING;if(p===e)return k.DOCUMENT_POSITION_PRECEDING;if(l.indexOf(p)>=0)return k.DOCUMENT_POSITION_FOLLOWING;if(a.indexOf(p)>=0)return k.DOCUMENT_POSITION_PRECEDING}return 0}},b(O,K),b(O,K.prototype),b(k,K),b(k,K.prototype),J.prototype={implementation:null,nodeName:"#document",nodeType:P,doctype:null,documentElement:null,_inc:1,insertBefore:function(t,e){if(t.nodeType===U){for(var n=t.firstChild;n;){var r=n.nextSibling;this.insertBefore(n,e),n=r}return t}return ut(this,t,e),t.ownerDocument=this,null===this.documentElement&&t.nodeType===y&&(this.documentElement=t),t},removeChild:function(t){var e=et(this,t);return e===this.documentElement&&(this.documentElement=null),e},replaceChild:function(t,e){ut(this,t,e,lt),t.ownerDocument=this,e&&this.removeChild(e),rt(t)&&(this.documentElement=t)},importNode:function(t,e){return Lt(this,t,e)},getElementById:function(t){var e=null;return Q(this.documentElement,function(n){if(n.nodeType==y&&n.getAttribute("id")==t)return e=n,!0}),e},createElement:function(t){var e=new ht(d);return e.ownerDocument=this,"html"===this.type&&(t=t.toLowerCase()),i(this.contentType)&&(e.namespaceURI=h.HTML),e.nodeName=t,e.tagName=t,e.localName=t,e.childNodes=new V,(e.attributes=new q)._ownerElement=e,e},createDocumentFragment:function(){var t=new It(d);return t.ownerDocument=this,t.childNodes=new V,t},createTextNode:function(t){var e=new ft(d);return e.ownerDocument=this,e.childNodes=new V,e.appendData(t),e},createComment:function(t){var e=new mt(d);return e.ownerDocument=this,e.childNodes=new V,e.appendData(t),e},createCDATASection:function(t){var e=new gt(d);return e.ownerDocument=this,e.childNodes=new V,e.appendData(t),e},createProcessingInstruction:function(t,e){var n=new At(d);return n.ownerDocument=this,n.childNodes=new V,n.nodeName=n.target=t,n.nodeValue=n.data=e,n},createAttribute:function(t){if(!g.QName_exact.test(t))throw new f(f.INVALID_CHARACTER_ERR,'invalid character in name "'+t+'"');return"html"===this.type&&(t=t.toLowerCase()),this._createAttribute(t)},_createAttribute:function(t){var e=new dt(d);return e.ownerDocument=this,e.childNodes=new V,e.name=t,e.nodeName=t,e.localName=t,e.specified=!0,e},createEntityReference:function(t){if(!g.Name.test(t))throw new f(f.INVALID_CHARACTER_ERR,'not a valid xml name "'+t+'"');if("html"===this.type)throw new f("document is an html document",m.NotSupportedError);var e=new Tt(d);return e.ownerDocument=this,e.childNodes=new V,e.nodeName=t,e},createElementNS:function(t,e){var n=A(t,e),r=new ht(d),o=r.attributes=new q;return r.childNodes=new V,r.ownerDocument=this,r.nodeName=e,r.tagName=e,r.namespaceURI=n[0],r.prefix=n[1],r.localName=n[2],o._ownerElement=r,r},createAttributeNS:function(t,e){var n=A(t,e),r=new dt(d);return r.ownerDocument=this,r.childNodes=new V,r.nodeName=e,r.name=e,r.specified=!0,r.namespaceURI=n[0],r.prefix=n[1],r.localName=n[2],r}},R(J,K),ht.prototype={nodeType:y,attributes:null,getQualifiedName:function(){return this.prefix?this.prefix+":"+this.localName:this.localName},_isInHTMLDocumentAndNamespace:function(){return"html"===this.ownerDocument.type&&this.namespaceURI===h.HTML},hasAttributes:function(){return!(!this.attributes||!this.attributes.length)},hasAttribute:function(t){return!!this.getAttributeNode(t)},getAttribute:function(t){var e=this.getAttributeNode(t);return e?e.value:null},getAttributeNode:function(t){return this._isInHTMLDocumentAndNamespace()&&(t=t.toLowerCase()),this.attributes.getNamedItem(t)},setAttribute:function(t,e){this._isInHTMLDocumentAndNamespace()&&(t=t.toLowerCase());var n=this.getAttributeNode(t);n?n.value=n.nodeValue=""+e:((n=this.ownerDocument._createAttribute(t)).value=n.nodeValue=""+e,this.setAttributeNode(n))},removeAttribute:function(t){var e=this.getAttributeNode(t);e&&this.removeAttributeNode(e)},setAttributeNode:function(t){return this.attributes.setNamedItem(t)},setAttributeNodeNS:function(t){return this.attributes.setNamedItemNS(t)},removeAttributeNode:function(t){return this.attributes.removeNamedItem(t.nodeName)},removeAttributeNS:function(t,e){var n=this.getAttributeNodeNS(t,e);n&&this.removeAttributeNode(n)},hasAttributeNS:function(t,e){return null!=this.getAttributeNodeNS(t,e)},getAttributeNS:function(t,e){var n=this.getAttributeNodeNS(t,e);return n?n.value:null},setAttributeNS:function(t,e,n){var r=A(t,e)[2],o=this.getAttributeNodeNS(t,r);o?o.value=o.nodeValue=""+n:((o=this.ownerDocument.createAttributeNS(t,e)).value=o.nodeValue=""+n,this.setAttributeNode(o))},getAttributeNodeNS:function(t,e){return this.attributes.getNamedItemNS(t,e)},getElementsByClassName:function(t){var e=T(t);return new H(this,function(n){var r=[];return e.length>0&&Q(n,function(o){if(o!==n&&o.nodeType===y){var i=o.getAttribute("class");if(i){var s=t===i;if(!s){var a=T(i);s=e.every((c=a,function(t){return c&&-1!==c.indexOf(t)}))}s&&r.push(o)}}var c}),r})},getElementsByTagName:function(t){var e="html"===(this.nodeType===P?this:this.ownerDocument).type,n=t.toLowerCase();return new H(this,function(r){var o=[];return Q(r,function(i){i!==r&&i.nodeType===y&&(("*"===t||i.getQualifiedName()===(e&&i.namespaceURI===h.HTML?n:t))&&o.push(i))}),o})},getElementsByTagNameNS:function(t,e){return new H(this,function(n){var r=[];return Q(n,function(o){o===n||o.nodeType!==y||"*"!==t&&o.namespaceURI!==t||"*"!==e&&o.localName!=e||r.push(o)}),r})}},J.prototype.getElementsByClassName=ht.prototype.getElementsByClassName,J.prototype.getElementsByTagName=ht.prototype.getElementsByTagName,J.prototype.getElementsByTagNameNS=ht.prototype.getElementsByTagNameNS,R(ht,K),dt.prototype.nodeType=C,R(dt,K),pt.prototype={data:"",substringData:function(t,e){return this.data.substring(t,t+e)},appendData:function(t){t=this.data+t,this.nodeValue=this.data=t,this.length=t.length},insertData:function(t,e){this.replaceData(t,0,e)},deleteData:function(t,e){this.replaceData(t,e,"")},replaceData:function(t,e,n){n=this.data.substring(0,t)+n+this.data.substring(t+e),this.nodeValue=this.data=n,this.length=n.length}},R(pt,K),ft.prototype={nodeName:"#text",nodeType:L,splitText:function(t){var e=this.data,n=e.substring(t);e=e.substring(0,t),this.data=this.nodeValue=e,this.length=e.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},R(ft,pt),mt.prototype={nodeName:"#comment",nodeType:D},R(mt,pt),gt.prototype={nodeName:"#cdata-section",nodeType:M},R(gt,ft),Et.prototype.nodeType=x,R(Et,K),Nt.prototype.nodeType=F,R(Nt,K),St.prototype.nodeType=v,R(St,K),Tt.prototype.nodeType=_,R(Tt,K),It.prototype.nodeName="#document-fragment",It.prototype.nodeType=U,R(It,K),At.prototype.nodeType=w,R(At,pt),bt.prototype.serializeToString=function(t,e){return Rt.call(t,e)},K.prototype.toString=Rt;try{if(Object.defineProperty){function vt(t){switch(t.nodeType){case y:case U:var e=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&e.push(vt(t)),t=t.nextSibling;return e.join("");default:return t.nodeValue}}Object.defineProperty(H.prototype,"length",{get:function(){return j(this),this.$$length}}),Object.defineProperty(K.prototype,"textContent",{get:function(){return vt(this)},set:function(t){switch(this.nodeType){case y:case U:for(;this.firstChild;)this.removeChild(this.firstChild);(t||String(t))&&this.appendChild(this.ownerDocument.createTextNode(t));break;default:this.data=t,this.value=t,this.nodeValue=t}}}),_t=function(t,e,n){t["$$"+e]=n}}}catch(wt){}e._updateLiveList=j,e.Attr=dt,e.CDATASection=gt,e.CharacterData=pt,e.Comment=mt,e.Document=J,e.DocumentFragment=It,e.DocumentType=Et,e.DOMImplementation=W,e.Element=ht,e.Entity=St,e.EntityReference=Tt,e.LiveNodeList=H,e.NamedNodeMap=q,e.Node=K,e.NodeList=V,e.Notation=Nt,e.Text=ft,e.ProcessingInstruction=At,e.XMLSerializer=bt},802(t,e,n){"use strict";var r=n(870),o=n(731),i=n(767),s=r.isHTMLEscapableRawTextElement,a=r.isHTMLMimeType,c=r.isHTMLRawTextElement,l=r.hasOwn,u=r.NAMESPACE,h=i.ParseError,d=i.DOMException;function p(){}p.prototype={parse:function(t,e,n){var i=this.domBuilder;i.startDocument(),S(e,e=Object.create(null)),function(t,e,n,i,s){var c=a(i.mimeType);t.indexOf(o.UNICODE_REPLACEMENT_CHARACTER)>=0&&s.warning("Unicode replacement character detected, source encoding issues?");function u(t){if(t>65535){var e=55296+((t-=65536)>>10),n=56320+(1023&t);return String.fromCharCode(e,n)}return String.fromCharCode(t)}function p(t){var e=";"===t[t.length-1]?t:t+";";if(!c&&e!==t)return s.error("EntityRef: expecting ;"),t;var r=o.Reference.exec(e);if(!r||r[0].length!==e.length)return s.error("entity not matching Reference production: "+t),t;var i=e.slice(1,-1);return l(n,i)?n[i]:"#"===i.charAt(0)?u(parseInt(i.substring(1).replace("x","0x"))):(s.error("entity not found:"+t),t)}function S(e){if(e>_){var n=t.substring(_,e).replace(f,p);y&&C(_),i.characters(n,0,e-_),_=e}}var T=0,R=0,O=/\r\n?|\n|$/g,y=i.locator;function C(e,n){for(;e>=R&&(n=O.exec(t));)T=R,R=n.index+n[0].length,y.lineNumber++;y.columnNumber=e-T+1}var L=[{currentNSMap:e}],M=[],_=0;for(;;){try{var v=t.indexOf("<",_);if(v<0){if(!c&&M.length>0)return s.fatalError("unclosed xml tag(s): "+M.join(", "));if(!t.substring(_).match(/^\s*$/)){var w=i.doc,D=w.createTextNode(t.substring(_));if(w.documentElement)return s.error("Extra content at the end of the document");w.appendChild(D),i.currentElement=D}return}if(v>_){var P=t.substring(_,v);c||0!==M.length||(P=P.replace(new RegExp(o.S_OPT.source,"g"),""))&&s.error("Unexpected content outside root element: '"+P+"'"),S(v)}switch(t.charAt(v+1)){case"/":var x=t.indexOf(">",v+2),U=t.substring(v+2,x>0?x:void 0);if(!U)return s.fatalError("end tag name missing");var F=x>0&&o.reg("^",o.QName_group,o.S_OPT,"$").exec(U);if(!F)return s.fatalError('end tag name contains invalid characters: "'+U+'"');if(!i.currentElement&&!i.doc.documentElement)return;var k=M[M.length-1]||i.currentElement.tagName||i.doc.documentElement.tagName||"";if(k!==F[1]){var B=F[1].toLowerCase();if(!c||k.toLowerCase()!==B)return s.fatalError('Opening and ending tag mismatch: "'+k+'" != "'+U+'"')}var G=L.pop();M.pop();var V=G.localNSMap;if(i.endElement(G.uri,G.localName,k),V)for(var H in V)l(V,H)&&i.endPrefixMapping(H);x++;break;case"?":y&&C(v),x=A(t,v,i,s);break;case"!":y&&C(v),x=I(t,v,i,s,c);break;default:y&&C(v);var j=new b,q=L[L.length-1].currentNSMap,$=(x=g(t,v,j,q,p,s,c),j.length);if(j.closed||(c&&r.isHTMLVoidElement(j.tagName)?j.closed=!0:M.push(j.tagName)),y&&$){for(var Y=m(y,{}),X=0;X<$;X++){var W=j[X];C(W.offset),W.locator=m(y,{})}i.locator=Y,E(j,i,q)&&L.push(j),i.locator=y}else E(j,i,q)&&L.push(j);c&&!j.closed?x=N(t,x,j.tagName,p,i):x++}}catch(t){if(t instanceof h)throw t;if(t instanceof d)throw new h(t.name+": "+t.message,i.locator,t);s.error("element parse error: "+t),x=-1}x>_?_=x:S(Math.max(v,_)+1)}}(t,e,n,i,this.errorHandler),i.endDocument()}};var f=/&#?\w+;?/g;function m(t,e){return e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber,e}function g(t,e,n,r,o,i,s){function a(t,e,r){return l(n.attributeNames,t)?i.fatalError("Attribute "+t+" redefined"):!s&&e.indexOf("<")>=0?i.fatalError("Unescaped '<' not allowed in attributes values"):void n.addValue(t,e.replace(/[\t\n\r]/g," ").replace(f,o),r)}for(var c,u=++e,h=0;;){var d=t.charAt(u);switch(d){case"=":if(1===h)c=t.slice(e,u),h=3;else{if(2!==h)throw new Error("attribute equal must after attrName");h=3}break;case"'":case'"':if(3===h||1===h){if(1===h&&(i.warning('attribute value must after "="'),c=t.slice(e,u)),e=u+1,!((u=t.indexOf(d,e))>0))throw new Error("attribute value no end '"+d+"' match");a(c,p=t.slice(e,u),e-1),h=5}else{if(4!=h)throw new Error('attribute value must after "="');a(c,p=t.slice(e,u),e),i.warning('attribute "'+c+'" missed start quot('+d+")!!"),e=u+1,h=5}break;case"/":switch(h){case 0:n.setTagName(t.slice(e,u));case 5:case 6:case 7:h=7,n.closed=!0;case 4:case 1:break;case 2:n.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return i.error("unexpected end of input"),0==h&&n.setTagName(t.slice(e,u)),u;case">":switch(h){case 0:n.setTagName(t.slice(e,u));case 5:case 6:case 7:break;case 4:case 1:"/"===(p=t.slice(e,u)).slice(-1)&&(n.closed=!0,p=p.slice(0,-1));case 2:2===h&&(p=c),4==h?(i.warning('attribute "'+p+'" missed quot(")!'),a(c,p,e)):(s||i.warning('attribute "'+p+'" missed value!! "'+p+'" instead!!'),a(p,p,e));break;case 3:if(!s)return i.fatalError("AttValue: ' or \" expected")}return u;case"\x80":d=" ";default:if(d<=" ")switch(h){case 0:n.setTagName(t.slice(e,u)),h=6;break;case 1:c=t.slice(e,u),h=2;break;case 4:var p=t.slice(e,u);i.warning('attribute "'+p+'" missed quot(")!!'),a(c,p,e);case 5:h=6}else switch(h){case 2:s||i.warning('attribute "'+c+'" missed value!! "'+c+'" instead2!!'),a(c,c,e),e=u,h=1;break;case 5:i.warning('attribute space is required"'+c+'"!!');case 6:h=1,e=u;break;case 3:h=4,e=u;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function E(t,e,n){for(var r=t.tagName,o=null,i=t.length;i--;){var s=t[i],a=s.qName,c=s.value;if((f=a.indexOf(":"))>0)var h=s.prefix=a.slice(0,f),d=a.slice(f+1),p="xmlns"===h&&d;else d=a,h=null,p="xmlns"===a&&"";s.localName=d,!1!==p&&(null==o&&(o=Object.create(null),S(n,n=Object.create(null))),n[p]=o[p]=c,s.uri=u.XMLNS,e.startPrefixMapping(p,c))}for(i=t.length;i--;)(s=t[i]).prefix&&("xml"===s.prefix&&(s.uri=u.XML),"xmlns"!==s.prefix&&(s.uri=n[s.prefix]));var f;(f=r.indexOf(":"))>0?(h=t.prefix=r.slice(0,f),d=t.localName=r.slice(f+1)):(h=null,d=t.localName=r);var m=t.uri=n[h||""];if(e.startElement(m,d,r,t),!t.closed)return t.currentNSMap=n,t.localNSMap=o,!0;if(e.endElement(m,d,r),o)for(h in o)l(o,h)&&e.endPrefixMapping(h)}function N(t,e,n,r,o){var i=s(n);if(i||c(n)){var a=t.indexOf("</"+n+">",e),l=t.substring(e+1,a);return i&&(l=l.replace(f,r)),o.characters(l,0,l.length),a}return e+1}function S(t,e){for(var n in t)l(t,n)&&(e[n]=t[n])}function T(t,e){var n=e;function r(e){return e=e||0,t.charAt(n+e)}function i(t){n+=t=t||1}function s(){return t.substring(n)}return{char:r,getIndex:function(){return n},getMatch:function(t){var e=o.reg("^",t).exec(s());return e?(i(e[0].length),e[0]):null},getSource:function(){return t},skip:i,skipBlanks:function(){for(var e=0;n<t.length;){var o=r();if(" "!==o&&"\n"!==o&&"\t"!==o&&"\r"!==o)return e;e++,i()}return-1},substringFromIndex:s,substringStartsWith:function(e){return t.substring(n,n+e.length)===e},substringStartsWithCaseInsensitive:function(e){return t.substring(n,n+e.length).toUpperCase()===e.toUpperCase()}}}function I(t,e,n,r,i){var s=T(t,e);switch(i?s.char(2).toUpperCase():s.char(2)){case"-":var a=s.getMatch(o.Comment);return a?(n.comment(a,o.COMMENT_START.length,a.length-o.COMMENT_START.length-o.COMMENT_END.length),s.getIndex()):r.fatalError("comment is not well-formed at position "+s.getIndex());case"[":var c=s.getMatch(o.CDSect);return c?i||n.currentElement?(n.startCDATA(),n.characters(c,o.CDATA_START.length,c.length-o.CDATA_START.length-o.CDATA_END.length),n.endCDATA(),s.getIndex()):r.fatalError("CDATA outside of element"):r.fatalError("Invalid CDATA starting at position "+e);case"D":if(n.doc&&n.doc.documentElement)return r.fatalError("Doctype not allowed inside or after documentElement at position "+s.getIndex());if(i?!s.substringStartsWithCaseInsensitive(o.DOCTYPE_DECL_START):!s.substringStartsWith(o.DOCTYPE_DECL_START))return r.fatalError("Expected "+o.DOCTYPE_DECL_START+" at position "+s.getIndex());if(s.skip(o.DOCTYPE_DECL_START.length),s.skipBlanks()<1)return r.fatalError("Expected whitespace after "+o.DOCTYPE_DECL_START+" at position "+s.getIndex());var l={name:void 0,publicId:void 0,systemId:void 0,internalSubset:void 0};if(l.name=s.getMatch(o.Name),!l.name)return r.fatalError("doctype name missing or contains unexpected characters at position "+s.getIndex());if(i&&"html"!==l.name.toLowerCase()&&r.warning("Unexpected DOCTYPE in HTML document at position "+s.getIndex()),s.skipBlanks(),s.substringStartsWith(o.PUBLIC)||s.substringStartsWith(o.SYSTEM)){var u=o.ExternalID_match.exec(s.substringFromIndex());if(!u)return r.fatalError("doctype external id is not well-formed at position "+s.getIndex());void 0!==u.groups.SystemLiteralOnly?l.systemId=u.groups.SystemLiteralOnly:(l.systemId=u.groups.SystemLiteral,l.publicId=u.groups.PubidLiteral),s.skip(u[0].length)}else if(i&&s.substringStartsWithCaseInsensitive(o.SYSTEM)){if(s.skip(o.SYSTEM.length),s.skipBlanks()<1)return r.fatalError("Expected whitespace after "+o.SYSTEM+" at position "+s.getIndex());if(l.systemId=s.getMatch(o.ABOUT_LEGACY_COMPAT_SystemLiteral),!l.systemId)return r.fatalError("Expected "+o.ABOUT_LEGACY_COMPAT+" in single or double quotes after "+o.SYSTEM+" at position "+s.getIndex())}return i&&l.systemId&&!o.ABOUT_LEGACY_COMPAT_SystemLiteral.test(l.systemId)&&r.warning("Unexpected doctype.systemId in HTML document at position "+s.getIndex()),i||(s.skipBlanks(),l.internalSubset=function(t,e){function n(t,e){var n=o.PI.exec(t.substringFromIndex());return n?"xml"===n[1].toLowerCase()?e.fatalError("xml declaration is only allowed at the start of the document, but found at position "+t.getIndex()):(t.skip(n[0].length),n[0]):e.fatalError("processing instruction is not well-formed at position "+t.getIndex())}var r=t.getSource();if("["===t.char()){t.skip(1);for(var i=t.getIndex();t.getIndex()<r.length;){if(t.skipBlanks(),"]"===t.char()){var s=r.substring(i,t.getIndex());return t.skip(1),s}var a=null;if("<"===t.char()&&"!"===t.char(1))switch(t.char(2)){case"E":"L"===t.char(3)?a=t.getMatch(o.elementdecl):"N"===t.char(3)&&(a=t.getMatch(o.EntityDecl));break;case"A":a=t.getMatch(o.AttlistDecl);break;case"N":a=t.getMatch(o.NotationDecl);break;case"-":a=t.getMatch(o.Comment)}else if("<"===t.char()&&"?"===t.char(1))a=n(t,e);else{if("%"!==t.char())return e.fatalError("Error detected in Markup declaration");a=t.getMatch(o.PEReference)}if(!a)return e.fatalError("Error in internal subset at position "+t.getIndex())}return e.fatalError("doctype internal subset is not well-formed, missing ]")}}(s,r)),s.skipBlanks(),">"!==s.char()?r.fatalError("doctype not terminated with > at position "+s.getIndex()):(s.skip(1),n.startDTD(l.name,l.publicId,l.systemId,l.internalSubset),n.endDTD(),s.getIndex());default:return r.fatalError('Not well-formed XML starting with "<!" at position '+e)}}function A(t,e,n,r){var i=t.substring(e).match(o.PI);if(!i)return r.fatalError("Invalid processing instruction starting at position "+e);if("xml"===i[1].toLowerCase()){if(e>0)return r.fatalError("processing instruction at position "+e+" is an xml declaration which is only at the start of the document");if(!o.XMLDecl.test(t.substring(e)))return r.fatalError("xml declaration is not well-formed")}return n.processingInstruction(i[1],i[2]),e+i[0].length}function b(){this.attributeNames=Object.create(null)}b.prototype={setTagName:function(t){if(!o.QName_exact.test(t))throw new Error("invalid tagName:"+t);this.tagName=t},addValue:function(t,e,n){if(!o.QName_exact.test(t))throw new Error("invalid attribute:"+t);this.attributeNames[t]=this.length,this[this.length++]={qName:t,value:e,offset:n}},length:0,getLocalName:function(t){return this[t].localName},getLocator:function(t){return this[t].locator},getQName:function(t){return this[t].qName},getURI:function(t){return this[t].uri},getValue:function(t){return this[t].value}},e.XMLReader=p,e.parseUtils=T,e.parseDoctypeCommentOrCData=I},870(t,e){"use strict";function n(t,e){return void 0===e&&(e=Object),e&&"function"==typeof e.getOwnPropertyDescriptors&&(t=e.create(null,e.getOwnPropertyDescriptors(t))),e&&"function"==typeof e.freeze?e.freeze(t):t}function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var o=n({allowfullscreen:!0,async:!0,autofocus:!0,autoplay:!0,checked:!0,controls:!0,default:!0,defer:!0,disabled:!0,formnovalidate:!0,hidden:!0,ismap:!0,itemscope:!0,loop:!0,multiple:!0,muted:!0,nomodule:!0,novalidate:!0,open:!0,playsinline:!0,readonly:!0,required:!0,reversed:!0,selected:!0});var i=n({area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});var s=n({script:!1,style:!1,textarea:!0,title:!0});function a(t){return t===c.HTML}var c=n({HTML:"text/html",XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),l=Object.keys(c).map(function(t){return c[t]});var u=n({HTML:"http://www.w3.org/1999/xhtml",SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});e.assign=function(t,e){if(null===t||"object"!=typeof t)throw new TypeError("target is not an object");for(var n in e)r(e,n)&&(t[n]=e[n]);return t},e.find=function(t,e,n){if(void 0===n&&(n=Array.prototype),t&&"function"==typeof n.find)return n.find.call(t,e);for(var o=0;o<t.length;o++)if(r(t,o)){var i=t[o];if(e.call(void 0,i,o,t))return i}},e.freeze=n,e.HTML_BOOLEAN_ATTRIBUTES=o,e.HTML_RAW_TEXT_ELEMENTS=s,e.HTML_VOID_ELEMENTS=i,e.hasDefaultHTMLNamespace=function(t){return a(t)||t===c.XML_XHTML_APPLICATION},e.hasOwn=r,e.isHTMLBooleanAttribute=function(t){return r(o,t.toLowerCase())},e.isHTMLRawTextElement=function(t){var e=t.toLowerCase();return r(s,e)&&!s[e]},e.isHTMLEscapableRawTextElement=function(t){var e=t.toLowerCase();return r(s,e)&&s[e]},e.isHTMLMimeType=a,e.isHTMLVoidElement=function(t){return r(i,t.toLowerCase())},e.isValidMimeType=function(t){return l.indexOf(t)>-1},e.MIME_TYPE=c,e.NAMESPACE=u},999(t,e,n){(function(){"use strict";var e=this;function n(t){return"string"==typeof t}function r(t,e,n){return t.call.apply(t.bind,arguments)}function o(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function i(t,e,n){return(i=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?r:o).apply(null,arguments)}function s(t){var e=st;function n(){}n.prototype=e.prototype,t.G=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.F=function(t,n,r){for(var o=Array(arguments.length-2),i=2;i<arguments.length;i++)o[i-2]=arguments[i];return e.prototype[n].apply(t,o)}}var a=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};function c(t,e){return-1!=t.indexOf(e)}function l(t,e){return t<e?-1:t>e?1:0}var u,h=Array.prototype.indexOf?function(t,e,n){return Array.prototype.indexOf.call(t,e,n)}:function(t,e,r){if(r=null==r?0:0>r?Math.max(0,t.length+r):r,n(t))return n(e)&&1==e.length?t.indexOf(e,r):-1;for(;r<t.length;r++)if(r in t&&t[r]===e)return r;return-1},d=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,r){for(var o=t.length,i=n(t)?t.split(""):t,s=0;s<o;s++)s in i&&e.call(r,i[s],s,t)},p=Array.prototype.filter?function(t,e,n){return Array.prototype.filter.call(t,e,n)}:function(t,e,r){for(var o=t.length,i=[],s=0,a=n(t)?t.split(""):t,c=0;c<o;c++)if(c in a){var l=a[c];e.call(r,l,c,t)&&(i[s++]=l)}return i},f=Array.prototype.reduce?function(t,e,n,r){return r&&(e=i(e,r)),Array.prototype.reduce.call(t,e,n)}:function(t,e,n,r){var o=n;return d(t,function(n,i){o=e.call(r,o,n,i,t)}),o},m=Array.prototype.some?function(t,e,n){return Array.prototype.some.call(t,e,n)}:function(t,e,r){for(var o=t.length,i=n(t)?t.split(""):t,s=0;s<o;s++)if(s in i&&e.call(r,i[s],s,t))return!0;return!1};t:{var g=e.navigator;if(g){var E=g.userAgent;if(E){u=E;break t}}u=""}var N,S,T=c(u,"Opera")||c(u,"OPR"),I=c(u,"Trident")||c(u,"MSIE"),A=c(u,"Edge"),b=c(u,"Gecko")&&!(c(u.toLowerCase(),"webkit")&&!c(u,"Edge"))&&!(c(u,"Trident")||c(u,"MSIE"))&&!c(u,"Edge"),R=c(u.toLowerCase(),"webkit")&&!c(u,"Edge");function O(){var t=e.document;return t?t.documentMode:void 0}t:{var y="",C=(S=u,b?/rv\:([^\);]+)(\)|;)/.exec(S):A?/Edge\/([\d\.]+)/.exec(S):I?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(S):R?/WebKit\/(\S+)/.exec(S):T?/(?:Version)[ \/]?(\S+)/.exec(S):void 0);if(C&&(y=C?C[1]:""),I){var L=O();if(null!=L&&L>parseFloat(y)){N=String(L);break t}}N=y}var M={};function _(t){if(!M[t]){for(var e=0,n=a(String(N)).split("."),r=a(String(t)).split("."),o=Math.max(n.length,r.length),i=0;0==e&&i<o;i++){var s=n[i]||"",c=r[i]||"",u=/(\d*)(\D*)/g,h=/(\d*)(\D*)/g;do{var d=u.exec(s)||["","",""],p=h.exec(c)||["","",""];if(0==d[0].length&&0==p[0].length)break;e=l(0==d[1].length?0:parseInt(d[1],10),0==p[1].length?0:parseInt(p[1],10))||l(0==d[2].length,0==p[2].length)||l(d[2],p[2])}while(0==e)}M[t]=0<=e}}var v=e.document,w=v&&I?O()||("CSS1Compat"==v.compatMode?parseInt(N,10):5):void 0,D=I&&!(9<=Number(w)),P=I&&!(8<=Number(w));function x(t,e,n,r){this.a=t,this.nodeName=n,this.nodeValue=r,this.nodeType=2,this.parentNode=this.ownerElement=e}function U(t,e){var n=P&&"href"==e.nodeName?t.getAttribute(e.nodeName,2):e.nodeValue;return new x(e,t,e.nodeName,n)}function F(t){var e=null;if(1==(n=t.nodeType)&&(e=null==(e=null==(e=t.textContent)||null==e?t.innerText:e)||null==e?"":e),"string"!=typeof e)if(D&&"title"==t.nodeName.toLowerCase()&&1==n)e=t.text;else if(9==n||1==n){t=9==n?t.documentElement:t.firstChild;var n=0,r=[];for(e="";t;){do{1!=t.nodeType&&(e+=t.nodeValue),D&&"title"==t.nodeName.toLowerCase()&&(e+=t.text),r[n++]=t}while(t=t.firstChild);for(;n&&!(t=r[--n].nextSibling););}}else e=t.nodeValue;return""+e}function k(t,e,n){if(null===e)return!0;try{if(!t.getAttribute)return!1}catch(t){return!1}return P&&"class"==e&&(e="className"),null==n?!!t.getAttribute(e):t.getAttribute(e,2)==n}function B(t,e,r,o,i){return(D?G:V).call(null,t,e,n(r)?r:null,n(o)?o:null,i||new z)}function G(t,e,n,r,o){if(t instanceof Pt||8==t.b||n&&null===t.b){var i=e.all;if(!i)return o;if("*"!=(t=$(t))&&!(i=e.getElementsByTagName(t)))return o;if(n){for(var s=[],a=0;e=i[a++];)k(e,n,r)&&s.push(e);i=s}for(a=0;e=i[a++];)"*"==t&&"!"==e.tagName||tt(o,e);return o}return q(t,e,n,r,o),o}function V(t,e,n,r,o){return e.getElementsByName&&r&&"name"==n&&!I?(e=e.getElementsByName(r),d(e,function(e){t.a(e)&&tt(o,e)})):e.getElementsByClassName&&r&&"class"==n?(e=e.getElementsByClassName(r),d(e,function(e){e.className==r&&t.a(e)&&tt(o,e)})):t instanceof Ot?q(t,e,n,r,o):e.getElementsByTagName&&(e=e.getElementsByTagName(t.f()),d(e,function(t){k(t,n,r)&&tt(o,t)})),o}function H(t,e,n,r,o){var i;if((t instanceof Pt||8==t.b||n&&null===t.b)&&(i=e.childNodes)){var s=$(t);return"*"==s||(i=p(i,function(t){return t.tagName&&t.tagName.toLowerCase()==s}),i)?(n&&(i=p(i,function(t){return k(t,n,r)})),d(i,function(t){"*"==s&&("!"==t.tagName||"*"==s&&1!=t.nodeType)||tt(o,t)}),o):o}return j(t,e,n,r,o)}function j(t,e,n,r,o){for(e=e.firstChild;e;e=e.nextSibling)k(e,n,r)&&t.a(e)&&tt(o,e);return o}function q(t,e,n,r,o){for(e=e.firstChild;e;e=e.nextSibling)k(e,n,r)&&t.a(e)&&tt(o,e),q(t,e,n,r,o)}function $(t){if(t instanceof Ot){if(8==t.b)return"!";if(null===t.b)return"*"}return t.f()}function Y(t,e){if(!t||!e)return!1;if(t.contains&&1==e.nodeType)return t==e||t.contains(e);if(void 0!==t.compareDocumentPosition)return t==e||!!(16&t.compareDocumentPosition(e));for(;e&&t!=e;)e=e.parentNode;return e==t}function X(t,n){if(t==n)return 0;if(t.compareDocumentPosition)return 2&t.compareDocumentPosition(n)?1:-1;if(I&&!(9<=Number(w))){if(9==t.nodeType)return-1;if(9==n.nodeType)return 1}if("sourceIndex"in t||t.parentNode&&"sourceIndex"in t.parentNode){var r=1==t.nodeType,o=1==n.nodeType;if(r&&o)return t.sourceIndex-n.sourceIndex;var i=t.parentNode,s=n.parentNode;return i==s?K(t,n):!r&&Y(i,n)?-1*W(t,n):!o&&Y(s,t)?W(n,t):(r?t.sourceIndex:i.sourceIndex)-(o?n.sourceIndex:s.sourceIndex)}return(r=(o=9==t.nodeType?t:t.ownerDocument||t.document).createRange()).selectNode(t),r.collapse(!0),(o=o.createRange()).selectNode(n),o.collapse(!0),r.compareBoundaryPoints(e.Range.START_TO_END,o)}function W(t,e){var n=t.parentNode;if(n==e)return-1;for(var r=e;r.parentNode!=n;)r=r.parentNode;return K(r,t)}function K(t,e){for(var n=e;n=n.previousSibling;)if(n==t)return-1;return 1}function z(){this.b=this.a=null,this.l=0}function Q(t){this.node=t,this.a=this.b=null}function J(t,e){if(!t.a)return e;if(!e.a)return t;for(var n=t.a,r=e.a,o=null,i=null,s=0;n&&r;){i=n.node;var a=r.node;i==a||i instanceof x&&a instanceof x&&i.a==a.a?(i=n,n=n.a,r=r.a):0<X(n.node,r.node)?(i=r,r=r.a):(i=n,n=n.a),(i.b=o)?o.a=i:t.a=i,o=i,s++}for(i=n||r;i;)i.b=o,o=o.a=i,s++,i=i.a;return t.b=o,t.l=s,t}function Z(t,e){var n=new Q(e);n.a=t.a,t.b?t.a.b=n:t.a=t.b=n,t.a=n,t.l++}function tt(t,e){var n=new Q(e);n.b=t.b,t.a?t.b.a=n:t.a=t.b=n,t.b=n,t.l++}function et(t){return(t=t.a)?t.node:null}function nt(t){return(t=et(t))?F(t):""}function rt(t,e){return new ot(t,!!e)}function ot(t,e){this.f=t,this.b=(this.c=e)?t.b:t.a,this.a=null}function it(t){var e=t.b;if(null==e)return null;var n=t.a=e;return t.b=t.c?e.b:e.a,n.node}function st(t){this.i=t,this.b=this.g=!1,this.f=null}function at(t){return"\n  "+t.toString().split("\n").join("\n  ")}function ct(t,e){t.g=e}function lt(t,e){t.b=e}function ut(t,e){var n=t.a(e);return n instanceof z?+nt(n):+n}function ht(t,e){var n=t.a(e);return n instanceof z?nt(n):""+n}function dt(t,e){var n=t.a(e);return n instanceof z?!!n.l:!!n}function pt(t,e,n){st.call(this,t.i),this.c=t,this.h=e,this.o=n,this.g=e.g||n.g,this.b=e.b||n.b,this.c==Nt&&(n.b||n.g||4==n.i||0==n.i||!e.f?e.b||e.g||4==e.i||0==e.i||!n.f||(this.f={name:n.f.name,s:e}):this.f={name:e.f.name,s:n})}function ft(t,e,n,r,o){var i;if(e=e.a(r),n=n.a(r),e instanceof z&&n instanceof z){for(r=it(e=rt(e));r;r=it(e))for(i=it(o=rt(n));i;i=it(o))if(t(F(r),F(i)))return!0;return!1}if(e instanceof z||n instanceof z){e instanceof z?(o=e,r=n):(o=n,r=e);for(var s=typeof r,a=it(i=rt(o));a;a=it(i)){switch(s){case"number":a=+F(a);break;case"boolean":a=!!F(a);break;case"string":a=F(a);break;default:throw Error("Illegal primitive type for comparison.")}if(o==e&&t(a,r)||o==n&&t(r,a))return!0}return!1}return o?"boolean"==typeof e||"boolean"==typeof n?t(!!e,!!n):"number"==typeof e||"number"==typeof n?t(+e,+n):t(e,n):t(+e,+n)}function mt(t,e,n,r){this.a=t,this.w=e,this.i=n,this.m=r}!b&&!I||I&&9<=Number(w)||b&&_("1.9.1"),I&&_("9"),s(pt),pt.prototype.a=function(t){return this.c.m(this.h,this.o,t)},pt.prototype.toString=function(){return"Binary Expression: "+this.c+at(this.h)+at(this.o)},mt.prototype.toString=function(){return this.a};var gt={};function Et(t,e,n,r){if(gt.hasOwnProperty(t))throw Error("Binary operator already created: "+t);return t=new mt(t,e,n,r),gt[t.toString()]=t}Et("div",6,1,function(t,e,n){return ut(t,n)/ut(e,n)}),Et("mod",6,1,function(t,e,n){return ut(t,n)%ut(e,n)}),Et("*",6,1,function(t,e,n){return ut(t,n)*ut(e,n)}),Et("+",5,1,function(t,e,n){return ut(t,n)+ut(e,n)}),Et("-",5,1,function(t,e,n){return ut(t,n)-ut(e,n)}),Et("<",4,2,function(t,e,n){return ft(function(t,e){return t<e},t,e,n)}),Et(">",4,2,function(t,e,n){return ft(function(t,e){return t>e},t,e,n)}),Et("<=",4,2,function(t,e,n){return ft(function(t,e){return t<=e},t,e,n)}),Et(">=",4,2,function(t,e,n){return ft(function(t,e){return t>=e},t,e,n)});var Nt=Et("=",3,2,function(t,e,n){return ft(function(t,e){return t==e},t,e,n,!0)});function St(t,e,n){this.a=t,this.b=e||1,this.f=n||1}function Tt(t,e){if(e.a.length&&4!=t.i)throw Error("Primary expression must evaluate to nodeset if filter has predicate(s).");st.call(this,t.i),this.c=t,this.h=e,this.g=t.g,this.b=t.b}function It(t,e){if(e.length<t.A)throw Error("Function "+t.j+" expects at least"+t.A+" arguments, "+e.length+" given");if(null!==t.v&&e.length>t.v)throw Error("Function "+t.j+" expects at most "+t.v+" arguments, "+e.length+" given");t.B&&d(e,function(e,n){if(4!=e.i)throw Error("Argument "+n+" to function "+t.j+" is not of type Nodeset: "+e)}),st.call(this,t.i),this.h=t,this.c=e,ct(this,t.g||m(e,function(t){return t.g})),lt(this,t.D&&!e.length||t.C&&!!e.length||m(e,function(t){return t.b}))}function At(t,e,n,r,o,i,s,a,c){this.j=t,this.i=e,this.g=n,this.D=r,this.C=o,this.m=i,this.A=s,this.v=void 0!==a?a:s,this.B=!!c}Et("!=",3,2,function(t,e,n){return ft(function(t,e){return t!=e},t,e,n,!0)}),Et("and",2,2,function(t,e,n){return dt(t,n)&&dt(e,n)}),Et("or",1,2,function(t,e,n){return dt(t,n)||dt(e,n)}),s(Tt),Tt.prototype.a=function(t){return t=this.c.a(t),Vt(this.h,t)},Tt.prototype.toString=function(){return"Filter:"+at(this.c)+at(this.h)},s(It),It.prototype.a=function(t){return this.h.m.apply(null,function(t){return Array.prototype.concat.apply(Array.prototype,arguments)}(t,this.c))},It.prototype.toString=function(){var t="Function: "+this.h;if(this.c.length){var e=f(this.c,function(t,e){return t+at(e)},"Arguments:");t=t+at(e)}return t},At.prototype.toString=function(){return this.j};var bt={};function Rt(t,e,n,r,o,i,s,a){if(bt.hasOwnProperty(t))throw Error("Function already created: "+t+".");bt[t]=new At(t,e,n,r,!1,o,i,s,a)}function Ot(t,e){switch(this.h=t,this.c=void 0!==e?e:null,this.b=null,t){case"comment":this.b=8;break;case"text":this.b=3;break;case"processing-instruction":this.b=7;break;case"node":break;default:throw Error("Unexpected argument")}}function yt(t){return"comment"==t||"text"==t||"processing-instruction"==t||"node"==t}function Ct(t){this.b=t,this.a=0}Rt("boolean",2,!1,!1,function(t,e){return dt(e,t)},1),Rt("ceiling",1,!1,!1,function(t,e){return Math.ceil(ut(e,t))},1),Rt("concat",3,!1,!1,function(t,e){return f(function(t,e,n){return 2>=arguments.length?Array.prototype.slice.call(t,e):Array.prototype.slice.call(t,e,n)}(arguments,1),function(e,n){return e+ht(n,t)},"")},2,null),Rt("contains",2,!1,!1,function(t,e,n){return c(ht(e,t),ht(n,t))},2),Rt("count",1,!1,!1,function(t,e){return e.a(t).l},1,1,!0),Rt("false",2,!1,!1,function(){return!1},0),Rt("floor",1,!1,!1,function(t,e){return Math.floor(ut(e,t))},1),Rt("id",4,!1,!1,function(t,e){function r(t){if(D){var e=o.all[t];if(e){if(e.nodeType&&t==e.id)return e;if(e.length)return function(t,e){var r;t:{r=t.length;for(var o=n(t)?t.split(""):t,i=0;i<r;i++)if(i in o&&e.call(void 0,o[i],i,t)){r=i;break t}r=-1}return 0>r?null:n(t)?t.charAt(r):t[r]}(e,function(e){return t==e.id})}return null}return o.getElementById(t)}var o=9==(i=t.a).nodeType?i:i.ownerDocument,i=ht(e,t).split(/\s+/),s=[];d(i,function(t){!(t=r(t))||0<=h(s,t)||s.push(t)}),s.sort(X);var a=new z;return d(s,function(t){tt(a,t)}),a},1),Rt("lang",2,!1,!1,function(){return!1},1),Rt("last",1,!0,!1,function(t){if(1!=arguments.length)throw Error("Function last expects ()");return t.f},0),Rt("local-name",3,!1,!0,function(t,e){var n=e?et(e.a(t)):t.a;return n?n.localName||n.nodeName.toLowerCase():""},0,1,!0),Rt("name",3,!1,!0,function(t,e){var n=e?et(e.a(t)):t.a;return n?n.nodeName.toLowerCase():""},0,1,!0),Rt("namespace-uri",3,!0,!1,function(){return""},0,1,!0),Rt("normalize-space",3,!1,!0,function(t,e){return(e?ht(e,t):F(t.a)).replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")},0,1),Rt("not",2,!1,!1,function(t,e){return!dt(e,t)},1),Rt("number",1,!1,!0,function(t,e){return e?ut(e,t):+F(t.a)},0,1),Rt("position",1,!0,!1,function(t){return t.b},0),Rt("round",1,!1,!1,function(t,e){return Math.round(ut(e,t))},1),Rt("starts-with",2,!1,!1,function(t,e,n){return e=ht(e,t),t=ht(n,t),0==e.lastIndexOf(t,0)},2),Rt("string",3,!1,!0,function(t,e){return e?ht(e,t):F(t.a)},0,1),Rt("string-length",1,!1,!0,function(t,e){return(e?ht(e,t):F(t.a)).length},0,1),Rt("substring",3,!1,!1,function(t,e,n,r){if(n=ut(n,t),isNaN(n)||1/0==n||-1/0==n)return"";if(r=r?ut(r,t):1/0,isNaN(r)||-1/0===r)return"";n=Math.round(n)-1;var o=Math.max(n,0);return t=ht(e,t),1/0==r?t.substring(o):t.substring(o,n+Math.round(r))},2,3),Rt("substring-after",3,!1,!1,function(t,e,n){return e=ht(e,t),t=ht(n,t),-1==(n=e.indexOf(t))?"":e.substring(n+t.length)},2),Rt("substring-before",3,!1,!1,function(t,e,n){return e=ht(e,t),t=ht(n,t),-1==(t=e.indexOf(t))?"":e.substring(0,t)},2),Rt("sum",1,!1,!1,function(t,e){for(var n=rt(e.a(t)),r=0,o=it(n);o;o=it(n))r+=+F(o);return r},1,1,!0),Rt("translate",3,!1,!1,function(t,e,n,r){e=ht(e,t),n=ht(n,t);var o=ht(r,t);for(t={},r=0;r<n.length;r++){var i=n.charAt(r);i in t||(t[i]=o.charAt(r))}for(n="",r=0;r<e.length;r++)n+=(i=e.charAt(r))in t?t[i]:i;return n},3),Rt("true",2,!1,!1,function(){return!0},0),Ot.prototype.a=function(t){return null===this.b||this.b==t.nodeType},Ot.prototype.f=function(){return this.h},Ot.prototype.toString=function(){var t="Kind Test: "+this.h;return null===this.c||(t+=at(this.c)),t};var Lt=/\$?(?:(?![0-9-\.])(?:\*|[\w-\.]+):)?(?![0-9-\.])(?:\*|[\w-\.]+)|\/\/|\.\.|::|\d+(?:\.\d*)?|\.\d+|"[^"]*"|'[^']*'|[!<>]=|\s+|./g,Mt=/^\s/;function _t(t,e){return t.b[t.a+(e||0)]}function vt(t){return t.b[t.a++]}function wt(t){return t.b.length<=t.a}function Dt(t){st.call(this,3),this.c=t.substring(1,t.length-1)}function Pt(t,e){var n;this.j=t.toLowerCase(),n="*"==this.j?"*":"http://www.w3.org/1999/xhtml",this.c=e?e.toLowerCase():n}function xt(t,e){if(st.call(this,t.i),this.h=t,this.c=e,this.g=t.g,this.b=t.b,1==this.c.length){var n=this.c[0];n.u||n.c!=Yt||"*"!=(n=n.o).f()&&(this.f={name:n.f(),s:null})}}function Ut(){st.call(this,4)}function Ft(){st.call(this,4)}function kt(t){return"/"==t||"//"==t}function Bt(t){st.call(this,4),this.c=t,ct(this,m(this.c,function(t){return t.g})),lt(this,m(this.c,function(t){return t.b}))}function Gt(t,e){this.a=t,this.b=!!e}function Vt(t,e,n){for(n=n||0;n<t.a.length;n++)for(var r,o=t.a[n],i=rt(e),s=e.l,a=0;r=it(i);a++){var c=t.b?s-a:a+1;if("number"==typeof(r=o.a(new St(r,c,s))))c=c==r;else if("string"==typeof r||"boolean"==typeof r)c=!!r;else{if(!(r instanceof z))throw Error("Predicate.evaluate returned an unexpected type.");c=0<r.l}if(!c){if(r=(c=i).f,!(u=c.a))throw Error("Next must be called at least once before remove.");var l=u.b,u=u.a;l?l.a=u:r.a=u,u?u.b=l:r.b=l,r.l--,c.a=null}}return e}function Ht(t,e,n,r){st.call(this,4),this.c=t,this.o=e,this.h=n||new Gt([]),this.u=!!r,e=0<(e=this.h).a.length?e.a[0].f:null,t.b&&e&&(t=e.name,t=D?t.toLowerCase():t,this.f={name:t,s:e.s});t:{for(t=this.h,e=0;e<t.a.length;e++)if((n=t.a[e]).g||1==n.i||0==n.i){t=!0;break t}t=!1}this.g=t}function jt(t,e,n,r){this.j=t,this.f=e,this.a=n,this.b=r}s(Dt),Dt.prototype.a=function(){return this.c},Dt.prototype.toString=function(){return"Literal: "+this.c},Pt.prototype.a=function(t){var e=t.nodeType;return(1==e||2==e)&&(e=void 0!==t.localName?t.localName:t.nodeName,("*"==this.j||this.j==e.toLowerCase())&&("*"==this.c||this.c==(t.namespaceURI?t.namespaceURI.toLowerCase():"http://www.w3.org/1999/xhtml")))},Pt.prototype.f=function(){return this.j},Pt.prototype.toString=function(){return"Name Test: "+("http://www.w3.org/1999/xhtml"==this.c?"":this.c+":")+this.j},s(xt),s(Ut),Ut.prototype.a=function(t){var e=new z;return 9==(t=t.a).nodeType?tt(e,t):tt(e,t.ownerDocument),e},Ut.prototype.toString=function(){return"Root Helper Expression"},s(Ft),Ft.prototype.a=function(t){var e=new z;return tt(e,t.a),e},Ft.prototype.toString=function(){return"Context Helper Expression"},xt.prototype.a=function(t){var e=this.h.a(t);if(!(e instanceof z))throw Error("Filter expression must evaluate to nodeset.");for(var n=0,r=(t=this.c).length;n<r&&e.l;n++){var o,i=t[n],s=rt(e,i.c.a);if(i.g||i.c!=Kt)if(i.g||i.c!=Qt)for(o=it(s),e=i.a(new St(o));null!=(o=it(s));)e=J(e,o=i.a(new St(o)));else o=it(s),e=i.a(new St(o));else{for(o=it(s);(e=it(s))&&(!o.contains||o.contains(e))&&8&e.compareDocumentPosition(o);o=e);e=i.a(new St(o))}}return e},xt.prototype.toString=function(){var t;if(t="Path Expression:"+at(this.h),this.c.length){var e=f(this.c,function(t,e){return t+at(e)},"Steps:");t+=at(e)}return t},s(Bt),Bt.prototype.a=function(t){var e=new z;return d(this.c,function(n){if(!((n=n.a(t))instanceof z))throw Error("Path expression must evaluate to NodeSet.");e=J(e,n)}),e},Bt.prototype.toString=function(){return f(this.c,function(t,e){return t+at(e)},"Union Expression:")},Gt.prototype.toString=function(){return f(this.a,function(t,e){return t+at(e)},"Predicates:")},s(Ht),Ht.prototype.a=function(t){var e=t.a,n=null,r=null,o=null,i=0;if((n=this.f)&&(r=n.name,o=n.s?ht(n.s,t):null,i=1),this.u)if(this.g||this.c!=Xt)if(e=it(t=rt(new Ht(Wt,new Ot("node")).a(t))))for(n=this.m(e,r,o,i);null!=(e=it(t));)n=J(n,this.m(e,r,o,i));else n=new z;else n=B(this.o,e,r,o),n=Vt(this.h,n,i);else n=this.m(t.a,r,o,i);return n},Ht.prototype.m=function(t,e,n,r){return t=this.c.f(this.o,t,e,n),Vt(this.h,t,r)},Ht.prototype.toString=function(){var t;if(t="Step:"+at("Operator: "+(this.u?"//":"/")),this.c.j&&(t+=at("Axis: "+this.c)),t+=at(this.o),this.h.a.length){var e=f(this.h.a,function(t,e){return t+at(e)},"Predicates:");t+=at(e)}return t},jt.prototype.toString=function(){return this.j};var qt={};function $t(t,e,n,r){if(qt.hasOwnProperty(t))throw Error("Axis already created: "+t);return e=new jt(t,e,n,!!r),qt[t]=e}$t("ancestor",function(t,e){for(var n=new z,r=e;r=r.parentNode;)t.a(r)&&Z(n,r);return n},!0),$t("ancestor-or-self",function(t,e){var n=new z,r=e;do{t.a(r)&&Z(n,r)}while(r=r.parentNode);return n},!0);var Yt=$t("attribute",function(t,e){var n=new z;if("style"==(i=t.f())&&D&&e.style)return tt(n,new x(e.style,e,"style",e.style.cssText)),n;var r=e.attributes;if(r)if(t instanceof Ot&&null===t.b||"*"==i)for(var o,i=0;o=r[i];i++)D?o.nodeValue&&tt(n,U(e,o)):tt(n,o);else(o=r.getNamedItem(i))&&(D?o.nodeValue&&tt(n,U(e,o)):tt(n,o));return n},!1),Xt=$t("child",function(t,e,r,o,i){return(D?H:j).call(null,t,e,n(r)?r:null,n(o)?o:null,i||new z)},!1,!0);$t("descendant",B,!1,!0);var Wt=$t("descendant-or-self",function(t,e,n,r){var o=new z;return k(e,n,r)&&t.a(e)&&tt(o,e),B(t,e,n,r,o)},!1,!0),Kt=$t("following",function(t,e,n,r){var o=new z;do{for(var i=e;i=i.nextSibling;)k(i,n,r)&&t.a(i)&&tt(o,i),o=B(t,i,n,r,o)}while(e=e.parentNode);return o},!1,!0);$t("following-sibling",function(t,e){for(var n=new z,r=e;r=r.nextSibling;)t.a(r)&&tt(n,r);return n},!1),$t("namespace",function(){return new z},!1);var zt=$t("parent",function(t,e){var n=new z;if(9==e.nodeType)return n;if(2==e.nodeType)return tt(n,e.ownerElement),n;var r=e.parentNode;return t.a(r)&&tt(n,r),n},!1),Qt=$t("preceding",function(t,e,n,r){var o=new z,i=[];do{i.unshift(e)}while(e=e.parentNode);for(var s=1,a=i.length;s<a;s++){var c=[];for(e=i[s];e=e.previousSibling;)c.unshift(e);for(var l=0,u=c.length;l<u;l++)k(e=c[l],n,r)&&t.a(e)&&tt(o,e),o=B(t,e,n,r,o)}return o},!0,!0);$t("preceding-sibling",function(t,e){for(var n=new z,r=e;r=r.previousSibling;)t.a(r)&&Z(n,r);return n},!0);var Jt=$t("self",function(t,e){var n=new z;return t.a(e)&&tt(n,e),n},!1);function Zt(t){st.call(this,1),this.c=t,this.g=t.g,this.b=t.b}function te(t){st.call(this,1),this.c=t}function ee(t,e){this.a=t,this.b=e}function ne(t){for(var e,n=[];;){re(t,"Missing right hand side of binary expression."),e=ue(t);var r=vt(t.a);if(!r)break;var o=(r=gt[r]||null)&&r.w;if(!o){t.a.a--;break}for(;n.length&&o<=n[n.length-1].w;)e=new pt(n.pop(),n.pop(),e);n.push(e,r)}for(;n.length;)e=new pt(n.pop(),n.pop(),e);return e}function re(t,e){if(wt(t.a))throw Error(e)}function oe(t,e){var n=vt(t.a);if(n!=e)throw Error("Bad token, expected: "+e+" got: "+n)}function ie(t){if(")"!=(t=vt(t.a)))throw Error("Bad token: "+t)}function se(t){if(2>(t=vt(t.a)).length)throw Error("Unclosed literal string");return new Dt(t)}function ae(t){var e,n,r=[];if(kt(_t(t.a))){if(e=vt(t.a),n=_t(t.a),"/"==e&&(wt(t.a)||"."!=n&&".."!=n&&"@"!=n&&"*"!=n&&!/(?![0-9])[\w]/.test(n)))return new Ut;n=new Ut,re(t,"Missing next location step."),e=ce(t,e),r.push(e)}else{t:{switch(n=(e=_t(t.a)).charAt(0)){case"$":throw Error("Variable reference not allowed in HTML XPath");case"(":vt(t.a),e=ne(t),re(t,'unclosed "("'),oe(t,")");break;case'"':case"'":e=se(t);break;default:if(isNaN(+e)){if(yt(e)||!/(?![0-9])[\w]/.test(n)||"("!=_t(t.a,1)){e=null;break t}for(e=vt(t.a),e=bt[e]||null,vt(t.a),n=[];")"!=_t(t.a)&&(re(t,"Missing function argument list."),n.push(ne(t)),","==_t(t.a));)vt(t.a);re(t,"Unclosed function argument list."),ie(t),e=new It(e,n)}else e=new te(+vt(t.a))}"["==_t(t.a)&&(e=new Tt(e,n=new Gt(le(t))))}if(e){if(!kt(_t(t.a)))return e;n=e}else e=ce(t,"/"),n=new Ft,r.push(e)}for(;kt(_t(t.a));)e=vt(t.a),re(t,"Missing next location step."),e=ce(t,e),r.push(e);return new xt(n,r)}function ce(t,e){var n,r,o,i;if("/"!=e&&"//"!=e)throw Error('Step op should be "/" or "//"');if("."==_t(t.a))return r=new Ht(Jt,new Ot("node")),vt(t.a),r;if(".."==_t(t.a))return r=new Ht(zt,new Ot("node")),vt(t.a),r;if("@"==_t(t.a))i=Yt,vt(t.a),re(t,"Missing attribute name");else if("::"==_t(t.a,1)){if(!/(?![0-9])[\w]/.test(_t(t.a).charAt(0)))throw Error("Bad token: "+vt(t.a));if(n=vt(t.a),!(i=qt[n]||null))throw Error("No axis with name: "+n);vt(t.a),re(t,"Missing node name")}else i=Xt;if(n=_t(t.a),!/(?![0-9])[\w\*]/.test(n.charAt(0)))throw Error("Bad token: "+vt(t.a));if("("==_t(t.a,1)){if(!yt(n))throw Error("Invalid node type: "+n);if(!yt(n=vt(t.a)))throw Error("Invalid type name: "+n);oe(t,"("),re(t,"Bad nodetype");var s=null;'"'!=(o=_t(t.a).charAt(0))&&"'"!=o||(s=se(t)),re(t,"Bad nodetype"),ie(t),n=new Ot(n,s)}else if(-1==(o=(n=vt(t.a)).indexOf(":")))n=new Pt(n);else{var a;if("*"==(s=n.substring(0,o)))a="*";else if(!(a=t.b(s)))throw Error("Namespace prefix not declared: "+s);n=new Pt(n=n.substr(o+1),a)}return o=new Gt(le(t),i.a),r||new Ht(i,n,o,"//"==e)}function le(t){for(var e=[];"["==_t(t.a);){vt(t.a),re(t,"Missing predicate expression.");var n=ne(t);e.push(n),re(t,"Unclosed predicate expression."),oe(t,"]")}return e}function ue(t){if("-"==_t(t.a))return vt(t.a),new Zt(ue(t));var e=ae(t);if("|"!=_t(t.a))t=e;else{for(e=[e];"|"==vt(t.a);)re(t,"Missing next union location path."),e.push(ae(t));t.a.a--,t=new Bt(e)}return t}function he(t){switch(t.nodeType){case 1:return function(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}(pe,t);case 9:return he(t.documentElement);case 11:case 10:case 6:case 12:return de;default:return t.parentNode?he(t.parentNode):de}}function de(){return null}function pe(t,e){if(t.prefix==e)return t.namespaceURI||"http://www.w3.org/1999/xhtml";var n=t.getAttributeNode("xmlns:"+e);return n&&n.specified?n.value||null:t.parentNode&&9!=t.parentNode.nodeType?pe(t.parentNode,e):null}function fe(t,e){if(!t.length)throw Error("Empty XPath expression.");var n=function(t){t=t.match(Lt);for(var e=0;e<t.length;e++)Mt.test(t[e])&&t.splice(e,1);return new Ct(t)}(t);if(wt(n))throw Error("Invalid XPath expression.");e?"function"==function(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}(e)||(e=i(e.lookupNamespaceURI,e)):e=function(){return null};var r=ne(new ee(n,e));if(!wt(n))throw Error("Bad token: "+vt(n));this.evaluate=function(t,e){return new me(r.a(new St(t)),e)}}function me(t,e){if(0==e)if(t instanceof z)e=4;else if("string"==typeof t)e=2;else if("number"==typeof t)e=1;else{if("boolean"!=typeof t)throw Error("Unexpected evaluation result.");e=3}if(2!=e&&1!=e&&3!=e&&!(t instanceof z))throw Error("value could not be converted to the specified type");var n;switch(this.resultType=e,e){case 2:this.stringValue=t instanceof z?nt(t):""+t;break;case 1:this.numberValue=t instanceof z?+nt(t):+t;break;case 3:this.booleanValue=t instanceof z?0<t.l:!!t;break;case 4:case 5:case 6:case 7:var r=rt(t);n=[];for(var o=it(r);o;o=it(r))n.push(o instanceof x?o.a:o);this.snapshotLength=t.l,this.invalidIteratorState=!1;break;case 8:case 9:r=et(t),this.singleNodeValue=r instanceof x?r.a:r;break;default:throw Error("Unknown XPathResult type.")}var i=0;this.iterateNext=function(){if(4!=e&&5!=e)throw Error("iterateNext called with wrong result type");return i>=n.length?null:n[i++]},this.snapshotItem=function(t){if(6!=e&&7!=e)throw Error("snapshotItem called with wrong result type");return t>=n.length||0>t?null:n[t]}}function ge(t){this.lookupNamespaceURI=he(t)}function Ee(t,n){var r=t||e,o=r.Document&&r.Document.prototype||r.document;o.evaluate&&!n||(r.XPathResult=me,o.evaluate=function(t,e,n,r){return new fe(t,n).evaluate(e,r)},o.createExpression=function(t,e){return new fe(t,e)},o.createNSResolver=function(t){return new ge(t)})}s(Zt),Zt.prototype.a=function(t){return-ut(this.c,t)},Zt.prototype.toString=function(){return"Unary Expression: -"+at(this.c)},s(te),te.prototype.a=function(){return this.c},te.prototype.toString=function(){return"Number: "+this.c},me.ANY_TYPE=0,me.NUMBER_TYPE=1,me.STRING_TYPE=2,me.BOOLEAN_TYPE=3,me.UNORDERED_NODE_ITERATOR_TYPE=4,me.ORDERED_NODE_ITERATOR_TYPE=5,me.UNORDERED_NODE_SNAPSHOT_TYPE=6,me.ORDERED_NODE_SNAPSHOT_TYPE=7,me.ANY_UNORDERED_NODE_TYPE=8,me.FIRST_ORDERED_NODE_TYPE=9;var Ne,Se=["wgxpath","install"],Te=e;Se[0]in Te||!Te.execScript||Te.execScript("var "+Se[0]);for(;Se.length&&(Ne=Se.shift());)Se.length||void 0===Ee?Te=Te[Ne]?Te[Ne]:Te[Ne]={}:Te[Ne]=Ee;t.exports.install=Ee,t.exports.XPathResultType={ANY_TYPE:0,NUMBER_TYPE:1,STRING_TYPE:2,BOOLEAN_TYPE:3,UNORDERED_NODE_ITERATOR_TYPE:4,ORDERED_NODE_ITERATOR_TYPE:5,UNORDERED_NODE_SNAPSHOT_TYPE:6,ORDERED_NODE_SNAPSHOT_TYPE:7,ANY_UNORDERED_NODE_TYPE:8,FIRST_ORDERED_NODE_TYPE:9}}).call(n.g)}},__webpack_module_cache__={},leafPrototypes,getProto;function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](n,n.exports,__webpack_require__),n.exports}getProto=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,__webpack_require__.t=function(t,e){if(1&e&&(t=this(t)),8&e)return t;if("object"==typeof t&&t){if(4&e&&t.__esModule)return t;if(16&e&&"function"==typeof t.then)return t}var n=Object.create(null);__webpack_require__.r(n);var r={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var o=2&e&&t;("object"==typeof o||"function"==typeof o)&&!~leafPrototypes.indexOf(o);o=getProto(o))Object.getOwnPropertyNames(o).forEach(e=>r[e]=()=>t[e]);return r.default=()=>t,__webpack_require__.d(n,r),n},__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{cli:()=>Vh,engineReady:()=>ph,engineSetup:()=>hh,exit:()=>_h,file:()=>yh,localeLoader:()=>fh,localePath:()=>kh,move:()=>Mh,number:()=>Ih,numericOrdinal:()=>bh,ordinal:()=>Ah,processFile:()=>Ch,resetEngine:()=>dh,setupEngine:()=>uh,toDescription:()=>Sh,toEnriched:()=>Th,toJson:()=>Eh,toSemantic:()=>gh,toSpeech:()=>mh,toSpeechStructure:()=>vh,toVis:()=>Nh,variables:()=>Hh,version:()=>lh,vulgar:()=>Rh,walk:()=>Lh,workerLocalePreferences:()=>xh,workerNextRules:()=>Dh,workerNextStyle:()=>Ph,workerRelevantPreferences:()=>Uh,workerSpeech:()=>wh});var t={};__webpack_require__.r(t),__webpack_require__.d(t,{NodeType:()=>D,cloneNode:()=>X,createElement:()=>k,createElementNS:()=>B,createTextNode:()=>G,formatXml:()=>V,parseInput:()=>w,querySelectorAll:()=>$,querySelectorAllByAttr:()=>j,querySelectorAllByAttrValue:()=>q,replaceNode:()=>F,serializeXml:()=>W,tagName:()=>Y,toArray:()=>v});var e,n,r,o={};__webpack_require__.r(o),__webpack_require__.d(o,{engineReady:()=>ph,engineSetup:()=>hh,exit:()=>_h,file:()=>yh,localeLoader:()=>fh,localePath:()=>kh,move:()=>Mh,number:()=>Ih,numericOrdinal:()=>bh,ordinal:()=>Ah,processFile:()=>Ch,resetEngine:()=>dh,setupEngine:()=>uh,toDescription:()=>Sh,toEnriched:()=>Th,toJson:()=>Eh,toSemantic:()=>gh,toSpeech:()=>mh,toSpeechStructure:()=>vh,toVis:()=>Nh,version:()=>lh,vulgar:()=>Rh,walk:()=>Lh,workerLocalePreferences:()=>xh,workerNextRules:()=>Dh,workerNextStyle:()=>Ph,workerRelevantPreferences:()=>Uh,workerSpeech:()=>wh}),function(t){t.DOMAIN="domain",t.STYLE="style",t.LOCALE="locale",t.TOPIC="topic",t.MODALITY="modality"}(e||(e={}));class i{static createProp(...t){const e=s.DEFAULT_ORDER,n={};for(let r=0,o=t.length,i=e.length;r<o&&r<i;r++)n[e[r]]=t[r];return new i(n)}constructor(t,e=Object.keys(t)){this.properties=t,this.order=e}getProperties(){return this.properties}getOrder(){return this.order}getAxes(){return this.order}getProperty(t){return this.properties[t]}updateProperties(t){this.properties=t}allProperties(){const t=[];return this.order.forEach(e=>t.push(this.getProperty(e).slice())),t}toString(){const t=[];return this.order.forEach(e=>t.push(e+": "+this.getProperty(e).toString())),t.join("\n")}}class s extends i{static createCstr(...t){const e=s.DEFAULT_ORDER,n={};for(let r=0,o=t.length,i=e.length;r<o&&r<i;r++)n[e[r]]=t[r];return new s(n)}static defaultCstr(){return s.createCstr.apply(null,s.DEFAULT_ORDER.map(function(t){return s.DEFAULT_VALUES[t]}))}static validOrder(t){const e=s.DEFAULT_ORDER.slice();return t.every(t=>{const n=e.indexOf(t);return-1!==n&&e.splice(n,1)})}constructor(t,e){const n={};for(const[e,r]of Object.entries(t))n[e]=[r];super(n,e),this.components=t}getComponents(){return this.components}getValue(t){return this.components[t]}getValues(){return this.order.map(t=>this.getValue(t))}allProperties(){const t=super.allProperties();for(let e,n,r=0;e=t[r],n=this.order[r];r++){const t=this.getValue(n);-1===e.indexOf(t)&&e.unshift(t)}return t}toString(){return this.getValues().join(".")}equal(t){const e=t.getAxes();if(this.order.length!==e.length)return!1;for(let n,r=0;n=e[r];r++){const e=this.getValue(n);if(!e||t.getValue(n)!==e)return!1}return!0}}s.DEFAULT_ORDER=[e.LOCALE,e.MODALITY,e.DOMAIN,e.STYLE,e.TOPIC],s.BASE_LOCALE="base",s.DEFAULT_VALUE="default",s.DEFAULT_VALUES={[e.LOCALE]:"en",[e.DOMAIN]:s.DEFAULT_VALUE,[e.STYLE]:s.DEFAULT_VALUE,[e.TOPIC]:s.DEFAULT_VALUE,[e.MODALITY]:"speech"};class a{constructor(t){this.order=t}parse(t){const e=t.split("."),n={};if(e.length>this.order.length)throw new Error("Invalid dynamic constraint: "+n);let r=0;for(let t,o=0;t=this.order[o],e.length;o++,r++){const r=e.shift();n[t]=r}return new s(n,this.order.slice(0,r))}}class c{constructor(t,e=new i(t.getProperties(),t.getOrder())){this.reference=t,this.fallback=e,this.order=this.reference.getOrder()}getReference(){return this.reference}setReference(t,e){this.reference=t,this.fallback=e||new i(t.getProperties(),t.getOrder()),this.order=this.reference.getOrder()}match(t){const e=t.getAxes();return e.length===this.reference.getAxes().length&&e.every(e=>{const n=t.getValue(e);return n===this.reference.getValue(e)||-1!==this.fallback.getProperty(e).indexOf(n)})}compare(t,e){let n=!1;for(let r,o=0;r=this.order[o];o++){const o=t.getValue(r),i=e.getValue(r);if(!n){const t=this.reference.getValue(r);if(t===o&&t!==i)return-1;if(t===i&&t!==o)return 1;if(t===o&&t===i)continue;t!==o&&t!==i&&(n=!0)}const s=this.fallback.getProperty(r),a=s.indexOf(o),c=s.indexOf(i);if(a<c)return-1;if(c<a)return 1}return 0}toString(){return this.reference.toString()+"\n"+this.fallback.toString()}}!function(t){t.SYNC="sync",t.ASYNC="async",t.HTTP="http"}(n||(n={})),function(t){t.PITCH="pitch",t.RATE="rate",t.VOLUME="volume",t.PAUSE="pause",t.JOIN="join",t.LAYOUT="layout"}(r||(r={}));const l=[r.PITCH,r.RATE,r.VOLUME,r.PAUSE,r.JOIN];var u,h;!function(t){t.NONE="none",t.SHALLOW="shallow",t.DEEP="deep"}(u||(u={})),function(t){t.NONE="none",t.LAYOUT="layout",t.COUNTING="counting",t.PUNCTUATION="punctuation",t.SSML="ssml",t.ACSS="acss",t.SABLE="sable",t.VOICEXML="voicexml"}(h||(h={}));const d={mathspeak:"default",clearspeak:"default"};var p=__webpack_require__(95);function f(t){return t.match("/$")?t:t+"/"}function m(t,e="json"){return f(p.f.jsonPath)+t+(e.match(/^\./)?e:"."+e)}class g{static getInstance(){return g.instance=g.instance||new g,g.instance}init(t){return t&&this.startDebugFile_(t),this.isActive_=!0,this.fileHandle}output(...t){this.isActive_&&this.output_(t)}generate(t){this.isActive_&&this.output_(t.apply(t,[]))}exit(t=()=>{}){this.stream_&&this.fileHandle.then(()=>{this.isActive_&&this.stream_&&(this.stream_.end("","",t),this.stream_=null)}),this.isActive_=!1}constructor(){this.isActive_=!1,this.fileHandle=Promise.resolve(),this.stream_=null}startDebugFile_(t){this.fileHandle=p.f.fs.promises.open(t,"w"),this.fileHandle=this.fileHandle.then(e=>{this.stream_=e.createWriteStream(t),this.outputFunction=function(...t){this.stream_.write(t.join(" ")),this.stream_.write("\n")}.bind(this),this.stream_.on("error",function(t){console.info("Invalid log file. Debug information sent to console."),this.outputFunction=console.info}.bind(this)),this.stream_.on("finish",function(){console.info("Finalizing debug file.")})})}output_(t){this.stream_?this.fileHandle.then(()=>this.outputFunction.apply(this.outputFunction,["Speech Rule Engine Debugger:"].concat(t))):console.info(...["Speech Rule Engine Debugger:"].concat(t))}}var E=__webpack_require__(679);class N{constructor(t={}){this.delay=!1,this.domain="clearspeak",this.style=s.DEFAULT_VALUES[e.STYLE],this.locale=s.DEFAULT_VALUES[e.LOCALE],this.subiso="",this.modality=s.DEFAULT_VALUES[e.MODALITY],this.speech=u.NONE,this.markup=h.NONE,this.mark=!0,this.automark=!1,this.character=!0,this.cleanpause=!0,this.cayleyshort=!0,this.linebreaks=!1,this.rate="100",this.walker="Table",this.structure=!1,this.aria=!1,this.tree=!1,this.strict=!1,this.pprint=!1,this.rules="",this.prune="",this.set(t)}set(t){this.ensureDomain(t);for(const[e,n]of Object.entries(t))(N.BINARY_FEATURES.includes(e)||N.STRING_FEATURES.includes(e))&&(this[e]=n)}json(){const t={};return[].concat(N.STRING_FEATURES,N.BINARY_FEATURES).forEach(e=>t[e]=this[e]),t}ensureDomain(t){if(t.modality&&"speech"!==t.modality||!t.modality&&"speech"!==this.modality)return;if(!t.domain&&!t.locale)return;if("default"===t.domain)return void(t.domain="mathspeak");const e=t.locale||this.locale,n=t.domain||this.domain;-1===S.indexOf(e)||"mathspeak"===n?"en"!==e?"mathspeak"!==n&&"clearspeak"!==n&&(t.domain="mathspeak"):-1===T.indexOf(n)&&(t.domain="mathspeak"):t.domain="mathspeak"}}N.BINARY_FEATURES=["automark","mark","character","cleanpause","strict","structure","aria","pprint","cayleyshort","linebreaks","tree"],N.STRING_FEATURES=["markup","style","domain","speech","walker","locale","delay","modality","rate","rules","subiso","prune"];const S=["ca","da","es"],T=["chromevox","clearspeak","mathspeak","emacspeak","html"];class I extends Error{constructor(t=""){super(),this.message=t,this.name="SRE Error"}}class A{set defaultLocale(t){this._defaultLocale=E.u.ensureLocale(t,this._defaultLocale)}get defaultLocale(){return this._defaultLocale}static getInstance(){return A.instance=A.instance||new A,A.instance}static defaultEvaluator(t,e){return t}static evaluateNode(t){return A.nodeEvaluator(t)}getRate(){const t=parseInt(this.options.rate,10);return isNaN(t)?100:t}setDynamicCstr(t){if(this.defaultLocale&&(s.DEFAULT_VALUES[e.LOCALE]=this.defaultLocale),t){const e=Object.keys(t);for(let n=0;n<e.length;n++){const r=e[n];if(-1!==s.DEFAULT_ORDER.indexOf(r)){const e=t[r];this.options[r]=e}}}const n=[this.options.locale,this.options.modality,this.options.domain,this.options.style].join("."),r=i.createProp([s.DEFAULT_VALUES[e.LOCALE]],[s.DEFAULT_VALUES[e.MODALITY]],[s.DEFAULT_VALUES[e.DOMAIN]],[s.DEFAULT_VALUES[e.STYLE]]),o=this.comparators[this.options.domain],a=this.parsers[this.options.domain];this.parser=a||this.defaultParser,this.dynamicCstr=this.parser.parse(n),this.dynamicCstr.updateProperties(r.getProperties()),this.comparator=o?o():new c(this.dynamicCstr)}constructor(){this.options=new N,this.config=!1,this.customLoader=null,this.parsers={},this.comparator=null,this.mode=n.SYNC,this.init=!0,this.comparators={},this._defaultLocale=s.DEFAULT_VALUES[e.LOCALE],this.options.locale=this.defaultLocale,this.evaluator=A.defaultEvaluator,this.defaultParser=new a(s.DEFAULT_ORDER),this.parser=this.defaultParser,this.dynamicCstr=s.defaultCstr()}configurate(t){this.mode!==n.HTTP||p.f.webworker||this.config||(!function(t){const e=document.documentElement.querySelectorAll('script[type="text/x-sre-config"]');for(let n=0,r=e.length;n<r;n++){let r;try{r=e[n].innerHTML;const o=JSON.parse(r);for(const[e,n]of Object.entries(o))t[e]=n}catch(t){g.getInstance().output("Illegal configuration ",r)}}}(t),this.config=!0),function(t){if("undefined"!=typeof SREfeature)for(const[e,n]of Object.entries(SREfeature))t[e]=n}(t)}setCustomLoader(t){t&&(this.customLoader=t)}setup(t){void 0!==t.mode&&(this.mode=t.mode),this.configurate(t),this.options.set(t),t.json&&(p.f.jsonPath=f(t.json)),this.setCustomLoader(t.custom)}json(){return Object.assign({mode:this.mode},this.options.json())}reset(){this.options=new N}}A.nodeEvaluator=function(t){return[]};class b{static get(t=A.getInstance().options.locale){return b.promises[t]||Promise.resolve("")}static getall(){return Promise.all(Object.values(b.promises))}}b.loaded={},b.promises={};const R=p.f.xpath,O={xhtml:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",mml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function y(t){return O[t]||null}class C{constructor(){this.lookupNamespaceURI=y}}function L(t,e,n){return R.evaluate(t,e,new C,n,null)}function M(t,e){let n;try{n=L(t,e,R.result.ORDERED_NODE_ITERATOR_TYPE)}catch(t){return[]}const r=[];for(let t=n.iterateNext();t;t=n.iterateNext())r.push(t);return r}function _(t){if(A.getInstance().mode!==n.HTTP)return;let e=t;for(;e&&!e.evaluate;)e=e.parentNode;e&&e.evaluate?R.currentDocument=e:t.ownerDocument&&(R.currentDocument=t.ownerDocument)}function v(t){const e=[];for(let n=0,r=t.length;n<r;n++)e.push(t[n]);return e}function w(t){const e=new p.f.xmldom.DOMParser,r=function(t){return(t=t.replace(/&nbsp;/g,"\xa0")).replace(/>[ \f\n\r\t\v\u200b]+</g,"><").trim()}(t),o=!!r.match(/&(?!lt|gt|amp|quot|apos)\w+;/g);if(!r)throw new I("Empty input!");try{const t=e.parseFromString(r,o?"text/html":"text/xml");return A.getInstance().mode===n.HTTP?(R.currentDocument=t,o?t.body.childNodes[0]:t.documentElement):t.documentElement}catch(t){throw new I("Illegal input: "+t.message)}}var D,P,x,U;function F(t,e){t.parentNode&&(t.parentNode.insertBefore(e,t),t.parentNode.removeChild(t))}function k(t){return p.f.document.createElement(t)}function B(t,e){return p.f.document.createElementNS(t,e)}function G(t){return p.f.document.createTextNode(t)}function V(t){let e="",n=/(>)(<)(\/*)/g,r=0,o=(t=t.replace(n,"$1\r\n$2$3")).split("\r\n");for(n=/(\.)*(<)(\/*)/g,o=o.map(t=>t.replace(n,"$1\r\n$2$3").split("\r\n")).reduce((t,e)=>t.concat(e),[]);o.length;){let t=o.shift();if(!t)continue;let n=0;if(t.match(/^<\w[^>/]*>[^>]+$/)){const e=H(t,o[0]);e[0]?e[1]?(t+=o.shift().slice(0,-e[1].length),e[1].trim()&&o.unshift(e[1])):t+=o.shift():n=1}else if(t.match(/^<\/\w/))0!==r&&(r-=1);else if(t.match(/^<\w[^>]*[^/]>.*$/))n=1;else if(t.match(/^<\w[^>]*\/>.+$/)){const e=t.indexOf(">")+1,n=t.slice(e);n.trim()&&o.unshift(),t=t.slice(0,e)+n}else n=0;e+=new Array(r+1).join("  ")+t+"\r\n",r+=n}return e}function H(t,e){if(!e)return[!1,""];const n=t.match(/^<([^> ]+).*>/),r=e.match(/^<\/([^>]+)>(.*)/);return n&&r&&n[1]===r[1]?[!0,r[2]]:[!1,""]}function j(t,e){return t.querySelectorAll?v(t.querySelectorAll(`[${e}]`)):M(`.//*[@${e}]`,t)}function q(t,e,n){return t.querySelectorAll?v(t.querySelectorAll(`[${e}="${n}"]`)):M(`.//*[@${e}="${n}"]`,t)}function $(t,e){return t.querySelectorAll?v(t.querySelectorAll(e)):M(`.//${e}`,t)}function Y(t){return t.tagName.toUpperCase()}function X(t){return t.cloneNode(!0)}function W(t){return(new p.f.xmldom.XMLSerializer).serializeToString(t)}function K(t){const e=t.toString(16).toUpperCase();return e.length>3?e:("000"+e).slice(-4)}function z([t,e],n){const r=parseInt(t,16),o=parseInt(e,16),i=[];for(let t=r;t<=o;t++){let e=K(t);!1!==n[e]&&(e=n[e]||e,i.push(e))}return i}function Q(t,e={}){return z(t,e).map(t=>String.fromCodePoint(parseInt(t,16)))}!function(t){t[t.ELEMENT_NODE=1]="ELEMENT_NODE",t[t.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",t[t.TEXT_NODE=3]="TEXT_NODE",t[t.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",t[t.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",t[t.ENTITY_NODE=6]="ENTITY_NODE",t[t.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",t[t.COMMENT_NODE=8]="COMMENT_NODE",t[t.DOCUMENT_NODE=9]="DOCUMENT_NODE",t[t.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",t[t.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE",t[t.NOTATION_NODE=12]="NOTATION_NODE"}(D||(D={})),function(t){t.BOLD="bold",t.BOLDFRAKTUR="bold-fraktur",t.BOLDITALIC="bold-italic",t.BOLDSCRIPT="bold-script",t.DOUBLESTRUCK="double-struck",t.DOUBLESTRUCKITALIC="double-struck-italic",t.FULLWIDTH="fullwidth",t.FRAKTUR="fraktur",t.ITALIC="italic",t.MONOSPACE="monospace",t.NORMAL="normal",t.SCRIPT="script",t.SANSSERIF="sans-serif",t.SANSSERIFITALIC="sans-serif-italic",t.SANSSERIFBOLD="sans-serif-bold",t.SANSSERIFBOLDITALIC="sans-serif-bold-italic"}(P||(P={})),function(t){t.SUPER="super",t.SUB="sub",t.CIRCLED="circled",t.PARENTHESIZED="parenthesized",t.PERIOD="period",t.NEGATIVECIRCLED="negative-circled",t.DOUBLECIRCLED="double-circled",t.CIRCLEDSANSSERIF="circled-sans-serif",t.NEGATIVECIRCLEDSANSSERIF="negative-circled-sans-serif",t.COMMA="comma",t.SQUARED="squared",t.NEGATIVESQUARED="negative-squared"}(x||(x={})),function(t){t.LATINCAP="latinCap",t.LATINSMALL="latinSmall",t.GREEKCAP="greekCap",t.GREEKSMALL="greekSmall",t.DIGIT="digit"}(U||(U={}));const J=[{interval:["1D400","1D419"],base:U.LATINCAP,subst:{},capital:!0,category:"Lu",font:P.BOLD},{interval:["1D41A","1D433"],base:U.LATINSMALL,subst:{},capital:!1,category:"Ll",font:P.BOLD},{interval:["1D56C","1D585"],base:U.LATINCAP,subst:{},capital:!0,category:"Lu",font:P.BOLDFRAKTUR},{interval:["1D586","1D59F"],base:U.LATINSMALL,subst:{},capital:!1,category:"Ll",font:P.BOLDFRAKTUR},{interval:["1D468","1D481"],base:U.LATINCAP,subst:{},capital:!0,category:"Lu",font:P.BOLDITALIC},{interval:["1D482","1D49B"],base:U.LATINSMALL,subst:{},capital:!1,category:"Ll",font:P.BOLDITALIC},{interval:["1D4D0","1D4E9"],base:U.LATINCAP,subst:{},capital:!0,category:"Lu",font:P.BOLDSCRIPT},{interval:["1D4EA","1D503"],base:U.LATINSMALL,subst:{},capital:!1,category:"Ll",font:P.BOLDSCRIPT},{interval:["1D538","1D551"],base:U.LATINCAP,subst:{"1D53A":"2102","1D53F":"210D","1D545":"2115","1D547":"2119","1D548":"211A","1D549":"211D","1D551":"2124"},capital:!0,category:"Lu",font:P.DOUBLESTRUCK},{interval:["1D552","1D56B"],base:U.LATINSMALL,subst:{},capital:!1,category:"Ll",font:P.DOUBLESTRUCK},{interval:["1D504","1D51D"],base:U.LATINCAP,subst:{"1D506":"212D","1D50B":"210C","1D50C":"2111","1D515":"211C","1D51D":"2128"},capital:!0,category:"Lu",font:P.FRAKTUR},{interval:["1D51E","1D537"],base:U.LATINSMALL,subst:{},capital:!1,category:"Ll",font:P.FRAKTUR},{interval:["FF21","FF3A"],base:U.LATINCAP,subst:{},capital:!0,category:"Lu",font:P.FULLWIDTH},{interval:["FF41","FF5A"],base:U.LATINSMALL,subst:{},capital:!1,category:"Ll",font:P.FULLWIDTH},{interval:["1D434","1D44D"],base:U.LATINCAP,subst:{},capital:!0,category:"Lu",font:P.ITALIC},{interval:["1D44E","1D467"],base:U.LATINSMALL,subst:{"1D455":"210E"},capital:!1,category:"Ll",font:P.ITALIC},{interval:["1D670","1D689"],base:U.LATINCAP,subst:{},capital:!0,category:"Lu",font:P.MONOSPACE},{interval:["1D68A","1D6A3"],base:U.LATINSMALL,subst:{},capital:!1,category:"Ll",font:P.MONOSPACE},{interval:["0041","005A"],base:U.LATINCAP,subst:{},capital:!0,category:"Lu",font:P.NORMAL},{interval:["0061","007A"],base:U.LATINSMALL,subst:{},capital:!1,category:"Ll",font:P.NORMAL},{interval:["1D49C","1D4B5"],base:U.LATINCAP,subst:{"1D49D":"212C","1D4A0":"2130","1D4A1":"2131","1D4A3":"210B","1D4A4":"2110","1D4A7":"2112","1D4A8":"2133","1D4AD":"211B"},capital:!0,category:"Lu",font:P.SCRIPT},{interval:["1D4B6","1D4CF"],base:U.LATINSMALL,subst:{"1D4BA":"212F","1D4BC":"210A","1D4C4":"2134"},capital:!1,category:"Ll",font:P.SCRIPT},{interval:["1D5A0","1D5B9"],base:U.LATINCAP,subst:{},capital:!0,category:"Lu",font:P.SANSSERIF},{interval:["1D5BA","1D5D3"],base:U.LATINSMALL,subst:{},capital:!1,category:"Ll",font:P.SANSSERIF},{interval:["1D608","1D621"],base:U.LATINCAP,subst:{},capital:!0,category:"Lu",font:P.SANSSERIFITALIC},{interval:["1D622","1D63B"],base:U.LATINSMALL,subst:{},capital:!1,category:"Ll",font:P.SANSSERIFITALIC},{interval:["1D5D4","1D5ED"],base:U.LATINCAP,subst:{},capital:!0,category:"Lu",font:P.SANSSERIFBOLD},{interval:["1D5EE","1D607"],base:U.LATINSMALL,subst:{},capital:!1,category:"Ll",font:P.SANSSERIFBOLD},{interval:["1D63C","1D655"],base:U.LATINCAP,subst:{},capital:!0,category:"Lu",font:P.SANSSERIFBOLDITALIC},{interval:["1D656","1D66F"],base:U.LATINSMALL,subst:{},capital:!1,category:"Ll",font:P.SANSSERIFBOLDITALIC},{interval:["0391","03A9"],base:U.GREEKCAP,subst:{"03A2":"03F4"},capital:!0,category:"Lu",font:P.NORMAL},{interval:["03B0","03D0"],base:U.GREEKSMALL,subst:{"03B0":"2207","03CA":"2202","03CB":"03F5","03CC":"03D1","03CD":"03F0","03CE":"03D5","03CF":"03F1","03D0":"03D6"},capital:!1,category:"Ll",font:P.NORMAL},{interval:["1D6A8","1D6C0"],base:U.GREEKCAP,subst:{},capital:!0,category:"Lu",font:P.BOLD},{interval:["1D6C1","1D6E1"],base:U.GREEKSMALL,subst:{},capital:!1,category:"Ll",font:P.BOLD},{interval:["1D6E2","1D6FA"],base:U.GREEKCAP,subst:{},capital:!0,category:"Lu",font:P.ITALIC},{interval:["1D6FB","1D71B"],base:U.GREEKSMALL,subst:{},capital:!1,category:"Ll",font:P.ITALIC},{interval:["1D71C","1D734"],base:U.GREEKCAP,subst:{},capital:!0,category:"Lu",font:P.BOLDITALIC},{interval:["1D735","1D755"],base:U.GREEKSMALL,subst:{},capital:!1,category:"Ll",font:P.BOLDITALIC},{interval:["1D756","1D76E"],base:U.GREEKCAP,subst:{},capital:!0,category:"Lu",font:P.SANSSERIFBOLD},{interval:["1D76F","1D78F"],base:U.GREEKSMALL,subst:{},capital:!1,category:"Ll",font:P.SANSSERIFBOLD},{interval:["1D790","1D7A8"],base:U.GREEKCAP,subst:{},capital:!0,category:"Lu",font:P.SANSSERIFBOLDITALIC},{interval:["1D7A9","1D7C9"],base:U.GREEKSMALL,subst:{},capital:!1,category:"Ll",font:P.SANSSERIFBOLDITALIC},{interval:["0030","0039"],base:U.DIGIT,subst:{},offset:0,category:"Nd",font:P.NORMAL},{interval:["2070","2079"],base:U.DIGIT,subst:{2071:"00B9",2072:"00B2",2073:"00B3"},offset:0,category:"No",font:x.SUPER},{interval:["2080","2089"],base:U.DIGIT,subst:{},offset:0,category:"No",font:x.SUB},{interval:["245F","2473"],base:U.DIGIT,subst:{"245F":"24EA"},offset:0,category:"No",font:x.CIRCLED},{interval:["3251","325F"],base:U.DIGIT,subst:{},offset:21,category:"No",font:x.CIRCLED},{interval:["32B1","32BF"],base:U.DIGIT,subst:{},offset:36,category:"No",font:x.CIRCLED},{interval:["2474","2487"],base:U.DIGIT,subst:{},offset:1,category:"No",font:x.PARENTHESIZED},{interval:["2487","249B"],base:U.DIGIT,subst:{2487:"1F100"},offset:0,category:"No",font:x.PERIOD},{interval:["2775","277F"],base:U.DIGIT,subst:{2775:"24FF"},offset:0,category:"No",font:x.NEGATIVECIRCLED},{interval:["24EB","24F4"],base:U.DIGIT,subst:{},offset:11,category:"No",font:x.NEGATIVECIRCLED},{interval:["24F5","24FE"],base:U.DIGIT,subst:{},offset:1,category:"No",font:x.DOUBLECIRCLED},{interval:["277F","2789"],base:U.DIGIT,subst:{"277F":"1F10B"},offset:0,category:"No",font:x.CIRCLEDSANSSERIF},{interval:["2789","2793"],base:U.DIGIT,subst:{2789:"1F10C"},offset:0,category:"No",font:x.NEGATIVECIRCLEDSANSSERIF},{interval:["FF10","FF19"],base:U.DIGIT,subst:{},offset:0,category:"Nd",font:P.FULLWIDTH},{interval:["1D7CE","1D7D7"],base:U.DIGIT,subst:{},offset:0,category:"Nd",font:P.BOLD},{interval:["1D7D8","1D7E1"],base:U.DIGIT,subst:{},offset:0,category:"Nd",font:P.DOUBLESTRUCK},{interval:["1D7E2","1D7EB"],base:U.DIGIT,subst:{},offset:0,category:"Nd",font:P.SANSSERIF},{interval:["1D7EC","1D7F5"],base:U.DIGIT,subst:{},offset:0,category:"Nd",font:P.SANSSERIFBOLD},{interval:["1D7F6","1D7FF"],base:U.DIGIT,subst:{},offset:0,category:"Nd",font:P.MONOSPACE},{interval:["1F101","1F10A"],base:U.DIGIT,subst:{},offset:0,category:"No",font:x.COMMA},{interval:["24B6","24CF"],base:U.LATINCAP,subst:{},capital:!0,category:"So",font:x.CIRCLED},{interval:["24D0","24E9"],base:U.LATINSMALL,subst:{},capital:!1,category:"So",font:x.CIRCLED},{interval:["1F110","1F129"],base:U.LATINCAP,subst:{},capital:!0,category:"So",font:x.PARENTHESIZED},{interval:["249C","24B5"],base:U.LATINSMALL,subst:{},capital:!1,category:"So",font:x.PARENTHESIZED},{interval:["1F130","1F149"],base:U.LATINCAP,subst:{},capital:!0,category:"So",font:x.SQUARED},{interval:["1F170","1F189"],base:U.LATINCAP,subst:{},capital:!0,category:"So",font:x.NEGATIVESQUARED},{interval:["1F150","1F169"],base:U.LATINCAP,subst:{},capital:!0,category:"So",font:x.NEGATIVECIRCLED}],Z=new Map;function tt(t,e){return t+e.split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}for(const t of J){const e=tt(t.base,t.font),n=Q(t.interval,t.subst);let r=Z.get(e);r?r.unicode=r.unicode.concat(n):(r=t,r.unicode=n,Z.set(e,r))}var et;!function(t){t.PUNCTUATION="punctuation",t.FENCE="fence",t.NUMBER="number",t.IDENTIFIER="identifier",t.TEXT="text",t.OPERATOR="operator",t.RELATION="relation",t.LARGEOP="largeop",t.FUNCTION="function",t.ACCENT="accent",t.FENCED="fenced",t.FRACTION="fraction",t.PUNCTUATED="punctuated",t.RELSEQ="relseq",t.MULTIREL="multirel",t.INFIXOP="infixop",t.PREFIXOP="prefixop",t.POSTFIXOP="postfixop",t.APPL="appl",t.INTEGRAL="integral",t.BIGOP="bigop",t.SQRT="sqrt",t.ROOT="root",t.LIMUPPER="limupper",t.LIMLOWER="limlower",t.LIMBOTH="limboth",t.SUBSCRIPT="subscript",t.SUPERSCRIPT="superscript",t.UNDERSCORE="underscore",t.OVERSCORE="overscore",t.TENSOR="tensor",t.TABLE="table",t.MULTILINE="multiline",t.MATRIX="matrix",t.VECTOR="vector",t.CASES="cases",t.ROW="row",t.LINE="line",t.CELL="cell",t.ENCLOSE="enclose",t.INFERENCE="inference",t.RULELABEL="rulelabel",t.CONCLUSION="conclusion",t.PREMISES="premises",t.UNKNOWN="unknown",t.EMPTY="empty"}(et||(et={}));const nt=Object.assign({},et);var rt;!function(t){t.COMMA="comma",t.SEMICOLON="semicolon",t.ELLIPSIS="ellipsis",t.FULLSTOP="fullstop",t.QUESTION="question",t.EXCLAMATION="exclamation",t.QUOTES="quotes",t.DASH="dash",t.TILDE="tilde",t.PRIME="prime",t.DEGREE="degree",t.VBAR="vbar",t.COLON="colon",t.OPENFENCE="openfence",t.CLOSEFENCE="closefence",t.APPLICATION="application",t.DUMMY="dummy",t.UNIT="unit",t.LABEL="label",t.OPEN="open",t.CLOSE="close",t.TOP="top",t.BOTTOM="bottom",t.NEUTRAL="neutral",t.METRIC="metric",t.LATINLETTER="latinletter",t.GREEKLETTER="greekletter",t.OTHERLETTER="otherletter",t.NUMBERSET="numbersetletter",t.INTEGER="integer",t.FLOAT="float",t.OTHERNUMBER="othernumber",t.INFTY="infty",t.MIXED="mixed",t.MULTIACCENT="multiaccent",t.OVERACCENT="overaccent",t.UNDERACCENT="underaccent",t.UNDEROVER="underover",t.SUBSUP="subsup",t.LEFTSUB="leftsub",t.LEFTSUPER="leftsuper",t.RIGHTSUB="rightsub",t.RIGHTSUPER="rightsuper",t.LEFTRIGHT="leftright",t.ABOVEBELOW="abovebelow",t.INTERVAL="interval",t.SETEMPTY="set empty",t.SETEXT="set extended",t.SETSINGLE="set singleton",t.SETCOLLECT="set collection",t.STRING="string",t.SPACE="space",t.ANNOTATION="annotation",t.TEXT="text",t.SEQUENCE="sequence",t.ENDPUNCT="endpunct",t.STARTPUNCT="startpunct",t.NEGATIVE="negative",t.POSITIVE="positive",t.NEGATION="negation",t.MULTIOP="multiop",t.PREFIXOP="prefix operator",t.POSTFIXOP="postfix operator",t.LIMFUNC="limit function",t.INFIXFUNC="infix function",t.PREFIXFUNC="prefix function",t.POSTFIXFUNC="postfix function",t.SIMPLEFUNC="simple function",t.COMPFUNC="composed function",t.SUM="sum",t.INTEGRAL="integral",t.GEOMETRY="geometry",t.BOX="box",t.BLOCK="block",t.ADDITION="addition",t.MULTIPLICATION="multiplication",t.SUBTRACTION="subtraction",t.IMPLICIT="implicit",t.DIVISION="division",t.VULGAR="vulgar",t.EQUALITY="equality",t.INEQUALITY="inequality",t.ARROW="arrow",t.ELEMENT="element",t.NONELEMENT="nonelement",t.REELEMENT="reelement",t.RENONELEMENT="renonelement",t.SET="set",t.DETERMINANT="determinant",t.ROWVECTOR="rowvector",t.BINOMIAL="binomial",t.SQUAREMATRIX="squarematrix",t.CYCLE="cycle",t.MULTILINE="multiline",t.MATRIX="matrix",t.VECTOR="vector",t.CASES="cases",t.TABLE="table",t.CAYLEY="cayley",t.PROOF="proof",t.LEFT="left",t.RIGHT="right",t.UP="up",t.DOWN="down",t.FINAL="final",t.SINGLE="single",t.HYP="hyp",t.AXIOM="axiom",t.LOGIC="logic",t.UNKNOWN="unknown",t.MGLYPH="mglyph"}(rt||(rt={}));const ot=Object.assign({},rt);var it;!function(t){t.CALIGRAPHIC="caligraphic",t.CALIGRAPHICBOLD="caligraphic-bold",t.OLDSTYLE="oldstyle",t.OLDSTYLEBOLD="oldstyle-bold",t.UNKNOWN="unknown"}(it||(it={}));const st=Object.assign(Object.assign(Object.assign({},P),it),x);var at;!function(t){t.ALLLETTERS="allLetters",t.D="d",t.BAR="bar",t.TILDE="tilde",t.CURLY="curly",t.PAREN="paren",t.BRACKET="bracket",t.FLOOR="floor",t.CEIL="ceil"}(at||(at={}));const ct=Object.assign(Object.assign({},U),at);function lt(t,e){return t.toString()}function ut(t){return t.toString()}function ht(t,e){return t+e.toLowerCase()}const dt={};function pt(t,e=""){if(!t.childNodes||!t.childNodes[0]||!t.childNodes[0].childNodes||t.childNodes[0].childNodes.length<2||t.childNodes[0].childNodes[0].tagName!==nt.NUMBER||t.childNodes[0].childNodes[0].getAttribute("role")!==ot.INTEGER||t.childNodes[0].childNodes[1].tagName!==nt.NUMBER||t.childNodes[0].childNodes[1].getAttribute("role")!==ot.INTEGER)return{convertible:!1,content:t.textContent};const n=t.childNodes[0].childNodes[1].textContent,r=t.childNodes[0].childNodes[0].textContent,o=Number(n),i=Number(r);return isNaN(o)||isNaN(i)?{convertible:!1,content:`${r} ${e} ${n}`}:{convertible:!0,enumerator:i,denominator:o}}function ft(t,e,n){const r=pt(t);if(r.convertible){const t=r.enumerator,o=r.denominator;return t>0&&t<e&&o>0&&o<n}return!1}function mt(t={}){return Object.assign({zero:"zero",ones:[],tens:[],large:[],special:{},wordOrdinal:ut,numericOrdinal:ut,numberToWords:ut,numberToOrdinal:lt,vulgarSep:" ",numSep:" "},t)}dt.identityCombiner=function(t,e,n){return t+e+n},dt.prefixCombiner=function(t,e,n){return t=n?n+" "+t:t,e?e+" "+t:t},dt.postfixCombiner=function(t,e,n){return t=n?n+" "+t:t,e?t+" "+e:t},dt.romanceCombiner=function(t,e,n){return t=n?t+" "+n:t,e?t+" "+e:t};const gt=Et();function Et(){return{FUNCTIONS:{fracNestDepth:t=>ft(t,10,100),radicalNestDepth:t=>"",combineRootIndex:function(t,e){return t},combineNestedFraction:dt.identityCombiner,combineNestedRadical:dt.identityCombiner,fontRegexp:function(t){return new RegExp("^"+t.split(/ |-/).join("( |-)")+"( |-)")},si:ht,plural:ut},MESSAGES:{MS:{},MSroots:{},font:{},embellish:{},role:{},enclose:{},navigate:{},regexp:{},unitTimes:""},ALPHABETS:{latinSmall:[],latinCap:[],greekSmall:[],greekCap:[],capPrefix:{default:""},smallPrefix:{default:""},digitPrefix:{default:""},languagePrefix:{},digitTrans:{default:ut,mathspeak:ut,clearspeak:ut},letterTrans:{default:ut},combiner:(t,e,n)=>t},NUMBERS:mt(),COMBINERS:{},CORRECTIONS:{},SUBISO:{default:"",current:"",all:[]}}}function Nt(t){switch(t){case 1:return gt.MESSAGES.MS.ONCE||"";case 2:return gt.MESSAGES.MS.TWICE;default:return t.toString()}}function St(t,e){return t===gt.MESSAGES.MS.ROOTINDEX||t===gt.MESSAGES.MS.INDEX?t:t+" "+e}function Tt(t){return It(gt.MESSAGES.font[t],t)}function It(t,e){return void 0===t?e:"string"==typeof t?t:t[0]}const At="grammar";class bt{static getInstance(){return bt.instance=bt.instance||new bt,bt.instance}static parseInput(t){const e={},n=t.split(":");for(const t of n){const n=t.split("="),r=n[0].trim();n[1]?e[r]=n[1].trim():r.match(/^!/)?e[r.slice(1)]=!1:e[r]=!0}return e}static parseState(t){const e={},n=t.split(" ");for(const t of n){const n=t.split(":"),r=n[0],o=n[1];e[r]=o||!0}return e}static translateString(t){if(t.match(/:unit$/))return bt.translateUnit(t);const e=A.getInstance();let n=e.evaluator(t,e.dynamicCstr);return n=null===n?t:n,bt.getInstance().getParameter("plural")&&(n=gt.FUNCTIONS.plural(n)),n}static translateUnit(t){t=bt.prepareUnit(t);const e=A.getInstance(),n=bt.getInstance().getParameter("plural"),r=e.options.strict,o=`${e.options.locale}.${e.options.modality}.default`;let i,s;return e.options.strict=!0,n&&(i=e.defaultParser.parse(o+".plural"),s=e.evaluator(t,i)),s?(e.options.strict=r,s):(i=e.defaultParser.parse(o+".default"),s=e.evaluator(t,i),e.options.strict=r,s?(n&&(s=gt.FUNCTIONS.plural(s)),s):bt.cleanUnit(t))}static prepareUnit(t){const e=t.match(/:unit$/);return e?t.slice(0,e.index).replace(/\s+/g," ")+t.slice(e.index):t}static cleanUnit(t){return t.match(/:unit$/)?t.replace(/:unit$/,""):t}clear(){this.parameters_={},this.stateStack_=[]}setParameter(t,e){const n=this.parameters_[t];return e?this.parameters_[t]=e:delete this.parameters_[t],n}getParameter(t){return this.parameters_[t]}setCorrection(t,e){this.corrections_[t]=e}setPreprocessor(t,e){this.preprocessors_[t]=e}getCorrection(t){return this.corrections_[t]}getState(){const t=[];for(const[e,n]of Object.entries(this.parameters_))t.push("string"==typeof n?e+":"+n:e);return t.join(" ")}processSingles(){const t={};for(const e of this.singles)t[e]=!1;this.singles=[],this.pushState(t)}pushState(t){for(let[e,n]of Object.entries(t))e.match(/^\?/)&&(delete t[e],e=e.slice(1),this.singles.push(e)),t[e]=this.setParameter(e,n);this.stateStack_.push(t)}popState(){const t=this.stateStack_.pop();for(const[e,n]of Object.entries(t))this.setParameter(e,n)}setAttribute(t){if(t&&t.nodeType===D.ELEMENT_NODE){const e=this.getState();e&&t.setAttribute(At,e)}}preprocess(t){return this.runProcessors(t,this.preprocessors_)}correct(t){return this.runProcessors(t,this.corrections_)}apply(t,e){return this.currentFlags=e||{},t=this.currentFlags.adjust||this.currentFlags.preprocess?bt.getInstance().preprocess(t):t,(this.parameters_.translate||this.currentFlags.translate)&&(t=bt.translateString(t)),t=this.currentFlags.adjust||this.currentFlags.correct?bt.getInstance().correct(t):t,this.currentFlags={},t}runProcessors(t,e){for(const[n,r]of Object.entries(this.parameters_)){const o=e[n];o&&(t=!0===r?o(t):o(t,r))}return t}constructor(){this.currentFlags={},this.parameters_={},this.corrections_={},this.preprocessors_={},this.stateStack_=[],this.singles=[]}}function Rt(t,e){if(!e||!t)return t;const n=gt.FUNCTIONS.fontRegexp(Tt(e));return t.replace(n,"")}function Ot(t){let e=t%1e3,n="",r=Lt.ones[Math.floor(e/100)];if(n+=r?r+Lt.numSep+"honderd":"",e%=100,e)if(n+=n?Lt.numSep:"",r=Lt.ones[e],r)n+=r;else{const t=Lt.tens[Math.floor(e/10)];r=Lt.ones[e%10],n+=r?r+"-en-"+t:t}return n}function yt(t){if(0===t)return Lt.zero;if(t>=Math.pow(10,36))return t.toString();let e=0,n="";for(;t>0;){if(t%1e3){const r=Ot(t%1e3);if(e){const t=Lt.large[e];n=r+Lt.numSep+t+(n?Lt.numSep+n:"")}else n=r+(n?Lt.numSep+n:"")}t=Math.floor(t/1e3),e++}return n}function Ct(t){if(1===t)return"eerste";if(3===t)return"derde";if(8===t)return"agste";if(9===t)return"negende";return yt(t)+(t<19?"de":"ste")}bt.getInstance().setCorrection("localFont",Tt),bt.getInstance().setCorrection("localRole",function(t){return It(gt.MESSAGES.role[t],t)}),bt.getInstance().setCorrection("localEnclose",function(t){return It(gt.MESSAGES.enclose[t],t)}),bt.getInstance().setCorrection("ignoreFont",Rt),bt.getInstance().setPreprocessor("annotation",function(t,e){return t+":"+e}),bt.getInstance().setPreprocessor("noTranslateText",function(t){return t.match(new RegExp("^["+gt.MESSAGES.regexp.TEXT+"]+$"))&&(bt.getInstance().currentFlags.translate=!1),t}),bt.getInstance().setCorrection("ignoreCaps",function(t){let e=gt.ALPHABETS.capPrefix[A.getInstance().options.domain];return void 0===e&&(e=gt.ALPHABETS.capPrefix.default),Rt(t,e)}),bt.getInstance().setPreprocessor("numbers2alpha",function(t){return t.match(/\d+/)?gt.NUMBERS.numberToWords(parseInt(t,10)):t});const Lt=mt({wordOrdinal:Ct,numericOrdinal:function(t){return t.toString()+"."},numberToWords:yt,numberToOrdinal:function(t,e){return 1===t?"enkel":2===t?e?"helftes":"helfte":4===t?e?"kwarte":"kwart":Ct(t)+(e?"s":"")}}),Mt=function(t,e,n){return t=n?n+" "+t:t,e?t+" "+e:t};let _t=null;function vt(t){const e=t%1e3,n=Math.floor(e/100),r=n?1===n?"cent":Pt.ones[n]+"-cents":"",o=function(t){const e=t%100;if(e<20)return Pt.ones[e];const n=Math.floor(e/10),r=Pt.tens[n],o=Pt.ones[e%10];return r&&o?r+(2===n?"-i-":"-")+o:r||o}(e%100);return r&&o?r+Pt.numSep+o:r||o}function wt(t){if(0===t)return Pt.zero;if(t>=Math.pow(10,36))return t.toString();let e=0,n="";for(;t>0;){const r=t%(e>1?1e6:1e3);if(r){let t=Pt.large[e];if(e)if(1===e)n=(1===r?"":vt(r)+Pt.numSep)+t+(n?Pt.numSep+n:"");else{const e=wt(r);t=1===r?t:t.replace(/\u00f3$/,"ons"),n=e+Pt.numSep+t+(n?Pt.numSep+n:"")}else n=vt(r)}t=Math.floor(t/(e>1?1e6:1e3)),e++}return n}function Dt(t){const e=bt.getInstance().getParameter("gender");return t.toString()+("f"===e?"a":"n")}const Pt=mt({numericOrdinal:Dt,numberToWords:wt,numberToOrdinal:function(t,e){if(t>1999)return Dt(t);if(t<=10)return Pt.special.onesOrdinals[t-1];const n=wt(t);return n.match(/mil$/)?n.replace(/mil$/,"mil\xb7l\xe8sima"):n.match(/u$/)?n.replace(/u$/,"vena"):n.match(/a$/)?n.replace(/a$/,"ena"):n+(n.match(/e$/)?"na":"ena")}}),xt=function(t,e,n){return t="sans serif "+(n?n+" "+t:t),e?t+" "+e:t};let Ut=null;function Ft(t,e=!1){return t===Vt.ones[1]?e?"et":"en":t}function kt(t,e=!1){let n=t%1e3,r="",o=Vt.ones[Math.floor(n/100)];if(r+=o?Ft(o,!0)+" hundrede":"",n%=100,n)if(r+=r?" og ":"",o=e?Vt.special.smallOrdinals[n]:Vt.ones[n],o)r+=o;else{const t=e?Vt.special.tensOrdinals[Math.floor(n/10)]:Vt.tens[Math.floor(n/10)];o=Vt.ones[n%10],r+=o?Ft(o)+"og"+t:t}return r}function Bt(t,e=!1){if(0===t)return Vt.zero;if(t>=Math.pow(10,36))return t.toString();let n=0,r="";for(;t>0;){const o=t%1e3;if(o){const t=kt(o,e&&!n);if(n){const e=Vt.large[n],i=o>1?"er":"";r=Ft(t,n<=1)+" "+e+i+(r?" og ":"")+r}else r=Ft(t)+r}t=Math.floor(t/1e3),n++}return r}function Gt(t){if(t%100)return Bt(t,!0);const e=Bt(t);return e.match(/e$/)?e:e+"e"}const Vt=mt({wordOrdinal:Gt,numericOrdinal:function(t){return t.toString()+"."},numberToWords:Bt,numberToOrdinal:function(t,e){return 1===t?e?"hel":"hele":2===t?e?"halv":"halve":Gt(t)+(e?"dele":"del")}});let Ht=null;function jt(t,e=!1){return t===Xt.ones[1]?e?"eine":"ein":t}function qt(t){let e=t%1e3,n="",r=Xt.ones[Math.floor(e/100)];if(n+=r?jt(r)+"hundert":"",e%=100,e)if(n+=n?Xt.numSep:"",r=Xt.ones[e],r)n+=r;else{const t=Xt.tens[Math.floor(e/10)];r=Xt.ones[e%10],n+=r?jt(r)+"und"+t:t}return n}function $t(t){if(0===t)return Xt.zero;if(t>=Math.pow(10,36))return t.toString();let e=0,n="";for(;t>0;){const r=t%1e3;if(r){const o=qt(t%1e3);if(e){const t=Xt.large[e],i=e>1&&r>1?t.match(/e$/)?"n":"en":"";n=jt(o,e>1)+t+i+n}else n=jt(o,e>1)+n}t=Math.floor(t/1e3),e++}return n.replace(/ein$/,"eins")}function Yt(t){if(1===t)return"erste";if(3===t)return"dritte";if(7===t)return"siebte";if(8===t)return"achte";return $t(t)+(t<19?"te":"ste")}const Xt=mt({wordOrdinal:Yt,numericOrdinal:function(t){return t.toString()+"."},numberToWords:$t,numberToOrdinal:function(t,e){return 1===t?"eintel":2===t?e?"halbe":"halb":Yt(t)+"l"}}),Wt=function(t,e,n){return"s"===n&&(e=e.split(" ").map(function(t){return t.replace(/s$/,"")}).join(" "),n=""),t=n?n+" "+t:t,e?e+" "+t:t},Kt=function(t,e,n){return t=n&&"s"!==n?n+" "+t:t,e?t+" "+e:t};let zt=null;function Qt(t){let e=t%1e3,n="";return n+=te.ones[Math.floor(e/100)]?te.ones[Math.floor(e/100)]+te.numSep+"hundred":"",e%=100,e&&(n+=n?te.numSep:"",n+=te.ones[e]||te.tens[Math.floor(e/10)]+(e%10?te.numSep+te.ones[e%10]:"")),n}function Jt(t){if(0===t)return te.zero;if(t>=Math.pow(10,36))return t.toString();let e=0,n="";for(;t>0;){t%1e3&&(n=Qt(t%1e3)+(e?"-"+te.large[e]+"-":"")+n),t=Math.floor(t/1e3),e++}return n.replace(/-$/,"")}function Zt(t){let e=Jt(t);return e.match(/one$/)?e=e.slice(0,-3)+"first":e.match(/two$/)?e=e.slice(0,-3)+"second":e.match(/three$/)?e=e.slice(0,-5)+"third":e.match(/five$/)?e=e.slice(0,-4)+"fifth":e.match(/eight$/)?e=e.slice(0,-5)+"eighth":e.match(/nine$/)?e=e.slice(0,-4)+"ninth":e.match(/twelve$/)?e=e.slice(0,-6)+"twelfth":e.match(/ty$/)?e=e.slice(0,-2)+"tieth":e+="th",e}const te=mt({wordOrdinal:Zt,numericOrdinal:function(t){const e=t%100,n=t.toString();if(e>10&&e<20)return n+"th";switch(t%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd";default:return n+"th"}},numberToWords:Jt,numberToOrdinal:function(t,e){if(1===t)return e?"oneths":"oneth";if(2===t)return e?"halves":"half";const n=Zt(t);return e?n+"s":n}});let ee=null;function ne(t){const e=t%1e3,n=Math.floor(e/100),r=re.special.hundreds[n],o=function(t){const e=t%100;if(e<30)return re.ones[e];const n=re.tens[Math.floor(e/10)],r=re.ones[e%10];return n&&r?n+" y "+r:n||r}(e%100);return 1===n?o?r+"to "+o:r:r&&o?r+" "+o:r||o}const re=mt({numericOrdinal:function(t){const e=bt.getInstance().getParameter("gender");return t.toString()+("f"===e?"a":"o")},numberToWords:function(t){if(0===t)return re.zero;if(t>=Math.pow(10,36))return t.toString();let e=0,n="";for(;t>0;){const r=t%1e3;if(r){let t=re.large[e];const o=ne(r);e?1===r?(t=t.match("/^mil( |$)/")?t:"un "+t,n=t+(n?" "+n:"")):(t=t.replace(/\u00f3n$/,"ones"),n=ne(r)+" "+t+(n?" "+n:"")):n=o}t=Math.floor(t/1e3),e++}return n},numberToOrdinal:function(t,e){if(t>1999)return t.toString()+"a";if(t<=12)return re.special.onesOrdinals[t-1];const n=[];if(t>=1e3&&(t-=1e3,n.push("mil\xe9sima")),!t)return n.join(" ");let r=0;return r=Math.floor(t/100),r>0&&(n.push(re.special.hundredsOrdinals[r-1]),t%=100),t<=12?n.push(re.special.onesOrdinals[t-1]):(r=Math.floor(t/10),r>0&&(n.push(re.special.tensOrdinals[r-1]),t%=10),t>0&&n.push(re.special.onesOrdinals[t-1])),n.join(" ")}}),oe=function(t,e,n){return t="sans serif "+(n?n+" "+t:t),e?t+" "+e:t};let ie=null;let se=null;function ae(t){let e=t%1e3,n="";if(n+=he.ones[Math.floor(e/100)]?he.ones[Math.floor(e/100)]+"-cent":"",e%=100,e){n+=n?"-":"";let t=he.ones[e];if(t)n+=t;else{const r=he.tens[Math.floor(e/10)];r.match(/-dix$/)?(t=he.ones[e%10+10],n+=r.replace(/-dix$/,"")+"-"+t):n+=r+(e%10?"-"+he.ones[e%10]:"")}}const r=n.match(/s-\w+$/);return r?n.replace(/s-\w+$/,r[0].slice(1)):n.replace(/-un$/,"-et-un")}function ce(t){if(0===t)return he.zero;if(t>=Math.pow(10,36))return t.toString();he.special["tens-"+A.getInstance().options.subiso]&&(he.tens=he.special["tens-"+A.getInstance().options.subiso]);let e=0,n="";for(;t>0;){const r=t%1e3;if(r){let t=he.large[e];const o=ae(r);if(t&&t.match(/^mille /)){const r=t.replace(/^mille /,"");n=n.match(RegExp(r))?o+(e?"-mille-":"")+n:n.match(RegExp(r.replace(/s$/,"")))?o+(e?"-mille-":"")+n.replace(r.replace(/s$/,""),r):o+(e?"-"+t+"-":"")+n}else t=1===r&&t?t.replace(/s$/,""):t,n=o+(e?"-"+t+"-":"")+n}t=Math.floor(t/1e3),e++}return n.replace(/-$/,"")}const le={1:"uni\xe8me",2:"demi",3:"tiers",4:"quart"};function ue(t){if(1===t)return"premi\xe8re";let e=ce(t);return e.match(/^neuf$/)?e=e.slice(0,-1)+"v":e.match(/cinq$/)?e+="u":e.match(/trois$/)?e+="":(e.match(/e$/)||e.match(/s$/))&&(e=e.slice(0,-1)),e+="i\xe8me",e}const he=mt({wordOrdinal:ue,numericOrdinal:function(t){const e=bt.getInstance().getParameter("gender");return 1===t?t.toString()+("m"===e?"er":"re"):t.toString()+"e"},numberToWords:ce,numberToOrdinal:function(t,e){const n=le[t]||ue(t);return 3===t?n:e?n+"s":n}});let de=null;function pe(t){if(0===t)return me.zero;if(t>=Math.pow(10,32))return t.toString();let e=0,n="";const r=function(t){let e=t%1e3,n="";return n+=me.ones[Math.floor(e/100)]?me.ones[Math.floor(e/100)]+me.numSep+me.special.hundred:"",e%=100,e&&(n+=n?me.numSep:"",n+=me.ones[e]),n}(t%1e3);if(!(t=Math.floor(t/1e3)))return r;for(;t>0;){const r=t%100;r&&(n=me.ones[r]+me.numSep+me.large[e]+(n?me.numSep+n:"")),t=Math.floor(t/100),e++}return r?n+me.numSep+r:n}function fe(t){const e=bt.getInstance().getParameter("gender");if(t<=0)return t.toString();if(t<10)return"f"===e?me.special.ordinalsFeminine[t]:me.special.ordinalsMasculine[t];return pe(t)+("f"===e?"\u0935\u0940\u0902":"\u0935\u093e\u0901")}const me=mt({wordOrdinal:fe,numericOrdinal:function(t){const e=bt.getInstance().getParameter("gender");return t>0&&t<10?"f"===e?me.special.simpleSmallOrdinalsFeminine[t]:me.special.simpleSmallOrdinalsMasculine[t]:t.toString().split("").map(function(t){const e=parseInt(t,10);return isNaN(e)?"":me.special.simpleNumbers[e]}).join("")+("f"===e?"\u0935\u0940\u0902":"\u0935\u093e\u0901")},numberToWords:pe,numberToOrdinal:function(t,e){return t<=10?me.special.smallDenominators[t]:fe(t)+" \u0905\u0902\u0936"}});let ge=null;function Ee(t){let e=t%1e4,n="";return n+=Ie.ones[Math.floor(e/1e3)]?1===Math.floor(e/1e3)?"\ucc9c":Ie.ones[Math.floor(e/1e3)]+"\ucc9c":"",e%=1e3,e&&(n+=Ie.ones[Math.floor(e/100)]?1===Math.floor(e/100)?"\ubc31":Ie.ones[Math.floor(e/100)]+"\ubc31":"",e%=100,n+=Ie.tens[Math.floor(e/10)]+(e%10?Ie.ones[e%10]:"")),n}function Ne(t){if(0===t)return Ie.zero;if(t>=Math.pow(10,36))return t.toString();let e=0,n="";for(;t>0;){t%1e4&&(n=Ee(t%1e4)+(e?Ie.large[e]+Ie.numSep:"")+n),t=Math.floor(t/1e4),e++}return n.replace(/ $/,"")}function Se(t,e){return 1===t?"\uccab\ubc88\uc9f8":Te(t)+"\ubc88\uc9f8"}function Te(t){const e=Ne(t),n=Ne(t%=100);if(!n||!t)return e;const r=20===t?"\uc2a4\ubb34":Ie.tens[10+Math.floor(t/10)],o=Ie.ones[10+Math.floor(t%10)];return e.slice(0,-n.length)+r+o}const Ie=mt({wordOrdinal:Te,numericOrdinal:function(t){return Se(t)},numberToWords:Ne,numberToOrdinal:Se});let Ae=null;function be(t){let e=t%1e3,n="";if(n+=ye.ones[Math.floor(e/100)]?ye.ones[Math.floor(e/100)]+ye.numSep+"cento":"",e%=100,e){n+=n?ye.numSep:"";const t=ye.ones[e];if(t)n+=t;else{let t=ye.tens[Math.floor(e/10)];const r=e%10;1!==r&&8!==r||(t=t.slice(0,-1)),n+=t,n+=r?ye.numSep+ye.ones[e%10]:""}}return n}function Re(t){if(0===t)return ye.zero;if(t>=Math.pow(10,36))return t.toString();if(1===t&&bt.getInstance().getParameter("fraction"))return"un";let e=0,n="";for(;t>0;){t%1e3&&(n=be(t%1e3)+(e?"-"+ye.large[e]+"-":"")+n),t=Math.floor(t/1e3),e++}return n.replace(/-$/,"")}function Oe(t){const e="m"===bt.getInstance().getParameter("gender")?"o":"a";let n=ye.special.onesOrdinals[t];return n?n.slice(0,-1)+e:(n=Re(t),n.slice(0,-1)+"esim"+e)}const ye=mt({wordOrdinal:Oe,numericOrdinal:function(t){const e=bt.getInstance().getParameter("gender");return t.toString()+("m"===e?"o":"a")},numberToWords:Re,numberToOrdinal:function(t,e){if(2===t)return e?"mezzi":"mezzo";const n=Oe(t);if(!e)return n;const r=n.match(/o$/)?"i":"e";return n.slice(0,-1)+r}}),Ce=function(t,e,n){return t.match(/^[a-zA-Z]$/)&&(e=e.replace("cerchiato","cerchiata")),t=n?t+" "+n:t,e?t+" "+e:t};let Le=null;function Me(t,e=!1){let n=t%1e3,r="";const o=Math.floor(n/100),i=we.ones[o];if(r+=i?(1===o?"":i)+"hundre":"",n%=100,n){if(r+=r?"og":"",e){const t=we.special.smallOrdinals[n];if(t)return r+t;if(n%10)return r+we.tens[Math.floor(n/10)]+we.special.smallOrdinals[n%10]}r+=we.ones[n]||we.tens[Math.floor(n/10)]+(n%10?we.ones[n%10]:"")}return e?_e(r):r}function _e(t){const e=we.special.endOrdinal[0];return"a"===e&&t.match(/en$/)?t.slice(0,-2)+we.special.endOrdinal:t.match(/(d|n)$/)||t.match(/hundre$/)?t+"de":t.match(/i$/)?t+we.special.endOrdinal:"a"===e&&t.match(/e$/)?t.slice(0,-1)+we.special.endOrdinal:(t.match(/e$/),t+"nde")}function ve(t){return xe(t,!0)}const we=mt({wordOrdinal:ve,numericOrdinal:function(t){return t.toString()+"."},numberToWords:xe,numberToOrdinal:function(t,e){return ve(t)}});function De(t,e=!1){return t===we.ones[1]?"ein"===t?"eitt ":e?"et":"ett":t}function Pe(t,e=!1){let n=t%1e3,r="",o=we.ones[Math.floor(n/100)];if(r+=o?De(o)+"hundre":"",n%=100,n){if(r+=r?"og":"",e){const t=we.special.smallOrdinals[n];if(t)return r+t}if(o=we.ones[n],o)r+=o;else{const t=we.tens[Math.floor(n/10)];o=we.ones[n%10],r+=o?o+"og"+t:t}}return e?_e(r):r}function xe(t,e=!1){const n="alt"===A.getInstance().options.subiso?function(t,e=!1){if(0===t)return e?we.special.smallOrdinals[0]:we.zero;if(t>=Math.pow(10,36))return t.toString();let n=0,r="";for(;t>0;){const o=t%1e3;if(o){const i=Pe(t%1e3,!n&&e);!n&&e&&(e=!e),r=(1===n?De(i,!0):i)+(n>1?we.numSep:"")+(n?we.large[n]+(n>1&&o>1?"er":""):"")+(n>1&&r?we.numSep:"")+r}t=Math.floor(t/1e3),n++}return e?r+(r.match(/tusen$/)?"de":"te"):r}(t,e):function(t,e=!1){if(0===t)return e?we.special.smallOrdinals[0]:we.zero;if(t>=Math.pow(10,36))return t.toString();let n=0,r="";for(;t>0;){const o=t%1e3;if(o){const i=Me(t%1e3,!n&&e);!n&&e&&(e=!e),r=i+(n?" "+we.large[n]+(n>1&&o>1?"er":"")+(r?" ":""):"")+r}t=Math.floor(t/1e3),n++}return e?r+(r.match(/tusen$/)?"de":"te"):r}(t,e);return n}let Ue=null;function Fe(t){return t.toString().split("").map(function(t){return ke.ones[parseInt(t,10)]}).join("")}const ke=mt({numberToWords:Fe,numberToOrdinal:Fe}),Be=function(t){return t.match(RegExp("^"+$e.ALPHABETS.languagePrefix.english))?t.slice(1):t},Ge=function(t,e,n){return t=Be(t),e?t+e:t},Ve=function(t,e,n){return e+Be(t)},He=function(t,e,n){return e+(n||"")+(t=Be(t))+"\u283b"},je=function(t,e,n){return e+(n||"")+(t=Be(t))+"\u283b\u283b"},qe=function(t,e,n){return e+(t=Be(t))+"\u283e"};let $e=null;let Ye=null;function Xe(t){let e=t%1e3,n="";const r=Math.floor(e/100);return n+=ze.ones[r]?(1===r?"":ze.ones[r]+ze.numSep)+"hundra":"",e%=100,e&&(n+=n?ze.numSep:"",n+=ze.ones[e]||ze.tens[Math.floor(e/10)]+(e%10?ze.numSep+ze.ones[e%10]:"")),n}function We(t,e=!1){if(0===t)return ze.zero;if(t>=Math.pow(10,36))return t.toString();let n=0,r="";for(;t>0;){const o=t%1e3;if(o){const i=ze.large[n],s=o>1&&n>1&&!e?"er":"";r=(1===n&&1===o?"":(n>1&&1===o?"en":Xe(t%1e3))+(n>1?" ":""))+(n?i+s+(n>1?" ":""):"")+r}t=Math.floor(t/1e3),n++}return r.replace(/ $/,"")}function Ke(t){let e=We(t,!0);return e.match(/^noll$/)?e="nollte":e.match(/ett$/)?e=e.replace(/ett$/,"f\xf6rsta"):e.match(/tv\xe5$/)?e=e.replace(/tv\xe5$/,"andra"):e.match(/tre$/)?e=e.replace(/tre$/,"tredje"):e.match(/fyra$/)?e=e.replace(/fyra$/,"fj\xe4rde"):e.match(/fem$/)?e=e.replace(/fem$/,"femte"):e.match(/sex$/)?e=e.replace(/sex$/,"sj\xe4tte"):e.match(/sju$/)?e=e.replace(/sju$/,"sjunde"):e.match(/\xe5tta$/)?e=e.replace(/\xe5tta$/,"\xe5ttonde"):e.match(/nio$/)?e=e.replace(/nio$/,"nionde"):e.match(/tio$/)?e=e.replace(/tio$/,"tionde"):e.match(/elva$/)?e=e.replace(/elva$/,"elfte"):e.match(/tolv$/)?e=e.replace(/tolv$/,"tolfte"):e.match(/tusen$/)?e=e.replace(/tusen$/,"tusonde"):e.match(/jard$/)||e.match(/jon$/)?e+="te":e+="de",e}const ze=mt({wordOrdinal:Ke,numericOrdinal:function(t){const e=t.toString();return e.match(/11$|12$/)?e+":e":e+(e.match(/1$|2$/)?":a":":e")},numberToWords:We,numberToOrdinal:function(t,e){if(1===t)return"hel";if(2===t)return e?"halva":"halv";let n=Ke(t);return n=n.match(/de$/)?n.replace(/de$/,""):n,n+(e?"delar":"del")}});let Qe=null;const Je={af:function(){return _t||(_t=function(){const t=Et();return t.NUMBERS=Lt,t.COMBINERS.germanPostfix=Mt,t.FUNCTIONS.radicalNestDepth=Nt,t.FUNCTIONS.plural=t=>/.*s$/.test(t)?t:t+"s",t.FUNCTIONS.fontRegexp=function(t){return new RegExp("((^"+t+" )|( "+t+"$))")},t.ALPHABETS.combiner=dt.prefixCombiner,t.ALPHABETS.digitTrans.default=Lt.numberToWords,t.CORRECTIONS.article=t=>bt.getInstance().getParameter("noArticle")?"":t,t}()),_t},ca:function(){return Ut||(Ut=function(){const t=Et();return t.NUMBERS=Pt,t.COMBINERS.sansserif=xt,t.FUNCTIONS.fracNestDepth=t=>!1,t.FUNCTIONS.combineRootIndex=St,t.FUNCTIONS.combineNestedRadical=(t,e,n)=>t+n,t.FUNCTIONS.fontRegexp=t=>RegExp("^"+t+" "),t.FUNCTIONS.plural=t=>/.*os$/.test(t)?t+"sos":/.*s$/.test(t)?t+"os":/.*ga$/.test(t)?t.slice(0,-2)+"gues":/.*\xe7a$/.test(t)?t.slice(0,-2)+"ces":/.*ca$/.test(t)?t.slice(0,-2)+"ques":/.*ja$/.test(t)?t.slice(0,-2)+"ges":/.*qua$/.test(t)?t.slice(0,-3)+"q\xfces":/.*a$/.test(t)?t.slice(0,-1)+"es":/.*(e|i)$/.test(t)?t+"ns":/.*\xed$/.test(t)?t.slice(0,-1)+"ins":t+"s",t.FUNCTIONS.si=(t,e)=>(e.match(/^metre/)&&(t=t.replace(/a$/,"\xe0").replace(/o$/,"\xf2").replace(/i$/,"\xed")),t+e),t.ALPHABETS.combiner=dt.prefixCombiner,t}()),Ut},da:function(){return Ht||(Ht=function(){const t=Et();return t.NUMBERS=Vt,t.FUNCTIONS.radicalNestDepth=Nt,t.FUNCTIONS.fontRegexp=e=>e===t.ALPHABETS.capPrefix.default?RegExp("^"+e+" "):RegExp(" "+e+"$"),t.ALPHABETS.combiner=dt.postfixCombiner,t.ALPHABETS.digitTrans.default=Vt.numberToWords,t}()),Ht},de:function(){return zt||(zt=function(){const t=Et();return t.NUMBERS=Xt,t.COMBINERS.germanPostfix=Kt,t.ALPHABETS.combiner=Wt,t.FUNCTIONS.radicalNestDepth=e=>e>1?t.NUMBERS.numberToWords(e)+"fach":"",t.FUNCTIONS.combineRootIndex=(t,e)=>{const n=e?e+"wurzel":"";return t.replace("Wurzel",n)},t.FUNCTIONS.combineNestedRadical=(t,e,n)=>{const r=(e?e+" ":"")+(t=n.match(/exponent$/)?t+"r":t);return n.match(/ /)?n.replace(/ /," "+r+" "):r+" "+n},t.FUNCTIONS.fontRegexp=function(t){return t=t.split(" ").map(function(t){return t.replace(/s$/,"(|s)")}).join(" "),new RegExp("((^"+t+" )|( "+t+"$))")},t.CORRECTIONS.correctOne=t=>t.replace(/^eins$/,"ein"),t.CORRECTIONS.localFontNumber=t=>Tt(t).split(" ").map(function(t){return t.replace(/s$/,"")}).join(" "),t.CORRECTIONS.lowercase=t=>t.toLowerCase(),t.CORRECTIONS.article=t=>{const e=bt.getInstance().getParameter("case"),n=bt.getInstance().getParameter("plural");return"dative"===e?{der:"dem",die:n?"den":"der",das:"dem"}[t]:t},t.CORRECTIONS.masculine=t=>"dative"===bt.getInstance().getParameter("case")?t+"n":t,t}()),zt},en:function(){return ee||(ee=function(){const t=Et();return t.NUMBERS=te,t.FUNCTIONS.radicalNestDepth=Nt,t.FUNCTIONS.plural=t=>/.*s$/.test(t)?t:t+"s",t.ALPHABETS.combiner=dt.prefixCombiner,t.ALPHABETS.digitTrans.default=te.numberToWords,t.CORRECTIONS.article=t=>bt.getInstance().getParameter("noArticle")?"":t,t}()),ee},es:function(){return ie||(ie=function(){const t=Et();return t.NUMBERS=re,t.COMBINERS.sansserif=oe,t.FUNCTIONS.fracNestDepth=t=>!1,t.FUNCTIONS.combineRootIndex=St,t.FUNCTIONS.combineNestedRadical=(t,e,n)=>t+n,t.FUNCTIONS.fontRegexp=t=>RegExp("^"+t+" "),t.FUNCTIONS.plural=t=>/.*(a|e|i|o|u)$/.test(t)?t+"s":/.*z$/.test(t)?t.slice(0,-1)+"ces":/.*c$/.test(t)?t.slice(0,-1)+"ques":/.*g$/.test(t)?t+"ues":/.*\u00f3n$/.test(t)?t.slice(0,-2)+"ones":t+"es",t.FUNCTIONS.si=(t,e)=>(e.match(/^metro/)&&(t=t.replace(/a$/,"\xe1").replace(/o$/,"\xf3").replace(/i$/,"\xed")),t+e),t.ALPHABETS.combiner=dt.prefixCombiner,t}()),ie},euro:function(){return se||(se=Et()),se},fr:function(){return de||(de=function(){const t=Et();return t.NUMBERS=he,t.FUNCTIONS.radicalNestDepth=Nt,t.FUNCTIONS.combineRootIndex=St,t.FUNCTIONS.combineNestedFraction=(t,e,n)=>n.replace(/ $/g,"")+e+t,t.FUNCTIONS.combineNestedRadical=(t,e,n)=>n+" "+t,t.FUNCTIONS.fontRegexp=t=>RegExp(" (en |)"+t+"$"),t.FUNCTIONS.plural=t=>/.*s$/.test(t)?t:t+"s",t.CORRECTIONS.article=t=>bt.getInstance().getParameter("noArticle")?"":t,t.ALPHABETS.combiner=dt.romanceCombiner,t.SUBISO={default:"fr",current:"fr",all:["fr","be","ch"]},t}()),de},hi:function(){return ge||(ge=function(){const t=Et();return t.NUMBERS=me,t.ALPHABETS.combiner=dt.prefixCombiner,t.FUNCTIONS.radicalNestDepth=Nt,t}()),ge},it:function(){return Le||(Le=function(){const t=Et();return t.NUMBERS=ye,t.COMBINERS.italianPostfix=Ce,t.FUNCTIONS.radicalNestDepth=Nt,t.FUNCTIONS.combineRootIndex=St,t.FUNCTIONS.combineNestedFraction=(t,e,n)=>n.replace(/ $/g,"")+e+t,t.FUNCTIONS.combineNestedRadical=(t,e,n)=>n+" "+t,t.FUNCTIONS.fontRegexp=t=>RegExp(" (en |)"+t+"$"),t.ALPHABETS.combiner=dt.romanceCombiner,t}()),Le},ko:function(){return Ae||(Ae=function(){const t=Et();return t.NUMBERS=Ie,t.FUNCTIONS.radicalNestDepth=Nt,t.FUNCTIONS.plural=function(t){return t},t.FUNCTIONS.si=(t,e)=>t+e,t.FUNCTIONS.combineRootIndex=function(t,e){return t+e},t.ALPHABETS.combiner=dt.prefixCombiner,t.ALPHABETS.digitTrans.default=Ie.numberToWords,t.CORRECTIONS.postposition=t=>{if(["\uac19\ub2e4","\ub294","\uc640","\ub97c","\ub85c"].includes(t))return t;const e=t.slice(-1);let n=(e.charCodeAt(0)-44032)%28>0;return e.match(/[r,l,n,m,1,3,6,7,8,0]/i)&&(n=!0),bt.getInstance().setParameter("final",n),t},t.CORRECTIONS.article=t=>{const e=bt.getInstance().getParameter("final");e&&bt.getInstance().setParameter("final",!1),"\uac19\ub2e4"===t&&(t="\ub294");const n={\ub294:"\uc740",\uc640:"\uacfc",\ub97c:"\uc744",\ub85c:"\uc73c\ub85c"}[t];return void 0!==n&&e?n:t},t}()),Ae},nb:function(){return Ue||(Ue=function(){const t=Et();return t.NUMBERS=we,t.ALPHABETS.combiner=dt.prefixCombiner,t.ALPHABETS.digitTrans.default=we.numberToWords,t.FUNCTIONS.radicalNestDepth=Nt,t}()),Ue},nn:function(){return Ye||(Ye=function(){const t=Et();return t.NUMBERS=we,t.ALPHABETS.combiner=dt.prefixCombiner,t.ALPHABETS.digitTrans.default=we.numberToWords,t.FUNCTIONS.radicalNestDepth=Nt,t.SUBISO={default:"",current:"",all:["","alt"]},t}()),Ye},sv:function(){return Qe||(Qe=function(){const t=Et();return t.NUMBERS=ze,t.FUNCTIONS.radicalNestDepth=Nt,t.FUNCTIONS.fontRegexp=function(t){return new RegExp("((^"+t+" )|( "+t+"$))")},t.ALPHABETS.combiner=dt.prefixCombiner,t.ALPHABETS.digitTrans.default=ze.numberToWords,t.CORRECTIONS.correctOne=t=>t.replace(/^ett$/,"en"),t}()),Qe},nemeth:function(){return $e||($e=function(){const t=Et();return t.NUMBERS=ke,t.COMBINERS={postfixCombiner:Ge,germanCombiner:Ve,embellishCombiner:He,doubleEmbellishCombiner:je,parensCombiner:qe},t.FUNCTIONS.fracNestDepth=t=>!1,t.FUNCTIONS.fontRegexp=t=>RegExp("^"+t),t.FUNCTIONS.si=ut,t.ALPHABETS.combiner=(t,e,n)=>e?e+n+t:Be(t),t.ALPHABETS.digitTrans={default:ke.numberToWords},t}()),$e}};function Ze(){const t=function(){const t=E.u.ensureLocale(A.getInstance().options.locale,A.getInstance().defaultLocale);return A.getInstance().options.locale=t,Je[t]()}();if(function(t){const e=A.getInstance().options.subiso;-1===t.SUBISO.all.indexOf(e)&&(A.getInstance().options.subiso=t.SUBISO.default);t.SUBISO.current=A.getInstance().options.subiso}(t),t){for(const e of Object.getOwnPropertyNames(t))gt[e]=t[e];for(const[e,n]of Object.entries(t.CORRECTIONS))bt.getInstance().setCorrection(e,n)}}var tn=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n};const en={functionApplication:String.fromCodePoint(8289),invisibleTimes:String.fromCodePoint(8290),invisibleComma:String.fromCodePoint(8291),invisiblePlus:String.fromCodePoint(8292)};class nn extends Map{get(t){return super.get(t)||{role:ot.UNKNOWN,type:nt.UNKNOWN,font:st.UNKNOWN}}}class rn extends Map{set(t,e,n=""){return super.set(this.secKey(e,t),n||e),this}has(t,e){return super.has(this.secKey(e,t))}get(t,e){return super.get(this.secKey(e,t))}secKey(t,e){return e?`${t} ${e}`:`${t}`}}const on={Meaning:new nn,Secondary:new rn,FencesHoriz:new Map,FencesVert:new Map,FencesSecondary:new Map,LatexCommands:new Map};function sn(t,e){for(const n of t)on.Meaning.set(n,{role:e.role||ot.UNKNOWN,type:e.type||nt.UNKNOWN,font:e.font||st.UNKNOWN}),e.secondary&&on.Secondary.set(n,e.secondary)}function an(t,e,n=1){const r={},o=function(t){let e=[];for(const n of t)Array.isArray(n)?e=e.concat(z(n,{}).map(t=>parseInt(t,16))):e.push(parseInt(n,16));return e}(e);for(const e of o)r[e]||(t.set(String.fromCodePoint(e),String.fromCodePoint(e+n)),r[e]=!0,r[e+n]=!0)}const cn=["0028","0029","207D","207E","208D","208E","2768","2769","276A","276B","27EE","27EF","FE59","FE5A","FF08","FF09"],ln=["005B","005D","2045","2046","298B","298C","298D","298E","298F","2990","FF3B","FF3D"],un=["007B","007D","2774","2775","FE5B","FE5C","FF5B","FF5D"],hn=["2308","2309","2E22","2E23","300C","300E","FF62"],dn=["230A","230B","2E24","2E25","300D","300F","FF63"];function pn(t,e){for(const n of t){const t=String.fromCodePoint(parseInt(n,16));on.Secondary.set(t,e),on.FencesSecondary.set(t,e)}}const fn=["cos","cot","csc","sec","sin","tan","arccos","arccot","arccsc","arcsec","arcsin","arctan"].concat(["cosh","coth","csch","sech","sinh","tanh","arcosh","arcoth","arcsch","arsech","arsinh","artanh"],["deg","det","dim","hom","ker","Tr"],["log","ln","lg","exp","gcd","lcm","arg","im","re","Pr"]);function mn(t,e){sn(e,on.Meaning.get(t)||{type:nt.FUNCTION,role:ot.PREFIXFUNC})}function gn(t,e,n,r,o,i=[],s={},a={}){const c=Z.get(tt(t,r));c&&(c.unicode.forEach(t=>{on.Meaning.set(t,{type:e,role:n,font:o}),i.forEach(e=>on.Secondary.set(t,e))}),function(t,e){for(const[n,r]of Object.entries(e)){const e=t[n];void 0!==e&&on.Meaning.set(e,r)}}(c.unicode,s),function(t,e){for(const[n,r]of Object.entries(e)){const e=t[n];void 0!==e&&on.Secondary.set(e,r)}}(c.unicode,a))}[{set:["23","26","40","5c","a1","a7","b6","bf","2017",["2022","2025"],"2027","203b","203c",["2041","2043"],["2047","2049"],["204b","204d"],"2050","2055","2056",["2058","205e"],"2234","2235","fe45","fe46","fe5f","fe60","fe68","fe6b","ff03","ff06","ff0f","ff20","ff3c"],type:nt.PUNCTUATION,role:ot.UNKNOWN},{set:["22","ab","bb","2dd",["2018","201f"],"2039","203a",["301d","301f"],"fe10","ff02","ff07"],type:nt.PUNCTUATION,role:ot.QUOTES},{set:["3b","204f","2a1f","2a3e","fe14","fe54","ff1b"],type:nt.PUNCTUATION,role:ot.SEMICOLON},{set:["3f","203d","fe16","fe56","ff1f"],type:nt.PUNCTUATION,role:ot.QUESTION},{set:["21","fe15","fe57","ff01"],type:nt.PUNCTUATION,role:ot.EXCLAMATION},{set:["5e","60","a8","aa","b4","ba","2c7",["2d8","2da"],"2040","207a","207d","207e","ff3e","ff40"],type:nt.PUNCTUATION,role:ot.OVERACCENT},{set:["b8","2db","2038","203f","2054","208a","208d","208e"],type:nt.PUNCTUATION,role:ot.UNDERACCENT},{set:["3a","2982","fe13","fe30","fe55","ff1a"],type:nt.PUNCTUATION,role:ot.COLON},{set:["2c","2063","fe50","ff0c"],type:nt.PUNCTUATION,role:ot.COMMA},{set:["2026",["22ee","22f1"],"fe19"],type:nt.PUNCTUATION,role:ot.ELLIPSIS},{set:["2e","fe52","ff0e"],type:nt.PUNCTUATION,role:ot.FULLSTOP},{set:["2d","207b","208b","2212","2796","fe63","ff0d"],type:nt.OPERATOR,role:ot.DASH,secondary:ct.BAR},{set:["5f","af",["2010","2015"],"203e","208b",["fe49","fe4f"],"fe58","ff3f","ffe3"],type:nt.PUNCTUATION,role:ot.DASH,secondary:ct.BAR},{set:["7e","2dc","2f7","303","330","334","2053","223c","223d","301c","ff5e"],type:nt.OPERATOR,role:ot.TILDE,secondary:ct.TILDE},{set:["27","2b9","2ba",["2032","2037"],"2057"],type:nt.PUNCTUATION,role:ot.PRIME},{set:["b0"],type:nt.PUNCTUATION,role:ot.DEGREE},{set:["2b","b1","2064","2213","2214","2228","222a",["228c","228e"],"2294","2295","229d","229e","22bb","22bd","22c4","22ce","22d3","2304","271b","271c","2795","27cf","29fa","29fb","29fe",["2a22","2a28"],"2a2d","2a2e","2a39","2a42","2a45","2a46","2a48","2a4a","2a4c","2a4f","2a50","2a52","2a54","2a56","2a57","2a59","2a5b","2a5d",["2a61","2a63"],"2adc","2add","fe62","ff0b"],type:nt.OPERATOR,role:ot.ADDITION},{set:["2a","b7","d7","2020","2021","204e","2051","2062",["2217","2219"],"2227","2229","2240","2293","2297",["2299","229b"],"22a0","22a1","22b9","22bc",["22c5","22cc"],"22cf","22d2","22d4","2303","2305","2306","25cb","2715","2716","27ce","27d1",["29d1","29d7"],"29e2","2a1d",["2a2f","2a37"],["2a3b","2a3d"],"2a40","2a43","2a44","2a47","2a49","2a4b","2a4d","2a4e","2a51","2a53","2a55","2a58","2a5a","2a5c",["2a5e","2a60"],"2ada","2adb","fe61","ff0a"],type:nt.OPERATOR,role:ot.MULTIPLICATION},{set:["2d","af","2010","2011","2052","207b","208b","2212","2216","2238","2242","2296","229f","2796","29ff",["2a29","2a2c"],"2a3a","2a41","fe63","ff0d"],type:nt.OPERATOR,role:ot.SUBTRACTION},{set:["2f","f7","2044","2215","2298","2797","27cc","29bc",["29f5","29f9"],"2a38"],type:nt.OPERATOR,role:ot.DIVISION},{set:["25","2030","2031","ff05","fe6a"],type:nt.OPERATOR,role:ot.POSTFIXOP},{set:["ac","2200","2201","2203","2204","2206",["221a","221c"],"2310","ffe2"],type:nt.OPERATOR,role:ot.PREFIXOP},{set:["2320","2321","23aa","23ae","23af","23b2","23b3","23b6","23b7"],type:nt.OPERATOR,role:ot.PREFIXOP},{set:["1d7ca","1d7cb"],type:nt.OPERATOR,role:ot.PREFIXOP,font:st.BOLD},{set:["3d","7e","207c","208c","221d","2237",["223a","223f"],"2243","2245","2248",["224a","224e"],["2251","225f"],"2261","2263","229c","22cd","22d5","29e4","29e6","2a66","2a67",["2a6a","2a6c"],["2a6c","2a78"],"fe66","ff1d"],type:nt.RELATION,role:ot.EQUALITY},{set:["3c","3e","2241","2242","2244","2246","2247","2249","224f","2250","2260","2262",["2264","2281"],"22b0","22b1",["22d6","22e1"],["22e6","22e9"],["2976","2978"],"29c0","29c1","29e1","29e3","29e5",["2a79","2abc"],["2af7","2afa"],"fe64","fe65","ff1c","ff1e"],type:nt.RELATION,role:ot.INEQUALITY},{set:[["2282","228b"],["228f","2292"],["22b2","22b8"],"22d0","22d1",["22e2","22e5"],["22ea","22ed"],"27c3","27c4",["27c7","27c9"],["27d5","27d7"],"27dc",["2979","297b"],"29df",["2abd","2ad8"]],type:nt.RELATION,role:ot.SET},{set:["2236",["27e0","27e5"],"292b","292c",["29b5","29bb"],"29be","29bf",["29c2","29d0"]],type:nt.RELATION,role:ot.UNKNOWN},{set:["2205",["29b0","29b4"]],type:nt.IDENTIFIER,role:ot.SETEMPTY},{set:["1ab2","221e",["29dc","29de"]],type:nt.IDENTIFIER,role:ot.INFTY},{set:["22a2","22a3",["22a6","22af"],"27da","27db","27dd","27de","2ade",["2ae2","2ae6"],"2aec","2aed"],type:nt.RELATION,role:ot.LOGIC},{set:["22a4","22a5","22ba","27d8","27d9","27df","2adf","2ae0",["2ae7","2aeb"],"2af1"],type:nt.IDENTIFIER,role:ot.LOGIC},{set:[["2190","21ff"],"2301","2324","238b","2794",["2798","27af"],["27b1","27be"],["27f0","27ff"],["2900","292a"],["292d","2975"],["297c","297f"],["2b00","2b11"],["2b30","2b4c"],["ffe9","ffec"]],type:nt.RELATION,role:ot.ARROW},{set:["2208","220a",["22f2","22f9"],"22ff","27d2","2ad9"],type:nt.OPERATOR,role:ot.ELEMENT},{set:["2209"],type:nt.OPERATOR,role:ot.NONELEMENT},{set:["220b","220d",["22fa","22fe"]],type:nt.OPERATOR,role:ot.REELEMENT},{set:["220c"],type:nt.OPERATOR,role:ot.RENONELEMENT},{set:[["220f","2211"],["22c0","22c3"],["2a00","2a0b"],"2a3f","2afc","2aff"],type:nt.LARGEOP,role:ot.SUM},{set:["2140"],type:nt.LARGEOP,role:ot.SUM,font:st.DOUBLESTRUCK},{set:[["222b","2233"],["2a0c","2a17"],["2a17","2a1c"]],type:nt.LARGEOP,role:ot.INTEGRAL},{set:[["2500","257F"]],type:nt.RELATION,role:ot.BOX},{set:[["2580","259F"]],type:nt.IDENTIFIER,role:ot.BLOCK},{set:[["25A0","25FF"],["2B12","2B2F"],["2B50","2B59"]],type:nt.RELATION,role:ot.GEOMETRY},{set:["220e","2300","2302","2311","29bd","29e0",["29e8","29f3"],"2a1e","2afe","ffed","ffee"],type:nt.OPERATOR,role:ot.GEOMETRY},{set:[["221f","2222"],"22be","22bf",["2312","2314"],"237c","27c0",["299b","29af"]],type:nt.OPERATOR,role:ot.GEOMETRY},{set:["24",["a2","a5"],"b5","2123",["2125","2127"],"212a","212b","fe69","ff04","ffe0","ffe1","ffe5","ffe6"],type:nt.IDENTIFIER,role:ot.UNKNOWN},{set:["a9","ae","210f","2114","2116","2117",["211e","2122"],"212e","2132",["2139","213b"],["2141","2144"],"214d","214e",["1f12a","1f12c"],"1f18a"],type:nt.IDENTIFIER,role:ot.OTHERLETTER},{set:["2224","2226","2239","2307","27b0","27bf","27c1","27c2","27ca","27cb","27cd","27d0","27d3","27d4","2981","2999","299a","29e7","29f4","2a20","2a21","2a64","2a65","2a68","2a69","2ae1",["2aee","2af0"],"2af2","2af3","2af5","2af6","2afb","2afd"],type:nt.OPERATOR,role:ot.UNKNOWN},{set:["2605","2606","26aa","26ab",["2720","274d"]],type:nt.OPERATOR,role:ot.UNKNOWN},{set:[["2145","2149"]],type:nt.IDENTIFIER,role:ot.LATINLETTER,font:st.DOUBLESTRUCKITALIC,secondary:ct.ALLLETTERS},{set:[["213c","213f"]],type:nt.IDENTIFIER,role:ot.GREEKLETTER,font:st.DOUBLESTRUCK,secondary:ct.ALLLETTERS},{set:["3d0","3d7","3f6",["1d26","1d2a"],"1d5e","1d60",["1d66","1d6a"]],type:nt.IDENTIFIER,role:ot.GREEKLETTER,font:st.NORMAL,secondary:ct.ALLLETTERS},{set:[["2135","2138"]],type:nt.IDENTIFIER,role:ot.OTHERLETTER,font:st.NORMAL,secondary:ct.ALLLETTERS},{set:["131","237"],type:nt.IDENTIFIER,role:ot.LATINLETTER,font:st.NORMAL},{set:["1d6a4","1d6a5"],type:nt.IDENTIFIER,role:ot.LATINLETTER,font:st.ITALIC},{set:["2113","2118"],type:nt.IDENTIFIER,role:ot.LATINLETTER,font:st.SCRIPT},{set:[["c0","d6"],["d8","f6"],["f8","1bf"],["1c4","2af"],["1d00","1d25"],["1d6b","1d9a"],["1e00","1ef9"],["363","36f"],["1dd3","1de6"],["1d62","1d65"],"1dca","2071","207f",["2090","209c"],"2c7c"],type:nt.IDENTIFIER,role:ot.LATINLETTER,font:st.NORMAL},{set:[["00bc","00be"],["2150","215f"],"2189"],type:nt.NUMBER,role:ot.FLOAT},{set:["23E8",["3248","324f"]],type:nt.NUMBER,role:ot.INTEGER},{set:[["214A","214C"],"2705","2713","2714","2717","2718"],type:nt.IDENTIFIER,role:ot.UNKNOWN},{set:["20","a0","ad",["2000","200f"],["2028","202f"],["205f","2060"],"206a","206b","206e","206f","feff",["fff9","fffb"]],type:nt.TEXT,role:ot.SPACE},{set:["7c","a6","2223","23b8","23b9","23d0","2758",["fe31","fe34"],"ff5c","ffe4","ffe8"],type:nt.FENCE,role:ot.NEUTRAL},{set:["2016","2225","2980","2af4"],type:nt.FENCE,role:ot.METRIC}].forEach(t=>{var{set:e}=t,n=tn(t,["set"]);return sn(function(t){let e=[];for(const n of t)Array.isArray(n)?e=e.concat(Q(n)):e.push(String.fromCodePoint(parseInt(n,16)));return e}(e),n)}),an(on.FencesVert,["23b4",["23dc","23e1"],["fe35","fe44"],"fe47"]),an(on.FencesHoriz,["28","2045","207D","208D",["2308","230f"],["231c","231f"],"2329","23b0",["2768","2775"],"27c5",["27e6","27ef"],["2983","2998"],["29d8","29db"],"29fc",["2e22","2e29"],["3008","3011"],["3014","301b"],"fd3e","fe17",["fe59","fe5e"],"ff08","ff5f","ff62"]),an(on.FencesHoriz,["5b","7b","ff3b","ff5b"],2),an(on.FencesHoriz,[["239b","23a6"]],3),an(on.FencesHoriz,[["23a7","23a9"]],4),sn([...on.FencesHoriz.keys()],{type:nt.FENCE,role:ot.OPEN}),sn([...on.FencesHoriz.values()],{type:nt.FENCE,role:ot.CLOSE}),sn([...on.FencesVert.keys()],{type:nt.FENCE,role:ot.TOP}),sn([...on.FencesVert.values()],{type:nt.FENCE,role:ot.BOTTOM}),pn(cn,ct.PAREN),pn(un,ct.CURLY),pn(ln,ct.BRACKET),pn(hn,ct.CEIL),pn(dn,ct.FLOOR),function(){for(const[t,e]of Object.entries(st)){const n=!!x[t]?st.UNKNOWN:e===st.FULLWIDTH?st.NORMAL:e;gn(U.LATINCAP,nt.IDENTIFIER,ot.LATINLETTER,e,n,[ct.ALLLETTERS]),gn(U.LATINSMALL,nt.IDENTIFIER,ot.LATINLETTER,e,n,[ct.ALLLETTERS],{},{3:ct.D}),gn(U.GREEKCAP,nt.IDENTIFIER,ot.GREEKLETTER,e,n,[ct.ALLLETTERS]),gn(U.GREEKSMALL,nt.IDENTIFIER,ot.GREEKLETTER,e,n,[ct.ALLLETTERS],{0:{type:nt.OPERATOR,role:ot.PREFIXOP,font:n},26:{type:nt.OPERATOR,role:ot.PREFIXOP,font:n}}),gn(U.DIGIT,nt.NUMBER,ot.INTEGER,e,n)}}(),sn(["inf","lim","liminf","limsup","max","min","sup","injlim","projlim"],{type:nt.FUNCTION,role:ot.LIMFUNC}),sn(fn,{type:nt.FUNCTION,role:ot.PREFIXFUNC}),sn(["mod","rem"],{type:nt.OPERATOR,role:ot.PREFIXFUNC});class En{constructor(){this.rules=new Map}static parseUnicode(t){const e=parseInt(t,16);return String.fromCodePoint(e)}static testDynamicConstraints_(t,e){return A.getInstance().options.strict?e.cstr.equal(t):A.getInstance().comparator.match(e.cstr)}defineRulesFromMappings(t,e,n){for(const[r,o]of Object.entries(n))for(const[n,i]of Object.entries(o))this.defineRuleFromStrings(t,e,r,n,i)}getRules(t){let e=this.rules.get(t);return e||(e=[],this.rules.set(t,e)),e}defineRuleFromStrings(t,e,n,r,o){let i=this.getRules(t);const s=A.getInstance().parsers[n]||A.getInstance().defaultParser,a=A.getInstance().comparators[n],c=`${t}.${e}.${n}.${r}`,l=s.parse(c),u=a?a():A.getInstance().comparator,h=u.getReference();u.setReference(l);const d={cstr:l,action:o};i=i.filter(t=>!l.equal(t.cstr)),i.push(d),this.rules.set(t,i),u.setReference(h)}lookupRule(t,n){let r=this.getRules(n.getValue(e.LOCALE));return r=r.filter(function(t){return En.testDynamicConstraints_(n,t)}),1===r.length?r[0]:r.length?r.sort((t,e)=>A.getInstance().comparator.compare(t.cstr,e.cstr))[0]:null}}let Nn=s.DEFAULT_VALUES[e.LOCALE],Sn=s.DEFAULT_VALUES[e.MODALITY];function Tn(t){return!(!t.locale&&!t.modality)&&(Nn=t.locale||Nn,Sn=t.modality||Sn,!0)}let In={};function An(t){In=t}const bn=new Map,Rn=new Map;function On(t,e){let n=bn.get(e);return n||(n=new En,n.base=Rn.get(t),bn.set(e,n),n)}function yn(t){const e=Rn.get(t.key);if(!e)return;const n=t.names;Object.assign(t,e),n&&e.names&&(t.names=t.names.concat(n))}function Cn(t,e,n){On(t,e).defineRulesFromMappings(Nn,Sn,n)}function Ln(t,e,n,r){On(n,n).defineRuleFromStrings(Nn,Sn,t,e,r)}function Mn(t){if(!Tn(t))for(const[e,n]of Object.entries(t))Ln("default","default",e,n)}function _n(t){for(let e,n=0;e=t.names[n];n++)Cn(t.key,e,t.mappings)}function vn(t){for(const e of Object.keys(In)){const n=Object.assign({},t);n.mappings={};const r=In[e];n.names=n.names.map(function(t){return e+t});for(const e of Object.keys(t.mappings)){n.mappings[e]={};for(const o of Object.keys(t.mappings[e]))n.mappings[e][o]=Je[Nn]().FUNCTIONS.si(r,t.mappings[e][o])}_n(n)}}function wn(t){const e=bn.get(t);return(null==e?void 0:e.base)?e.base.category:""}function Dn(t={}){for(const e of bn.values())for(const[,n]of e.rules.entries())for(const{cstr:e}of n)t=Pn(e.getValues(),t);return t}function Pn(t,e){return e=e||{},t.length?(e[t[0]]=Pn(t.slice(1),e[t[0]]),e):e}A.getInstance().evaluator=function(t,e){const n=function(t,e){const n=bn.get(t);return n?n.lookupRule(null,e):null}(t,e);return n?n.action:null};class xn{constructor(t,e){this.speech=t,this.attributes=e}static empty(){return new xn("",{})}static stringEmpty(t){return new xn(t,{})}static stringAttr(t,e){return new xn(t,e)}static singleton(t,e={}){return[xn.stringAttr(t,e)]}static node(t,e,n={}){const r=xn.getAttributes(e);return Object.assign(r,n),new xn(t,r)}static getAttributes(t){const e={};for(const n of xn.attributeList)t.hasAttribute(n)&&(e[n]=t.getAttribute(n));return e}}xn.attributeList=["id","extid"];class Un{constructor(t=null){this.data=t,this.prev=null,this.next=null}}class Fn extends Set{constructor(t){super(),this.annotations=[],this.anchor=new Un,this.anchor.next=this.anchor,this.anchor.prev=this.anchor,t.forEach(t=>{const e=new Un(t);t.annotation&&this.annotations.push(e),this.push(e)})}first(){return this.empty?null:this.anchor.next}last(){return this.empty?null:this.anchor.prev}push(t){t.next=this.anchor,t.prev=this.anchor.prev,t.prev.next=t,this.anchor.prev=t,super.add(t)}pop(){const t=this.last();return t?(this.delete(t),t):null}delete(t){return!!this.has(t)&&(super.delete(t),t.prev.next=t.next,t.next=t.prev,!0)}insertAfter(t,e){this.insertBefore(t,e.next)}insertBefore(t,e){const n=new Un(t);e&&this.has(e)?(e.prev.next=n,n.prev=e.prev,n.next=e,e.prev=n):this.push(n)}prevText(t){do{t=t.prev}while(t!==this.anchor&&!t.data.text);return t===this.anchor?null:t}*[Symbol.iterator](){let t=this.anchor.next;for(;t!==this.anchor;)yield t,t=t.next}nextText(t){for(;t!==this.anchor&&!t.data.text;)t=t.next;return t}clear(){this.anchor.next=this.anchor,this.anchor.prev=this.anchor,super.clear()}empty(){return this.anchor.prev===this.anchor&&this.anchor===this.anchor.next}toList(){const t=[];let e=this.anchor.next;for(;e!==this.anchor;)t.push(e.data),e=e.next;return t}}class kn{static create(t,e={}){return t.text=bt.getInstance().apply(t.text,e),new kn(t)}constructor({context:t,text:e,userValue:n,annotation:r,attributes:o,personality:i,layout:s}){this.context=t||"",this.text=e||"",this.userValue=n||"",this.annotation=r||"",this.attributes=o||{},this.personality=i||{},this.layout=s||""}isEmpty(){return 0===this.context.length&&0===this.text.length&&0===this.userValue.length&&0===this.annotation.length}clone(){let t,e;if(this.personality){t={};for(const[e,n]of Object.entries(this.personality))t[e]=n}if(this.attributes){e={};for(const[t,n]of Object.entries(this.attributes))e[t]=n}return new kn({context:this.context,text:this.text,userValue:this.userValue,annotation:this.annotation,personality:t,attributes:e,layout:this.layout})}toString(){return'AuditoryDescription(context="'+this.context+'"  text="'+this.text+'"  userValue="'+this.userValue+'"  annotation="'+this.annotation+'")'}descriptionString(){return this.context&&this.text?this.context+" "+this.text:this.context||this.text}descriptionSpan(){return xn.stringAttr(this.descriptionString(),this.attributes)}equals(t){return this.context===t.context&&this.text===t.text&&this.userValue===t.userValue&&this.annotation===t.annotation}}const Bn=new Map;function Gn(t,e,n){const r={};if(e){const t=Bn.get(e)||{};Object.assign(r,t)}Bn.set(t,Object.assign(r,n))}function Vn(t,e){const n=t.length;let r=0,o=e;return e||(o=""),function(){return r<n&&(r+=1),o+" "+r}}function Hn(t,e){const n=parseFloat(e),r=isNaN(n)?e:n;return function(){return[kn.create({text:"",personality:{pause:r}})]}}function jn(t,e){let n;return n=t.length>0?M("../../content/*",t[0]):[],function(){const t=n.shift(),r=e?[kn.create({text:e},{translate:!0})]:[];if(!t)return r;const o=A.evaluateNode(t);return r.concat(o)}}function qn(t,e){const n=e.split("-"),r=Vn(t,n[0]||""),o=n[1]||"",i=n[2]||"";let s=!0;return function(){const t=r();return s?(s=!1,i+t+o):t+o}}function $n(t){if(function(t){if(!t.hasAttribute("annotation"))return!1;const e=t.getAttribute("annotation");return!!/clearspeak:simple$|clearspeak:simple;/.exec(e)}(t))return!0;if(t.tagName!==nt.SUBSCRIPT)return!1;const e=t.childNodes[0].childNodes,n=e[1];return e[0].tagName===nt.IDENTIFIER&&(Yn(n)||n.tagName===nt.INFIXOP&&n.hasAttribute("role")&&n.getAttribute("role")===ot.IMPLICIT&&function(t){const e=M("children/*",t);return e.every(t=>Yn(t)||t.tagName===nt.IDENTIFIER)}(n))}function Yn(t){return t.tagName===nt.NUMBER&&t.hasAttribute("role")&&t.getAttribute("role")===ot.INTEGER}function Xn(t){return M(t.tagName===nt.MATRIX?"children/row/children/cell/children/*":"children/line/children/*",t).every($n)?[t]:[]}function Wn(t){return ft(t,20,11)?[t]:[]}function Kn(t){const e=parseInt(t.textContent,10);return[xn.stringEmpty(isNaN(e)?t.textContent:e>10?gt.NUMBERS.numericOrdinal(e):gt.NUMBERS.wordOrdinal(e))]}let zn=null;function Qn(t){let e=0;const n=t.textContent,r="open"===t.getAttribute("role")?0:1;let o=t.parentNode;for(;o;)o.tagName===nt.FENCED&&o.childNodes[0].childNodes[r].textContent===n&&e++,o=o.parentNode;return zn=e>1?gt.NUMBERS.wordOrdinal(e):"",[xn.stringEmpty(zn)]}function Jn(t){const e=t.previousSibling;let n,r;return e?(n=e,r=t):(n=t,r=t.nextSibling),r&&function(t,e){const n=on.Meaning.get(t);return n.type===nt.FENCE&&(n.role===ot.NEUTRAL||n.role===ot.METRIC?t===e:on.FencesHoriz.get(t)===e||on.FencesVert.get(t)===e)}(n.textContent,r.textContent)?[t]:[]}function Zn(t){const e=v(t.parentNode.childNodes),n=M("../../children/*",t),r=e.indexOf(t);return nr(n[r])||nr(n[r+1])?[t]:[]}function tr(t){const e=v(t.parentNode.childNodes),n=M("../../children/*",t),r=e.indexOf(t);return er(n[r])&&n[r+1]&&(er(n[r+1])||n[r+1].tagName===nt.ROOT||n[r+1].tagName===nt.SQRT||n[r+1].tagName===nt.SUPERSCRIPT&&n[r+1].childNodes[0].childNodes[0]&&(n[r+1].childNodes[0].childNodes[0].tagName===nt.NUMBER||n[r+1].childNodes[0].childNodes[0].tagName===nt.IDENTIFIER)&&("2"===n[r+1].childNodes[0].childNodes[1].textContent||"3"===n[r+1].childNodes[0].childNodes[1].textContent))?[t]:[]}function er(t){return!!t&&(t.tagName===nt.NUMBER||t.tagName===nt.IDENTIFIER||t.tagName===nt.FUNCTION||t.tagName===nt.APPL||t.tagName===nt.FRACTION)}function nr(t){return t&&(t.tagName===nt.FENCED||t.hasAttribute("role")&&t.getAttribute("role")===ot.LEFTRIGHT||function(t){return!!t&&(t.tagName===nt.MATRIX||t.tagName===nt.VECTOR)}(t))}function rr(t){return[xn.stringEmpty(gt.NUMBERS.wordOrdinal(parseInt(t.textContent,10)))]}function or(t){return wn(t.textContent+":unit")?[t]:[]}function ir(t,e){const n=[];for(;t.length||e.length;)t.length&&n.push(t.shift()),e.length&&n.push(e.shift());return n}function sr(t,e){return t?e?t.filter(t=>e.indexOf(t)<0):t:[]}bt.getInstance().setCorrection("insertNesting",function(t,e){if(!e||!t)return t;const n=t.match(/^(open|close) /);return n?n[0]+e+" "+t.substring(n[0].length):e+" "+t});const ar={factory:null,options:new N,updateFactory:function(t){ar.factory=t},heuristics:new Map,flags:{combine_juxtaposition:!0,convert_juxtaposition:!0,multioperator:!0},blacklist:{},add:function(t){const e=t.name;ar.heuristics.set(e,t),ar.flags[e]||(ar.flags[e]=!1)},run:function(t,e,n){const r=ar.heuristics.get(t);return r&&!ar.blacklist[t]&&(ar.flags[t]||r.applicable(e))?r.apply(e):n?n(e):e}},cr=[];function lr(t,e){for(let n,r=0;n=cr[r];r++){const r=n.compare(t,e);if(0!==r)return r}return 0}function ur(t){if(t.length<=1)return t;const e=t.slice();!function(t){t.sort(lr)}(e);const n=[];let r;do{r=e.pop(),n.push(r)}while(r&&e.length&&0===lr(e[e.length-1],r));return n}function hr(t,e){return t.match(/^.+:.+$/)||!e?t:t+":"+e}new class{constructor(t,e=null){this.comparator=t,this.type=e,function(t){cr.push(t)}(this)}compare(t,e){return this.type&&this.type===t.type&&this.type===e.type?this.comparator(t,e):0}}(function(t,e){return t.role===ot.SIMPLEFUNC?1:e.role===ot.SIMPLEFUNC?-1:0},nt.IDENTIFIER);class dr extends Map{set(t,e){return super.set(hr(t,e.font),e),this}setNode(t){this.set(t.textContent,t.meaning())}get(t,e=null){return super.get(hr(t,e))}getNode(t){return this.get(t.textContent,t.font)}}class pr extends Map{add(t,e){const n=this.get(t);n?n.push(e):super.set(t,[e])}get(t,e=null){return super.get(hr(t,e))}getNode(t){return this.get(t.textContent,t.font)}minimize(){for(const[t,e]of this)1===e.length&&this.delete(t)}isMultiValued(){for(const t of this.values())if(t.length>1)return!0;return!1}}class fr extends pr{add(t,e){super.add(hr(t,e.font),e)}addNode(t){this.add(t.textContent,t)}toString(){const t=[];for(const[e,n]of this){const r=Array(e.length+3).join(" "),o=n.map(t=>t.toString()).join("\n"+r);t.push(e+": "+o)}return t.join("\n")}collateMeaning(){const t=new mr;for(const[e,n]of this)t.set(e,n.map(t=>t.meaning()));return t}}class mr extends pr{add(t,e){const n=this.get(t,e.font);n&&n.find(function(t){return r=e,(n=t).type===r.type&&n.role===r.role&&n.font===r.font;var n,r})||super.add(hr(t,e.font),e)}addNode(t){this.add(t.textContent,t.meaning())}toString(){const t=[];for(const[e,n]of this){const r=Array(e.length+3).join(" "),o=n.map(t=>`{type: ${t.type}, role: ${t.role}, font: ${t.font}}`).join("\n"+r);t.push(e+": "+o)}return t.join("\n")}reduce(){for(const[t,e]of this)1!==e.length&&this.set(t,ur(e))}default(){const t=new dr;for(const[e,n]of this)1===n.length&&t.set(e,n[0]);return t}newDefault(){const t=this.default();this.reduce();const e=this.default();return t.size!==e.size?e:null}}var gr;!function(t){t.ANNOTATION="ANNOTATION",t.ANNOTATIONXML="ANNOTATION-XML",t.MACTION="MACTION",t.MALIGNGROUP="MALIGNGROUP",t.MALIGNMARK="MALIGNMARK",t.MATH="MATH",t.MENCLOSE="MENCLOSE",t.MERROR="MERROR",t.MFENCED="MFENCED",t.MFRAC="MFRAC",t.MGLYPH="MGLYPH",t.MI="MI",t.MLABELEDTR="MLABELEDTR",t.MMULTISCRIPTS="MMULTISCRIPTS",t.MN="MN",t.MO="MO",t.MOVER="MOVER",t.MPADDED="MPADDED",t.MPHANTOM="MPHANTOM",t.MPRESCRIPTS="MPRESCRIPTS",t.MROOT="MROOT",t.MROW="MROW",t.MS="MS",t.MSPACE="MSPACE",t.MSQRT="MSQRT",t.MSTYLE="MSTYLE",t.MSUB="MSUB",t.MSUBSUP="MSUBSUP",t.MSUP="MSUP",t.MTABLE="MTABLE",t.MTD="MTD",t.MTEXT="MTEXT",t.MTR="MTR",t.MUNDER="MUNDER",t.MUNDEROVER="MUNDEROVER",t.NONE="NONE",t.SEMANTICS="SEMANTICS"}(gr||(gr={}));const Er=Object.values(gr),Nr=[gr.MO,gr.MI,gr.MN,gr.MTEXT,gr.MS,gr.MSPACE],Sr=[gr.MERROR,gr.MPHANTOM,gr.MALIGNGROUP,gr.MALIGNMARK,gr.MPRESCRIPTS,gr.ANNOTATION,gr.ANNOTATIONXML],Tr=[gr.MATH,gr.MROW,gr.MPADDED,gr.MACTION,gr.NONE,gr.MSTYLE,gr.SEMANTICS],Ir=[gr.MROOT,gr.MSQRT],Ar=["aria-label","exact-speech","alt"];function br(t){return!!t&&Y(t)===gr.MATH}function Rr(t){return!!t&&(Sr.includes(Y(t))||!Er.includes(Y(t)))}function Or(t){return!!t&&Tr.includes(Y(t))}function yr(t){return!!t&&Y(t)===gr.MGLYPH&&!function(t){return!!t&&Nr.includes(Y(t))}(t.parentNode)}function Cr(t){const e=[];for(let n,r=0;n=t[r];r++){if(n.nodeType!==D.ELEMENT_NODE)continue;const t=Y(n);Sr.includes(t)||(Tr.includes(t)&&0===n.childNodes.length||e.push(n))}return e}function Lr(t,e){var n;if(null===(n=e.attributes)||void 0===n?void 0:n.length){const n=e.attributes;for(let e=n.length-1;e>=0;e--){const r=n[e].name;r.match(/^ext/)&&(t.attributes[r]=n[e].value,t.nobreaking=!0),Ar.includes(r)&&(t.attributes["ext-speech"]=n[e].value,t.nobreaking=!0),"href"===r&&(t.attributes.href=n[e].value,t.nobreaking=!0),"data-latex"!==r.toLowerCase()&&"latex"!==r.toLowerCase()||(t.attributes.latex=n[e].value),r.match(/texclass$/)&&(t.attributes.texclass=n[e].value),"color"!==r&&"mathcolor"!==r||(t.attributes.color=n[e].value)}}}function Mr(t){return t&&t.embellished&&t.childNodes.length>0?Mr(t.childNodes[0]):t}function _r(t,e,n){n&&t.reverse();const r=[];for(let o,i=0;o=t[i];i++){if(e(o))return n?{head:t.slice(i+1).reverse(),div:o,tail:r.reverse()}:{head:r,div:o,tail:t.slice(i+1)};r.push(o)}return n?{head:[],div:null,tail:r.reverse()}:{head:r,div:null,tail:[]}}function vr(t,e){let n=t;const r=[],o=[];let i=null;do{i=_r(n,e),o.push(i.head),r.push(i.div),n=i.tail}while(i.div);return r.pop(),{rel:r,comp:o}}var wr;!function(t){t.EMBELLISHED="embellished",t.FENCEPOINTER="fencepointer",t.FONT="font",t.ID="id",t.ANNOTATION="annotation",t.ROLE="role",t.TYPE="type",t.CHILDREN="children",t.CONTENT="content",t.TEXT="$t"}(wr||(wr={}));class Dr{static fromXml(t){const e=parseInt(t.getAttribute("id"),10),n=new Dr(e);return n.type=t.tagName,Dr.setAttribute(n,t,"role"),Dr.setAttribute(n,t,"font"),Dr.setAttribute(n,t,"embellished"),Dr.setAttribute(n,t,"fencepointer","fencePointer"),t.getAttribute("annotation")&&n.parseAnnotation(t.getAttribute("annotation")),Lr(n,t),Dr.processChildren(n,t),n}static setAttribute(t,e,n,r){r=r||n;const o=e.getAttribute(n);o&&(t[r]=o)}static processChildren(t,e){for(const n of v(e.childNodes)){if(n.nodeType===D.TEXT_NODE){t.textContent=n.textContent;continue}const e=v(n.childNodes).map(Dr.fromXml);e.forEach(e=>e.parent=t),"CONTENT"===Y(n)?t.contentNodes=e:t.childNodes=e}}constructor(t){this.id=t,this.mathml=[],this.parent=null,this.type=nt.UNKNOWN,this.role=ot.UNKNOWN,this.font=st.UNKNOWN,this.embellished=null,this.fencePointer="",this.childNodes=[],this.textContent="",this.mathmlTree=null,this.contentNodes=[],this.annotation={},this.attributes={},this.nobreaking=!1,this.noupdate=!1}querySelectorAll(t){let e=[];for(let n,r=0;n=this.childNodes[r];r++)e=e.concat(n.querySelectorAll(t));for(let n,r=0;n=this.contentNodes[r];r++)e=e.concat(n.querySelectorAll(t));return t(this)&&e.unshift(this),e}xml(t,e){const n=function(n,r){const o=r.map(function(n){return n.xml(t,e)}),i=t.createElementNS("",n);for(let t,e=0;t=o[e];e++)i.appendChild(t);return i},r=t.createElementNS("",this.type);return e||this.xmlAttributes(r),r.textContent=this.textContent,this.contentNodes.length>0&&r.appendChild(n(wr.CONTENT,this.contentNodes)),this.childNodes.length>0&&r.appendChild(n(wr.CHILDREN,this.childNodes)),r}toString(t=!1){const e=w("<snode/>");return W(this.xml(e.ownerDocument,t))}allAttributes(){const t=[];return t.push([wr.ROLE,this.role]),this.font!==st.UNKNOWN&&t.push([wr.FONT,this.font]),Object.keys(this.annotation).length&&t.push([wr.ANNOTATION,this.annotationXml()]),this.embellished&&t.push([wr.EMBELLISHED,this.embellished]),this.fencePointer&&t.push([wr.FENCEPOINTER,this.fencePointer]),t.push([wr.ID,this.id.toString()]),t}annotationXml(){const t=[];for(const[e,n]of Object.entries(this.annotation))n.forEach(n=>t.push(e+":"+n));return t.join(";")}attributesXml(){const t=[];for(const[e,n]of Object.entries(this.attributes))t.push(e+":"+Dr.escapeValue(n));return t.join(";")}toJson(){const t={};t[wr.TYPE]=this.type;const e=this.allAttributes();for(let n,r=0;n=e[r];r++)t[n[0]]=n[1].toString();return this.textContent&&(t[wr.TEXT]=this.textContent),this.childNodes.length&&(t[wr.CHILDREN]=this.childNodes.map(function(t){return t.toJson()})),this.contentNodes.length&&(t[wr.CONTENT]=this.contentNodes.map(function(t){return t.toJson()})),t}updateContent(t,e){const n=e?t.replace(/^[ \f\n\r\t\v\u200b]*/,"").replace(/[ \f\n\r\t\v\u200b]*$/,""):t.trim();if(t=t&&!n?t:n,this.textContent===t)return;const r=on.Meaning.get(t.replace(/\s/g," "));this.textContent=t,this.role=r.role,this.type=r.type,this.font=r.font}addMathmlNodes(t){for(let e,n=0;e=t[n];n++)-1===this.mathml.indexOf(e)&&this.mathml.push(e)}appendChild(t){this.childNodes.push(t),this.addMathmlNodes(t.mathml),t.parent=this}replaceChild(t,e){const n=this.childNodes.indexOf(t);if(-1===n)return;t.parent=null,e.parent=this,this.childNodes[n]=e;const r=t.mathml.filter(function(t){return-1===e.mathml.indexOf(t)}),o=e.mathml.filter(function(e){return-1===t.mathml.indexOf(e)});this.removeMathmlNodes(r),this.addMathmlNodes(o)}appendContentNode(t){t&&(this.contentNodes.push(t),this.addMathmlNodes(t.mathml),t.parent=this)}removeContentNode(t){if(t){const e=this.contentNodes.indexOf(t);-1!==e&&this.contentNodes.slice(e,1)}}equals(t){if(!t)return!1;if(this.type!==t.type||this.role!==t.role||this.textContent!==t.textContent||this.childNodes.length!==t.childNodes.length||this.contentNodes.length!==t.contentNodes.length)return!1;for(let e,n,r=0;e=this.childNodes[r],n=t.childNodes[r];r++)if(!e.equals(n))return!1;for(let e,n,r=0;e=this.contentNodes[r],n=t.contentNodes[r];r++)if(!e.equals(n))return!1;return!0}displayTree(){console.info(this.displayTree_(0))}addAnnotation(t,e){e&&this.addAnnotation_(t,e)}getAnnotation(t){const e=this.annotation[t];return e||[]}hasAnnotation(t,e){const n=this.annotation[t];return!!n&&-1!==n.indexOf(e)}parseAnnotation(t){const e=t.split(";");for(let t=0,n=e.length;t<n;t++){const n=e[t].split(":");this.addAnnotation(n[0],n[1])}}meaning(){return{type:this.type,role:this.role,font:this.font}}xmlAttributes(t){const e=this.allAttributes();for(let n,r=0;n=e[r];r++)t.setAttribute(n[0],n[1]);this.addExternalAttributes(t)}addExternalAttributes(t){for(const[e,n]of Object.entries(this.attributes))t.setAttribute(e,n)}static escapeValue(t){return t.replace(/;/g,"\\0003B")}parseAttributes(t){if(!t)return;const e=t.split(";");for(let t=0,n=e.length;t<n;t++){const[n,...r]=e[t].split(":");n&&(this.attributes[n]=r.join("").replace(/\\0003B/g,";"))}}removeMathmlNodes(t){const e=this.mathml;for(let n,r=0;n=t[r];r++){const t=e.indexOf(n);-1!==t&&e.splice(t,1)}this.mathml=e}displayTree_(t){t++;const e=Array(t).join("  ");let n="";n+="\n"+e+this.toString(),n+="\n"+e+"MathmlTree:",n+="\n"+e+this.mathmlTreeString(),n+="\n"+e+"MathML:";for(let t,r=0;t=this.mathml[r];r++)n+="\n"+e+t.toString();return n+="\n"+e+"Begin Content",this.contentNodes.forEach(function(e){n+=e.displayTree_(t)}),n+="\n"+e+"End Content",n+="\n"+e+"Begin Children",this.childNodes.forEach(function(e){n+=e.displayTree_(t)}),n+="\n"+e+"End Children",n}mathmlTreeString(){return this.mathmlTree?this.mathmlTree.toString():"EMPTY"}addAnnotation_(t,e){const n=this.annotation[t];n&&!n.includes(e)?n.push(e):this.annotation[t]=[e]}}class Pr{constructor(){this.leafMap=new fr,this.defaultMap=new dr,this.idCounter_=-1}makeNode(t){return this.createNode_(t)}makeUnprocessed(t){const e=this.createNode_();return e.mathml=[t],e.mathmlTree=t,e}makeEmptyNode(){const t=this.createNode_();return t.type=nt.EMPTY,t}makeContentNode(t){const e=this.createNode_();return e.updateContent(t),e}makeMultipleContentNodes(t,e){const n=[];for(let r=0;r<t;r++)n.push(this.makeContentNode(e));return n}makeLeafNode(t,e){if(!t)return this.makeEmptyNode();const n=this.makeContentNode(t);n.font=e||n.font;const r=this.defaultMap.getNode(n);return r&&(n.type=r.type,n.role=r.role,n.font=r.font),this.leafMap.addNode(n),n}makeBranchNode(t,e,n,r){const o=this.createNode_();return r&&o.updateContent(r),o.type=t,o.childNodes=e,o.contentNodes=n,e.concat(n).forEach(function(t){t.parent=o,o.addMathmlNodes(t.mathml)}),o}createNode_(t){return void 0!==t?this.idCounter_=Math.max(this.idCounter_,t):t=++this.idCounter_,new Dr(t)}}function xr(t,e){return t.type===e}function Ur(t,e){return t.embellished===e}function Fr(t,e){return t.role===e}function kr(t){return xr(t,nt.FENCE)||xr(t,nt.PUNCTUATION)||xr(t,nt.OPERATOR)||xr(t,nt.RELATION)}function Br(t){return $r(t)&&!Fr(t,ot.DIVISION)||xr(t,nt.APPL)||jr(t)}function Gr(t){return $r(t)||jr(t)}function Vr(t,e){return!!e&&xr(e,nt.IDENTIFIER)&&on.Secondary.has(t.textContent,ct.D)}function Hr(t){if(xr(t,nt.IDENTIFIER)){const e=t.textContent[0];return e&&t.textContent[1]&&on.Secondary.has(e,ct.D)}return!1}function jr(t){return Yr(t)||Xr(t)}function qr(t){return t.embellished?t.embellished:(e=t.type)===nt.OPERATOR||e===nt.RELATION||e===nt.FENCE||e===nt.PUNCTUATION?t.type:null;var e}function $r(t){return xr(t,nt.OPERATOR)||Ur(t,nt.OPERATOR)}function Yr(t){return xr(t,nt.RELATION)||Ur(t,nt.RELATION)}function Xr(t){return xr(t,nt.PUNCTUATION)||Ur(t,nt.PUNCTUATION)}function Wr(t){return xr(t,nt.FENCE)||Ur(t,nt.FENCE)}function Kr(t){return!(!t||!Wr(t))&&(!t.embellished||zr(t))}function zr(t){return!t.embellished||!function(t){return xr(t,nt.TENSOR)&&(!xr(t.childNodes[1],nt.EMPTY)||!xr(t.childNodes[2],nt.EMPTY))&&(!xr(t.childNodes[3],nt.EMPTY)||!xr(t.childNodes[4],nt.EMPTY))}(t)&&((!Fr(t,ot.CLOSE)||!xr(t,nt.TENSOR))&&((!Fr(t,ot.OPEN)||!xr(t,nt.SUBSCRIPT)&&!xr(t,nt.SUPERSCRIPT))&&zr(t.childNodes[0])))}function Qr(t){return!!t&&(xr(t,nt.TABLE)||xr(t,nt.MULTILINE))}function Jr(t){return!!t&&Zr(t)&&Qr(t.childNodes[0])}function Zr(t){return!!t&&xr(t,nt.FENCED)&&(Fr(t,ot.LEFTRIGHT)||mo(t))&&1===t.childNodes.length}function to(t,e){return e.length>0&&Fr(e[e.length-1],ot.OPENFENCE)}function eo(t){return t.childNodes.every(function(t){return t.childNodes.length<=1})}function no(t){return xr(t,nt.LINE)&&t.contentNodes.length&&Fr(t.contentNodes[0],ot.LABEL)}function ro(t){return xr(t,nt.LARGEOP)||xr(t,nt.LIMBOTH)||xr(t,nt.LIMLOWER)||xr(t,nt.LIMUPPER)||xr(t,nt.FUNCTION)&&Fr(t,ot.LIMFUNC)||(xr(t,nt.OVERSCORE)||xr(t,nt.UNDERSCORE))&&ro(t.childNodes[0])}function oo(t,e,n){return 1===e.length&&(t[n].type===nt.PUNCTUATION||t[n].embellished===nt.PUNCTUATION)&&t[n]===e[0]}function io(t){return xr(t,nt.IDENTIFIER)&&Fr(t,ot.SIMPLEFUNC)}const so=[nt.PUNCTUATION,nt.PUNCTUATED,nt.RELSEQ,nt.MULTIREL,nt.TABLE,nt.MULTILINE,nt.CASES,nt.INFERENCE],ao=[nt.LIMUPPER,nt.LIMLOWER,nt.LIMBOTH,nt.SUBSCRIPT,nt.SUPERSCRIPT,nt.UNDERSCORE,nt.OVERSCORE,nt.TENSOR];function co(t){const e=t.type;return-1===so.indexOf(e)&&(e!==nt.INFIXOP||t.role===ot.IMPLICIT)&&(e===nt.FENCED?t.role!==ot.LEFTRIGHT||co(t.childNodes[0]):-1===ao.indexOf(e)||co(t.childNodes[0]))}function lo(t){return function(t){return t.type===nt.NUMBER&&(t.role===ot.INTEGER||t.role===ot.FLOAT)}(t)||t.role===ot.VULGAR||t.role===ot.MIXED}function uo(t){const e=t.childNodes;return t.role===ot.UNIT&&(!e.length||e[0].role===ot.UNIT)}function ho(t){const e=t.childNodes;return t.type===nt.INFIXOP&&(t.role===ot.MULTIPLICATION||t.role===ot.IMPLICIT)&&e.length&&(uo(e[0])||lo(e[0]))&&t.childNodes.slice(1).every(uo)}function po(t){return t.type===nt.INFIXOP&&(t.role===ot.IMPLICIT||t.role===ot.UNIT&&!!t.contentNodes.length&&t.contentNodes[0].textContent===en.invisibleTimes)}function fo(t){return t.type===nt.INFIXOP&&t.role===ot.IMPLICIT}function mo(t){return t.role===ot.NEUTRAL||t.role===ot.METRIC}function go(t,e){return mo(t)&&mo(e)&&Mr(t).textContent===Mr(e).textContent}function Eo(t){return!!mo(t)&&(!t.embellished||t.type!==nt.SUPERSCRIPT&&t.type!==nt.SUBSCRIPT&&(t.type!==nt.TENSOR||t.childNodes[3].type===nt.EMPTY&&t.childNodes[4].type===nt.EMPTY))}function No(t){return!!mo(t)&&(!t.embellished||(t.type!==nt.TENSOR||t.childNodes[1].type===nt.EMPTY&&t.childNodes[2].type===nt.EMPTY))}function So(t){return[ot.ELEMENT,ot.NONELEMENT,ot.REELEMENT,ot.RENONELEMENT].includes(t.role)}class To{static getInstance(){return To.instance=To.instance||new To,To.instance}static tableToMultiline(t){if(!eo(t))return ar.run("rewrite_subcases",t,To.classifyTable);t.type=nt.MULTILINE;for(let e,n=0;e=t.childNodes[n];n++)To.rowToLine_(e,ot.MULTILINE);return 1===t.childNodes.length&&!no(t.childNodes[0])&&Zr(t.childNodes[0].childNodes[0])&&To.tableToMatrixOrVector_(To.rewriteFencedLine_(t)),To.classifyMultiline(t)}static number(t){t.type!==nt.UNKNOWN&&t.type!==nt.IDENTIFIER||(t.type=nt.NUMBER),To.meaningFromContent(t,To.numberRole_),To.exprFont_(t)}static classifyMultiline(t){return To.binomialForm_(t),To.classifyMultiline_(t),t}static classifyMultiline_(t){let e=0;const n=t.childNodes.length;let r;for(;e<n&&(!(r=t.childNodes[e])||!r.childNodes.length);)e++;if(e>=n)return;const o=r.childNodes[0].role;o!==ot.UNKNOWN&&t.childNodes.every(function(t){const e=t.childNodes[0];return!e||e.role===o&&(xr(e,nt.RELATION)||xr(e,nt.RELSEQ))})&&(t.role=o)}static classifyTable(t){const e=To.computeColumns_(t);return To.classifyByColumns_(t,e,ot.EQUALITY)||To.classifyByColumns_(t,e,ot.INEQUALITY,[ot.EQUALITY])||To.classifyByColumns_(t,e,ot.ARROW)||To.detectCaleyTable(t),t}static detectCaleyTable(t){if(!t.mathmlTree)return!1;const e=t.mathmlTree,n=e.getAttribute("columnlines"),r=e.getAttribute("rowlines");return!(!n||!r)&&(!(!To.cayleySpacing(n)||!To.cayleySpacing(r))&&(t.role=ot.CAYLEY,!0))}static cayleySpacing(t){const e=t.split(" ");return("solid"===e[0]||"dashed"===e[0])&&e.slice(1).every(t=>"none"===t)}static proof(t,e,n){const r=To.separateSemantics(e);return To.getInstance().proof(t,r,n)}static findSemantics(t,e,n){const r=null==n?null:n,o=To.getSemantics(t);return!!o&&(!!o[e]&&(null==r||o[e]===r))}static getSemantics(t){const e=t.getAttribute("semantics");return e?To.separateSemantics(e):null}static removePrefix(t){const[,...e]=t.split("_");return e.join("_")}static separateSemantics(t){const e={};return t.split(";").forEach(function(t){const[n,r]=t.split(":");e[To.removePrefix(n)]=r}),e}static matchSpaces_(t,e){for(let n,r=0;n=e[r];r++){const e=t[r].mathmlTree,o=t[r+1].mathmlTree;if(!e||!o)continue;const i=e.nextSibling;if(!i||i===o)continue;const s=To.getSpacer_(i);s&&s!==o&&(n.mathml.push(s),n.mathmlTree=s,n.role=ot.SPACE)}}static getSpacer_(t){if(Y(t)===gr.MSPACE)return t;for(;Or(t)&&1===t.childNodes.length;)if(Y(t=t.childNodes[0])===gr.MSPACE)return t;return null}static fenceToPunct_(t){const e=To.FENCE_TO_PUNCT_[t.role];if(e){for(;t.embellished;)t.embellished=nt.PUNCTUATION,Fr(t,ot.SUBSUP)||Fr(t,ot.UNDEROVER)||(t.role=e),t=t.childNodes[0];t.type=nt.PUNCTUATION,t.role=e}}static classifyFunction_(t,e){if(t.type===nt.APPL||t.type===nt.BIGOP||t.type===nt.INTEGRAL)return"";if(e[0]&&e[0].textContent===en.functionApplication){To.getInstance().funcAppls[t.id]=e.shift();let n=ot.SIMPLEFUNC;return ar.run("simple2prefix",t),t.role!==ot.PREFIXFUNC&&t.role!==ot.LIMFUNC||(n=t.role),To.propagateFunctionRole_(t,n),"prefix"}const n=To.CLASSIFY_FUNCTION_[t.role];return n||((r=t).type===nt.IDENTIFIER||r.role===ot.LATINLETTER||r.role===ot.GREEKLETTER||r.role===ot.OTHERLETTER?"simple":"");var r}static propagateFunctionRole_(t,e){if(t){if(t.type===nt.INFIXOP)return;Fr(t,ot.SUBSUP)||Fr(t,ot.UNDEROVER)||(t.role=e),To.propagateFunctionRole_(t.childNodes[0],e)}}static getFunctionOp_(t,e){if(e(t))return t;for(let n,r=0;n=t.childNodes[r];r++){const t=To.getFunctionOp_(n,e);if(t)return t}return null}static tableToMatrixOrVector_(t){const e=t.childNodes[0];xr(e,nt.MULTILINE)?To.tableToVector_(t):To.tableToMatrix_(t),t.contentNodes.forEach(e.appendContentNode.bind(e));for(let t,n=0;t=e.childNodes[n];n++)To.assignRoleToRow_(t,To.getComponentRoles_(e));return e.parent=null,e}static tableToVector_(t){const e=t.childNodes[0];e.type=nt.VECTOR,1!==e.childNodes.length?To.binomialForm_(e):To.tableToSquare_(t)}static binomialForm_(t){Fr(t,ot.UNKNOWN)&&(2===t.childNodes.length&&(t.role=ot.BINOMIAL,t.childNodes[0].role=ot.BINOMIAL,t.childNodes[1].role=ot.BINOMIAL))}static tableToMatrix_(t){const e=t.childNodes[0];e.type=nt.MATRIX,e.childNodes&&e.childNodes.length>0&&e.childNodes[0].childNodes&&e.childNodes.length===e.childNodes[0].childNodes.length?To.tableToSquare_(t):e.childNodes&&1===e.childNodes.length&&(e.role=ot.ROWVECTOR)}static tableToSquare_(t){const e=t.childNodes[0];Fr(e,ot.UNKNOWN)&&(mo(t)?e.role=ot.DETERMINANT:e.role=ot.SQUAREMATRIX)}static getComponentRoles_(t){const e=t.role;return e&&e!==ot.UNKNOWN?e:t.type.toLowerCase()||ot.UNKNOWN}static tableToCases_(t,e){for(let e,n=0;e=t.childNodes[n];n++)To.assignRoleToRow_(e,ot.CASES);return t.type=nt.CASES,t.appendContentNode(e),eo(t)&&To.binomialForm_(t),t}static rewriteFencedLine_(t){const e=t.childNodes[0],n=t.childNodes[0].childNodes[0],r=t.childNodes[0].childNodes[0].childNodes[0];return n.parent=t.parent,t.parent=n,r.parent=e,n.childNodes=[t],e.childNodes=[r],n}static rowToLine_(t,e){const n=e||ot.UNKNOWN;xr(t,nt.ROW)&&(t.type=nt.LINE,t.role=n,1===t.childNodes.length&&xr(t.childNodes[0],nt.CELL)&&(t.childNodes=t.childNodes[0].childNodes,t.childNodes.forEach(function(e){e.parent=t})))}static assignRoleToRow_(t,e){xr(t,nt.LINE)?t.role=e:xr(t,nt.ROW)&&(t.role=e,t.childNodes.forEach(function(t){xr(t,nt.CELL)&&(t.role=e)}))}static nextSeparatorFunction_(t){let e;if(t){if(t.match(/^\s+$/))return null;e=t.replace(/\s/g,"").split("").filter(function(t){return t})}else e=[","];return function(){return e.length>1?e.shift():e[0]}}static meaningFromContent(t,e){const n=[...t.textContent].filter(t=>t.match(/[^\s]/)),r=n.map(t=>on.Meaning.get(t));e(t,n,r)}static numberRole_(t,e,n){if(t.role===ot.UNKNOWN)return n.every(function(t){return t.type===nt.NUMBER&&t.role===ot.INTEGER||t.type===nt.PUNCTUATION&&t.role===ot.COMMA})?(t.role=ot.INTEGER,void("0"===e[0]&&t.addAnnotation("general","basenumber"))):void(n.every(function(t){return t.type===nt.NUMBER&&t.role===ot.INTEGER||t.type===nt.PUNCTUATION})?t.role=ot.FLOAT:t.role=ot.OTHERNUMBER)}static exprFont_(t){t.font===st.UNKNOWN&&To.compSemantics(t,"font",st)}static compSemantics(t,e,n){const r=[...t.textContent].map(t=>on.Meaning.get(t)).reduce(function(t,r){return t&&r[e]&&r[e]!==n.UNKNOWN&&r[e]!==t?t===n.UNKNOWN?r[e]:null:t},n.UNKNOWN);r&&(t[e]=r)}static purgeFences_(t){const e=t.rel,n=t.comp,r=[],o=[];for(;e.length>0;){const t=e.shift();let i=n.shift();Kr(t)?(r.push(t),o.push(i)):(To.fenceToPunct_(t),i.push(t),i=i.concat(n.shift()),n.unshift(i))}return o.push(n.shift()),{rel:r,comp:o}}static rewriteFencedNode_(t){const e=t.contentNodes[0],n=t.contentNodes[1];let r=To.rewriteFence_(t,e);return t.contentNodes[0]=r.fence,r=To.rewriteFence_(r.node,n),t.contentNodes[1]=r.fence,t.contentNodes[0].parent=t,t.contentNodes[1].parent=t,function(t){const e=on.FencesSecondary.get(t.contentNodes[0].textContent),n=on.FencesSecondary.get(t.contentNodes[1].textContent);e===n&&t.addAnnotation("fences",e)}(t),r.node.parent=null,r.node}static rewriteFence_(t,e){if(!e.embellished)return{node:t,fence:e};const n=e.childNodes[0],r=To.rewriteFence_(t,n);return xr(e,nt.SUPERSCRIPT)||xr(e,nt.SUBSCRIPT)||xr(e,nt.TENSOR)?(Fr(e,ot.SUBSUP)||(e.role=t.role),n!==r.node&&(e.replaceChild(n,r.node),n.parent=t),To.propagateFencePointer_(e,n),{node:e,fence:r.fence}):(e.replaceChild(n,r.fence),e.mathmlTree&&-1===e.mathml.indexOf(e.mathmlTree)&&e.mathml.push(e.mathmlTree),{node:r.node,fence:e})}static propagateFencePointer_(t,e){t.fencePointer=e.fencePointer||e.id.toString(),t.embellished=null}static classifyByColumns_(t,e,n,r=[]){const o=[n].concat(r);return!!(3===e.length&&To.testColumns_(e,1,t=>To.isPureRelation_(t,o))||2===e.length&&(To.testColumns_(e,1,t=>To.isEndRelation_(t,o)||To.isPureRelation_(t,o))||To.testColumns_(e,0,t=>To.isEndRelation_(t,o,!0)||To.isPureRelation_(t,o))))&&(t.role=n,!0)}static isEndRelation_(t,e,n){const r=n?t.childNodes.length-1:0;return xr(t,nt.RELSEQ)&&e.some(e=>Fr(t,e))&&xr(t.childNodes[r],nt.EMPTY)}static isPureRelation_(t,e){return xr(t,nt.RELATION)&&e.some(e=>Fr(t,e))}static computeColumns_(t){const e=[];for(let n,r=0;n=t.childNodes[r];r++)for(let t,r=0;t=n.childNodes[r];r++){e[r]?e[r].push(t):e[r]=[t]}return e}static testColumns_(t,e,n){const r=t[e];return!!r&&(r.some(function(t){return t.childNodes.length&&n(t.childNodes[0])})&&r.every(function(t){return!t.childNodes.length||n(t.childNodes[0])}))}setNodeFactory(t){To.getInstance().factory_=t,ar.updateFactory(To.getInstance().factory_)}getNodeFactory(){return To.getInstance().factory_}identifierNode(t,e,n){if("MathML-Unit"!==n||(r=t,[ot.DEGREE].includes(r.role)||[].includes(r.type))){if(!e&&1===t.textContent.length&&(t.role===ot.INTEGER||t.role===ot.LATINLETTER||t.role===ot.GREEKLETTER)&&t.font===st.NORMAL)return t.font=st.ITALIC,ar.run("simpleNamedFunction",t)}else t.type=nt.IDENTIFIER,t.role=ot.UNIT;var r;return t.type===nt.UNKNOWN&&(t.type=nt.IDENTIFIER),To.exprFont_(t),ar.run("simpleNamedFunction",t)}implicitNode(t){if(t=To.getInstance().getMixedNumbers_(t),t=To.getInstance().combineUnits_(t),1===(t=To.getInstance().combineScripts_(t)).length)return t[0];const e=To.getInstance().implicitNode_(t);return ar.run("combine_juxtaposition",e)}text(t,e){if(To.exprFont_(t),t.type=nt.TEXT,e===gr.ANNOTATIONXML)return t.role=ot.ANNOTATION,t;if(e===gr.MS)return t.role=ot.STRING,t;if(e===gr.MSPACE||t.textContent.match(/^\s*$/))return t.role=ot.SPACE,t;if(/\s/.exec(t.textContent))return t.role=ot.TEXT,t;const n=[...t.textContent];if(1!==n.length)return t.role=ot.UNKNOWN,t;const r=on.Meaning.get(n[0]);return r.type===nt.UNKNOWN||r.type===nt.IDENTIFIER||(t.type=r.type,t.role=r.role,t.font=r.font,t.addAnnotation("general","text")),t}row(t){return 0===(t=t.filter(function(t){return!xr(t,nt.EMPTY)||t.hasAnnotation("empty","MFENCED")})).length?To.getInstance().factory_.makeEmptyNode():(t=To.getInstance().getFencesInRow_(t),t=To.getInstance().tablesInRow(t),t=To.getInstance().getPunctuationInRow_(t),t=To.getInstance().getTextInRow_(t),t=To.getInstance().getFunctionsInRow_(t),To.getInstance().relationsInRow_(t))}limitNode(t,e){if(!e.length)return To.getInstance().factory_.makeEmptyNode();let n=e[0],{length:r}=To.MML_TO_LIMIT_[t];if(e=e.slice(0,r+1),[t,e]=To.getInstance().cleanLimitNode(t,e,r),!e[1])return n;let{type:o,length:i}=To.MML_TO_LIMIT_[t];if(1===i&&e[1].role===ot.DEGREE)return To.getInstance().row([e[0],e[1]]);if(ar.run("op_with_limits",e),ro(n)){if(1===i&&kr(e[1])||2===i&&kr(e[1])&&kr(e[2])){let r=To.MML_TO_BOUNDS_[t];return To.getInstance().accentNode_(n,e,r.type,r.length,r.accent)}if(2===i){if(kr(e[1]))return n=To.getInstance().accentNode_(n,[n,e[1]],{MSUBSUP:nt.SUBSCRIPT,MUNDEROVER:nt.UNDERSCORE}[t],1,!0),e[2]?To.getInstance().makeLimitNode_(n,[n,e[2]],null,nt.LIMUPPER):n;if(e[2]&&kr(e[2]))return n=To.getInstance().accentNode_(n,[n,e[2]],{MSUBSUP:nt.SUPERSCRIPT,MUNDEROVER:nt.OVERSCORE}[t],1,!0),To.getInstance().makeLimitNode_(n,[n,e[1]],null,nt.LIMLOWER);e[i]||(o=nt.LIMLOWER)}return To.getInstance().makeLimitNode_(n,e,null,o)}const s=To.MML_TO_BOUNDS_[t];return To.getInstance().accentNode_(n,e,s.type,s.length,s.accent)}cleanLimitNode(t,e,n){const r=t=>(t=>!t||xr(t,nt.EMPTY))(t)||(t=>t&&xr(t,nt.TEXT)&&Fr(t,ot.SPACE))(t);if(1===n)return r(e[1])?(e[0].noupdate=!0,[t,[Ao([t],e[0])]]):[t,e];const o=e[1],i=e[2];return r(o)&&r(i)?(e[0].noupdate=!0,[t,[Ao([t],e[0])]]):r(o)?[t===gr.MSUBSUP?gr.MSUP:gr.MOVER,[Ao([t],e[0]),i]]:r(i)?[t===gr.MSUBSUP?gr.MSUB:gr.MUNDER,[Ao([t],e[0]),o]]:[t,e]}tablesInRow(t){let e=vr(t,Jr),n=[];for(let t,r=0;t=e.rel[r];r++)n=n.concat(e.comp.shift()),n.push(To.tableToMatrixOrVector_(t));n=n.concat(e.comp.shift()),e=vr(n,Qr),n=[];for(let t,r=0;t=e.rel[r];r++){const r=e.comp.shift();to(0,r)&&To.tableToCases_(t,r.pop()),n=n.concat(r),(n.length||e.comp[0].length)&&(t=To.rewriteTrivialTable(t)),n.push(t)}return n.concat(e.comp.shift())}mfenced(t,e,n,r){if(n&&r.length>0){const t=To.nextSeparatorFunction_(n),e=[r.shift()];r.forEach(n=>{e.push(To.getInstance().factory_.makeContentNode(t())),e.push(n)}),r=e}return t&&e?To.getInstance().horizontalFencedNode_(To.getInstance().factory_.makeContentNode(t),To.getInstance().factory_.makeContentNode(e),r):(t&&r.unshift(To.getInstance().factory_.makeContentNode(t)),e&&r.push(To.getInstance().factory_.makeContentNode(e)),To.getInstance().row(r))}fractionLikeNode(t,e,n,r){let o;if(!r&&function(t){if(!t)return!1;if(["negativeveryverythinmathspace","negativeverythinmathspace","negativethinmathspace","negativemediummathspace","negativethickmathspace","negativeverythickmathspace","negativeveryverythickmathspace"].includes(t))return!0;const e=t.match(/[0-9.]+/);return!!e&&0===parseFloat(e[0])}(n)){const n=To.getInstance().factory_.makeBranchNode(nt.LINE,[t],[]),r=To.getInstance().factory_.makeBranchNode(nt.LINE,[e],[]);return o=To.getInstance().factory_.makeBranchNode(nt.MULTILINE,[n,r],[]),To.classifyMultiline(o)}return o=To.getInstance().fractionNode_(t,e),r&&o.addAnnotation("general","bevelled"),o}tensor(t,e,n,r,o){const i=To.getInstance().factory_.makeBranchNode(nt.TENSOR,[t,To.getInstance().scriptNode_(e,ot.LEFTSUB),To.getInstance().scriptNode_(n,ot.LEFTSUPER),To.getInstance().scriptNode_(r,ot.RIGHTSUB),To.getInstance().scriptNode_(o,ot.RIGHTSUPER)],[]);return i.role=t.role,i.embellished=qr(t),i}pseudoTensor(t,e,n){const r=t=>!xr(t,nt.EMPTY),o=e.filter(r).length,i=n.filter(r).length;if(!o&&!i)return t;const s=o?i?gr.MSUBSUP:gr.MSUB:gr.MSUP,a=[t];return o&&a.push(To.getInstance().scriptNode_(e,ot.RIGHTSUB,!0)),i&&a.push(To.getInstance().scriptNode_(n,ot.RIGHTSUPER,!0)),To.getInstance().limitNode(s,a)}font(t){const e=To.MATHJAX_FONTS[t];return e||t}proof(t,e,n){if(e.inference||e.axiom||console.log("Noise"),e.axiom){const e=To.getInstance().cleanInference(t.childNodes),r=e.length?To.getInstance().factory_.makeBranchNode(nt.INFERENCE,n(e),[]):To.getInstance().factory_.makeEmptyNode();return r.role=ot.AXIOM,r.mathmlTree=t,r}const r=To.getInstance().inference(t,e,n);return e.proof&&(r.role=ot.PROOF,r.childNodes[0].role=ot.FINAL),r}inference(t,e,n){if(e.inferenceRule){const e=To.getInstance().getFormulas(t,[],n);return To.getInstance().factory_.makeBranchNode(nt.INFERENCE,[e.conclusion,e.premises],[])}const r=e.labelledRule,o=v(t.childNodes),i=[];"left"!==r&&"both"!==r||i.push(To.getInstance().getLabel(t,o,n,ot.LEFT)),"right"!==r&&"both"!==r||i.push(To.getInstance().getLabel(t,o,n,ot.RIGHT));const s=To.getInstance().getFormulas(t,o,n),a=To.getInstance().factory_.makeBranchNode(nt.INFERENCE,[s.conclusion,s.premises],i);return a.mathmlTree=t,a}getLabel(t,e,n,r){const o=To.getInstance().findNestedRow(e,"prooflabel",r),i=To.getInstance().factory_.makeBranchNode(nt.RULELABEL,n(v(o.childNodes)),[]);return i.role=r,i.mathmlTree=o,i}getFormulas(t,e,n){const r=e.length?To.getInstance().findNestedRow(e,"inferenceRule"):t,o="up"===To.getSemantics(r).inferenceRule,i=o?r.childNodes[1]:r.childNodes[0],s=o?r.childNodes[0]:r.childNodes[1],a=i.childNodes[0].childNodes[0],c=v(a.childNodes[0].childNodes),l=[];let u=1;for(const t of c)u%2&&l.push(t.childNodes[0]),u++;const h=n(l),d=n(v(s.childNodes[0].childNodes))[0],p=To.getInstance().factory_.makeBranchNode(nt.PREMISES,h,[]);p.mathmlTree=a;const f=To.getInstance().factory_.makeBranchNode(nt.CONCLUSION,[d],[]);return f.mathmlTree=s.childNodes[0].childNodes[0],{conclusion:f,premises:p}}findNestedRow(t,e,n){return To.getInstance().findNestedRow_(t,e,0,n)}cleanInference(t){return v(t).filter(function(t){return"MSPACE"!==Y(t)})}operatorNode(t){return t.type===nt.UNKNOWN&&(t.type=nt.OPERATOR),ar.run("multioperator",t)}static rewriteTrivialTable(t){return xr(e=t,nt.MULTILINE)&&1===e.childNodes.length&&e.childNodes[0].childNodes.length&&!no(e.childNodes[0])?To.getInstance().unwrapTrivialTable(t):t;var e}unwrapTrivialTable(t){if(!t.childNodes[0].childNodes.length)return To.getInstance().factory_.makeEmptyNode();const e=t.childNodes[0].childNodes[0];return e.parent=null,Ao([gr.MTD,gr.MTR,gr.MTABLE],e),e}constructor(){this.funcAppls={},this.splitRoles=new Map([[ot.SUBTRACTION,ot.NEGATIVE],[ot.ADDITION,ot.POSITIVE]]),this.splitOps=["\u2212","-","\u2010","\u2011","+"],this.factory_=new Pr,ar.updateFactory(this.factory_)}implicitNode_(t){const e=To.getInstance().factory_.makeMultipleContentNodes(t.length-1,en.invisibleTimes);To.matchSpaces_(t,e);const n=To.getInstance().infixNode_(t,e[0]);return n.role=ot.IMPLICIT,e.forEach(function(t){t.parent=n}),n.contentNodes=e,n}infixNode_(t,e){let n=To.getInstance().factory_.makeBranchNode(nt.INFIXOP,t,[e],Mr(e).textContent);return n.role=e.role,n=ar.run("propagateInterval",n),ar.run("propagateSimpleFunction",n)}explicitMixed_(t){const e=vr(t,function(t){return t.textContent===en.invisiblePlus});if(!e.rel.length)return t;let n=[];for(let t,r=0;t=e.rel[r];r++){const o=e.comp[r],i=e.comp[r+1],s=o.length-1;if(o[s]&&i[0]&&xr(o[s],nt.NUMBER)&&!Fr(o[s],ot.MIXED)&&xr(i[0],nt.FRACTION)){const t=To.getInstance().factory_.makeBranchNode(nt.NUMBER,[o[s],i[0]],[]);t.role=ot.MIXED,n=n.concat(o.slice(0,s)),n.push(t),i.shift()}else n=n.concat(o),n.push(t)}return n.concat(e.comp[e.comp.length-1])}concatNode_(t,e,n){if(0===e.length)return t;const r=e.map(function(t){return Mr(t).textContent}).join(" "),o=To.getInstance().factory_.makeBranchNode(n,[t],e,r);return e.length>1&&(o.role=ot.MULTIOP),o}prefixNode_(t,e){const n=this.splitSingles(e);let r=t;for(;n.length>0;){const t=n.pop();r=To.getInstance().concatNode_(r,t,nt.PREFIXOP),1===t.length&&-1!==this.splitOps.indexOf(t[0].textContent)&&(r.role=this.splitRoles.get(t[0].role))}return r}splitSingles(t){let e=0;const n=[];let r=0;for(;r<t.length;){const o=t[r];!this.splitRoles.has(o.role)||t[r-1]&&t[r-1].role===o.role||t[r+1]&&t[r+1].role===o.role||-1===this.splitOps.indexOf(o.textContent)||(n.push(t.slice(e,r)),n.push(t.slice(r,r+1)),e=r+1),r++}return e<r&&n.push(t.slice(e,r)),n}postfixNode_(t,e){return e.length?To.getInstance().concatNode_(t,e,nt.POSTFIXOP):t}combineScripts_(t){const e=vr(t,t=>xr(t,nt.SUPERSCRIPT)&&xr(t.childNodes[0],nt.EMPTY)||xr(t,nt.SUBSCRIPT)&&xr(t.childNodes[0],nt.EMPTY));if(!e.rel.length)return t;let n=[];do{const t=e.comp.shift(),r=e.rel.shift();if(!t.length){n.push(r);continue}const o=t.pop();xr(o,nt.NUMBER)||xr(o,nt.IDENTIFIER)?(r.childNodes[0]=o,o.parent=r,r.role=o.type.toLowerCase(),r.addAnnotation("collapsed",o.type.toLowerCase()),n=n.concat(t),n.push(r)):xr(o,nt.SUBSCRIPT)&&xr(r,nt.SUPERSCRIPT)?(r.childNodes[0]=o,o.parent=r,r.role=o.type.toLowerCase(),r.addAnnotation("collapsed",o.type.toLowerCase()),o.role=ot.SUBSUP,n=n.concat(t),n.push(r)):(n=n.concat(t),n.push(o),n.push(r))}while(e.rel.length);return n=n.concat(e.comp.pop()),n}combineUnits_(t){const e=vr(t,function(t){return!Fr(t,ot.UNIT)});if(t.length===e.rel.length)return e.rel;const n=[];let r,o;do{const t=e.comp.shift();r=e.rel.shift();let i=null;o=n.pop(),o&&(t.length&&lo(o)?t.unshift(o):n.push(o)),1===t.length&&(i=t.pop()),t.length>1&&(i=To.getInstance().implicitNode_(t),i.role=ot.UNIT),i&&n.push(i),r&&n.push(r)}while(r);return n}getMixedNumbers_(t){const e=vr(t,function(t){return xr(t,nt.FRACTION)&&Fr(t,ot.VULGAR)});if(!e.rel.length)return t;let n=[];for(let t,r=0;t=e.rel[r];r++){const o=e.comp[r],i=o.length-1;if(o[i]&&xr(o[i],nt.NUMBER)&&(Fr(o[i],ot.INTEGER)||Fr(o[i],ot.FLOAT))){const e=To.getInstance().factory_.makeBranchNode(nt.NUMBER,[o[i],t],[]);e.role=ot.MIXED,n=n.concat(o.slice(0,i)),n.push(e)}else n=n.concat(o),n.push(t)}return n.concat(e.comp[e.comp.length-1])}getTextInRow_(t){if(0===t.length)return t;if(1===t.length)return t[0].type===nt.TEXT&&t[0].role===ot.UNKNOWN&&(t[0].role=ot.ANNOTATION),t;const{rel:e,comp:n}=vr(t,t=>xr(t,nt.TEXT)&&!t.annotation.factor);if(0===e.length)return t;const r=[];let o=n.shift();for(;e.length>0;){let t=e.shift(),i=n.shift();const s=[];for(;!i.length&&e.length&&t.role!==ot.SPACE&&e[0].role!==ot.SPACE;)s.push(t),t=e.shift(),i=n.shift();if(s.length&&(s.push(t),t=To.getInstance().dummyNode_(s)),t.role!==ot.UNKNOWN){const e=Io(o,t,i);if(e){o=e;continue}o.length&&r.push(To.getInstance().row(o)),r.push(t),o=i;continue}const a=on.Meaning.get(t.textContent);if(a.type!==nt.UNKNOWN){t.type=a.type,t.role=a.role,t.font=a.font,t.addAnnotation("general","text"),o.push(t),o=o.concat(i);continue}if(To.meaningFromContent(t,(t,e,n)=>{if(t.role===ot.UNKNOWN){if(To.numberRole_(t,e,n),t.role===ot.OTHERNUMBER)return n.some(t=>t.type!==nt.NUMBER&&t.type!==nt.IDENTIFIER)?(t.type=nt.TEXT,void(t.role=ot.ANNOTATION)):void(t.role=ot.UNKNOWN);t.type=nt.NUMBER}}),t.role===ot.UNKNOWN&&(e.length||i.length?i.length&&i[0].type===nt.FENCED?(t.type=nt.FUNCTION,t.role=ot.PREFIXFUNC):t.role=ot.TEXT:(t.type=nt.IDENTIFIER,t.role=ot.UNIT)),t.type!==nt.TEXT){o.push(t),o=o.concat(i);continue}const c=Io(o,t,i);c?o=c:(o.length&&r.push(To.getInstance().row(o)),r.push(t),o=i)}return o.length>0&&r.push(To.getInstance().row(o)),r.length>1?[To.getInstance().dummyNode_(r)]:r}relationsInRow_(t){const e=vr(t,Yr),n=e.rel[0];if(!n)return To.getInstance().operationsInRow_(t);if(1===t.length)return t[0];const r=e.comp.map(To.getInstance().operationsInRow_);let o;return e.rel.some(function(t){return!t.equals(n)})?(o=To.getInstance().factory_.makeBranchNode(nt.MULTIREL,r,e.rel),e.rel.every(function(t){return t.role===n.role})&&(o.role=n.role),o):(o=To.getInstance().factory_.makeBranchNode(nt.RELSEQ,r,e.rel,Mr(n).textContent),o.role=n.role,o)}operationsInRow_(t){if(0===t.length)return To.getInstance().factory_.makeEmptyNode();if(1===(t=To.getInstance().explicitMixed_(t)).length)return t[0];const e=[];for(;t.length>0&&$r(t[0]);)e.push(t.shift());if(0===t.length)return To.getInstance().prefixNode_(e.pop(),e);if(1===t.length)return To.getInstance().prefixNode_(t[0],e);const n=_r(t=ar.run("convert_juxtaposition",t),$r),r=To.getInstance().wrapFactor(e,n);return To.getInstance().addFactor(r,n)}wrapPostfix(t){var e;(null===(e=t.div)||void 0===e?void 0:e.role)===ot.POSTFIXOP&&(t.tail.length&&t.tail[0].type!==nt.OPERATOR?t.div.role=ot.DIVISION:(t.head=[To.getInstance().postfixNode_(To.getInstance().implicitNode(t.head),[t.div])],t.div=t.tail.shift(),To.getInstance().wrapPostfix(t)))}wrapFactor(t,e){return To.getInstance().wrapPostfix(e),To.getInstance().prefixNode_(To.getInstance().implicitNode(e.head),t)}addFactor(t,e){return e.div?To.getInstance().operationsTree_(e.tail,t,e.div):(ho(t)&&(t.role=ot.UNIT),t)}operationsTree_(t,e,n,r=[]){if(0===t.length){if(r.unshift(n),e.type===nt.INFIXOP){const t=To.getInstance().postfixNode_(e.childNodes.pop(),r);return e.appendChild(t),e}return To.getInstance().postfixNode_(e,r)}const o=_r(t,$r);if(0===o.head.length)return r.push(o.div),To.getInstance().operationsTree_(o.tail,e,n,r);const i=To.getInstance().wrapFactor(r,o),s=To.getInstance().appendOperand_(e,n,i);return To.getInstance().addFactor(s,o)}appendOperand_(t,e,n){if(t.type!==nt.INFIXOP)return To.getInstance().infixNode_([t,n],e);const r=To.getInstance().appendDivisionOp_(t,e,n);return r||(To.getInstance().appendExistingOperator_(t,e,n)?t:e.role===ot.MULTIPLICATION?To.getInstance().appendMultiplicativeOp_(t,e,n):To.getInstance().appendAdditiveOp_(t,e,n))}appendDivisionOp_(t,e,n){return e.role===ot.DIVISION?po(t)?To.getInstance().infixNode_([t,n],e):To.getInstance().appendLastOperand_(t,e,n):t.role===ot.DIVISION?To.getInstance().infixNode_([t,n],e):null}appendLastOperand_(t,e,n){let r=t,o=t.childNodes[t.childNodes.length-1];for(;o&&o.type===nt.INFIXOP&&!po(o);)r=o,o=r.childNodes[t.childNodes.length-1];const i=To.getInstance().infixNode_([r.childNodes.pop(),n],e);return r.appendChild(i),t}appendMultiplicativeOp_(t,e,n){if(po(t))return To.getInstance().infixNode_([t,n],e);let r=t,o=t.childNodes[t.childNodes.length-1];for(;o&&o.type===nt.INFIXOP&&!po(o);)r=o,o=r.childNodes[t.childNodes.length-1];const i=To.getInstance().infixNode_([r.childNodes.pop(),n],e);return r.appendChild(i),t}appendAdditiveOp_(t,e,n){return To.getInstance().infixNode_([t,n],e)}appendExistingOperator_(t,e,n){return!(!t||t.type!==nt.INFIXOP||po(t))&&(t.contentNodes[0].equals(e)?(t.appendContentNode(e),t.appendChild(n),!0):To.getInstance().appendExistingOperator_(t.childNodes[t.childNodes.length-1],e,n))}getFencesInRow_(t){let e=vr(t,Wr);e=To.purgeFences_(e);const n=e.comp.shift();return To.getInstance().fences_(e.rel,e.comp,[],[n])}fences_(t,e,n,r){if(0===t.length&&0===n.length)return r[0];const o=ar.run("bracketed_interval",[t[0],t[1],...e[0]||[]],()=>null);if(o){t.shift(),t.shift(),e.shift();const i=r.pop()||[];return r.push([...i,o,...e.shift()]),To.getInstance().fences_(t,e,n,r)}const i=t=>Fr(t,ot.OPEN);if(0===t.length){const t=r.shift();for(;n.length>0;){if(i(n[0])){const e=n.shift();To.fenceToPunct_(e),t.push(e)}else{const e=_r(n,i),o=e.head.length-1,s=To.getInstance().neutralFences_(e.head,r.slice(0,o));r=r.slice(o),t.push(...s),e.div&&e.tail.unshift(e.div),n=e.tail}t.push(...r.shift())}return t}const s=n[n.length-1],a=t[0].role;if(a===ot.OPEN||mo(t[0])&&(!s||!go(t[0],s))){n.push(t.shift());const o=e.shift();return o&&r.push(o),To.getInstance().fences_(t,e,n,r)}if(s&&a===ot.CLOSE&&s.role===ot.OPEN){const o=To.getInstance().horizontalFencedNode_(n.pop(),t.shift(),r.pop());return r.push(r.pop().concat([o],e.shift())),To.getInstance().fences_(t,e,n,r)}if(s&&go(t[0],s)){if(!Eo(s)||!No(t[0])){n.push(t.shift());const o=e.shift();return o&&r.push(o),To.getInstance().fences_(t,e,n,r)}const o=To.getInstance().horizontalFencedNode_(n.pop(),t.shift(),r.pop());return r.push(r.pop().concat([o],e.shift())),To.getInstance().fences_(t,e,n,r)}if(s&&a===ot.CLOSE&&mo(s)&&n.some(i)){const o=_r(n,i,!0),s=r.pop(),a=r.length-o.tail.length+1,c=To.getInstance().neutralFences_(o.tail,r.slice(a));r=r.slice(0,a);const l=To.getInstance().horizontalFencedNode_(o.div,t.shift(),r.pop().concat(c,s));return r.push(r.pop().concat([l],e.shift())),To.getInstance().fences_(t,e,o.head,r)}const c=t.shift();return To.fenceToPunct_(c),r.push(r.pop().concat([c],e.shift())),To.getInstance().fences_(t,e,n,r)}neutralFences_(t,e){if(0===t.length)return t;if(1===t.length)return To.fenceToPunct_(t[0]),t;const n=t.shift();if(!Eo(n)){To.fenceToPunct_(n);const r=e.shift();return r.unshift(n),r.concat(To.getInstance().neutralFences_(t,e))}const r=_r(t,function(t){return go(t,n)});if(!r.div){To.fenceToPunct_(n);const r=e.shift();return r.unshift(n),r.concat(To.getInstance().neutralFences_(t,e))}if(!No(r.div))return To.fenceToPunct_(r.div),t.unshift(n),To.getInstance().neutralFences_(t,e);const o=To.getInstance().combineFencedContent_(n,r.div,r.head,e);if(r.tail.length>0){const t=o.shift(),e=To.getInstance().neutralFences_(r.tail,o);return t.concat(e)}return o[0]}combineFencedContent_(t,e,n,r){if(0===n.length){const n=To.getInstance().horizontalFencedNode_(t,e,r.shift());return r.length>0?r[0].unshift(n):r=[[n]],r}const o=r.shift(),i=n.length-1,s=r.slice(0,i),a=(r=r.slice(i)).shift(),c=To.getInstance().neutralFences_(n,s);o.push(...c),o.push(...a);const l=To.getInstance().horizontalFencedNode_(t,e,o);return r.length>0?r[0].unshift(l):r=[[l]],r}horizontalFencedNode_(t,e,n){const r=To.getInstance().row(n);xr(r,nt.EMPTY)&&!r.mathmlTree&&t.mathmlTree&&t.mathmlTree.nextSibling!==e.mathmlTree&&(r.mathmlTree=t.mathmlTree.nextSibling,r.mathml=[t.mathmlTree.nextSibling]);let o=To.getInstance().factory_.makeBranchNode(nt.FENCED,[r],[t,e]);return t.role===ot.OPEN?(To.getInstance().classifyHorizontalFence_(o),o=ar.run("propagateComposedFunction",o)):o.role=t.role,o=ar.run("detect_cycle",o),To.rewriteFencedNode_(o)}classifyHorizontalFence_(t){if(ar.run("interval_heuristic",t),t.role===ot.INTERVAL)return;t.role=ot.LEFTRIGHT;const e=t.childNodes;if(!function(t){return function(t){return!!t&&-1!==["{","\ufe5b","\uff5b"].indexOf(t.textContent)}(t.contentNodes[0])&&function(t){return!!t&&-1!==["}","\ufe5c","\uff5d"].indexOf(t.textContent)}(t.contentNodes[1])}(t)||e.length>1)return;if(0===e.length||e[0].type===nt.EMPTY)return void(t.role=ot.SETEMPTY);const n=e[0].type;if(1===e.length&&co(e[0]))return void(t.role=ot.SETSINGLE);const r=e[0].role;if(n===nt.PUNCTUATED&&r===ot.SEQUENCE){if(e[0].contentNodes[0].role!==ot.COMMA)return 1!==e[0].contentNodes.length||e[0].contentNodes[0].role!==ot.VBAR&&e[0].contentNodes[0].role!==ot.COLON?void 0:(t.role=ot.SETEXT,void To.getInstance().setExtension_(t));t.role=ot.SETCOLLECT}}setExtension_(t){const e=t.childNodes[0].childNodes[0];e&&e.type===nt.INFIXOP&&1===e.contentNodes.length&&So(e.contentNodes[0])&&(e.addAnnotation("set","intensional"),e.contentNodes[0].addAnnotation("set","intensional"))}getPunctuationInRow_(t){if(t.length<=1)return t;const e=t=>{const e=t.type;return"punctuation"===e||"text"===e||"operator"===e||"relation"===e},n=vr(t,function(n){if(!Xr(n))return!1;if(Xr(n)&&!Fr(n,ot.ELLIPSIS))return!0;const r=t.indexOf(n);if(0===r)return!t[1]||!e(t[1]);const o=t[r-1];if(r===t.length-1)return!e(o);const i=t[r+1];return!e(o)||!e(i)});if(0===n.rel.length)return t;let r=[],o=n.comp.shift();o.length>0&&r.push(To.getInstance().row(o));let i=0;for(;n.comp.length>0;){let t=[];const e=i;do{t.push(n.rel[i++]),o=n.comp.shift()}while(n.rel[i]&&o&&0===o.length);t=ar.run("ellipses",t),n.rel.splice(e,i-e,...t),i=e+t.length,r=r.concat(t),o&&o.length>0&&r.push(To.getInstance().row(o))}return 1===r.length&&1===n.rel.length?r:[To.getInstance().punctuatedNode_(r,n.rel)]}punctuatedNode_(t,e){const n=To.getInstance().factory_.makeBranchNode(nt.PUNCTUATED,t,e);if(e.length===t.length){const t=e[0].role;if(t!==ot.UNKNOWN&&e.every(function(e){return e.role===t}))return n.role=t,n}const r=e[0];return oo(t,e,0)?n.role=r.childNodes.length&&!r.embellished?r.role:ot.STARTPUNCT:oo(t,e,t.length-1)?n.role=r.childNodes.length&&!r.embellished?r.role:ot.ENDPUNCT:e.every(t=>Fr(t,ot.DUMMY))?n.role=ot.TEXT:e.every(t=>Fr(t,ot.SPACE))?n.role=ot.SPACE:n.role=ot.SEQUENCE,n}dummyNode_(t){const e=To.getInstance().factory_.makeMultipleContentNodes(t.length-1,en.invisibleComma);return e.forEach(function(t){t.role=ot.DUMMY}),To.getInstance().punctuatedNode_(t,e)}accentRole_(t,e){if(!kr(t))return!1;const n=t.textContent,r=on.Secondary.get(n,ct.BAR)||on.Secondary.get(n,ct.TILDE)||t.role;return t.role=e===nt.UNDERSCORE?ot.UNDERACCENT:ot.OVERACCENT,t.addAnnotation("accent",r),!0}accentNode_(t,e,n,r,o){const i=(e=e.slice(0,r+1))[1],s=e[2];let a;if(!o&&s&&(a=To.getInstance().factory_.makeBranchNode(nt.SUBSCRIPT,[t,i],[]),a.role=ot.SUBSUP,e=[a,s],n=nt.SUPERSCRIPT),o){const r=To.getInstance().accentRole_(i,n);if(s){To.getInstance().accentRole_(s,nt.OVERSCORE)&&!r?(a=To.getInstance().factory_.makeBranchNode(nt.OVERSCORE,[t,s],[]),e=[a,i],n=nt.UNDERSCORE):(a=To.getInstance().factory_.makeBranchNode(nt.UNDERSCORE,[t,i],[]),e=[a,s],n=nt.OVERSCORE),a.role=ot.UNDEROVER}}return To.getInstance().makeLimitNode_(t,e,a,n)}makeLimitNode_(t,e,n,r){if(r===nt.LIMUPPER&&t.type===nt.LIMLOWER)return t.childNodes.push(e[1]),e[1].parent=t,t.type=nt.LIMBOTH,t;if(r===nt.LIMLOWER&&t.type===nt.LIMUPPER)return t.childNodes.splice(1,-1,e[1]),e[1].parent=t,t.type=nt.LIMBOTH,t;const o=To.getInstance().factory_.makeBranchNode(r,e,[]),i=qr(t);return n&&(n.embellished=i),o.embellished=i,o.role=t.role,o}getFunctionsInRow_(t,e){const n=e||[];if(0===t.length)return n;const r=t.shift(),o=To.classifyFunction_(r,t);if(!o)return n.push(r),To.getInstance().getFunctionsInRow_(t,n);const i=To.getInstance().getFunctionsInRow_(t,[]),s=To.getInstance().getFunctionArgs_(r,i,o);return n.concat(s)}getFunctionArgs_(t,e,n){let r,o,i;switch(n){case"integral":{const n=To.getInstance().getIntegralArgs_(e);if(!n.intvar&&!n.integrand.length)return n.rest.unshift(t),n.rest;const r=To.getInstance().row(n.integrand);return i=To.getInstance().integralNode_(t,r,n.intvar),ar.run("intvar_from_fraction",i),n.rest.unshift(i),n.rest}case"prefix":if(e[0]&&e[0].type===nt.FENCED){const n=e.shift();return mo(n)||(n.role=ot.LEFTRIGHT),i=To.getInstance().functionNode_(t,n),e.unshift(i),e}if(r=_r(e,Br),r.head.length)o=To.getInstance().row(r.head),r.div&&r.tail.unshift(r.div);else{if(!r.div||!xr(r.div,nt.APPL))return e.unshift(t),e;o=r.div}return i=To.getInstance().functionNode_(t,o),r.tail.unshift(i),r.tail;case"bigop":return r=_r(e,Gr),r.head.length?(o=To.getInstance().row(r.head),i=To.getInstance().bigOpNode_(t,o),r.div&&r.tail.unshift(r.div),r.tail.unshift(i),r.tail):(e.unshift(t),e);default:{if(0===e.length)return[t];const n=e[0];return n.type===nt.FENCED&&!mo(n)&&function(t){const e=t.childNodes;if(0===e.length)return!0;if(e.length>1)return!1;const n=e[0];if(n.type===nt.INFIXOP){if(n.role!==ot.IMPLICIT)return!1;if(n.childNodes.some(t=>xr(t,nt.INFIXOP)))return!1}return!0}(n)?(n.role=ot.LEFTRIGHT,To.propagateFunctionRole_(t,ot.SIMPLEFUNC),i=To.getInstance().functionNode_(t,e.shift()),e.unshift(i),e):(e.unshift(t),e)}}}getIntegralArgs_(t,e=[]){if(0===t.length){const t=_r(e,Gr);return t.div&&t.tail.unshift(t.div),{integrand:t.head,intvar:null,rest:t.tail}}ar.run("intvar_from_implicit",t);const n=t[0];if(jr(n)){const{integrand:n,rest:r}=To.getInstance().getIntegralArgs_(e);return{integrand:n,intvar:null,rest:r.concat(t)}}if(Hr(n))return n.role=ot.INTEGRAL,{integrand:e,intvar:n,rest:t.slice(1)};if(t[1]&&Vr(n,t[1])){const r=To.getInstance().prefixNode_(t[1],[n]);return r.role=ot.INTEGRAL,{integrand:e,intvar:r,rest:t.slice(2)}}return e.push(t.shift()),To.getInstance().getIntegralArgs_(t,e)}functionNode_(t,e){const n=To.getInstance().factory_.makeContentNode(en.functionApplication),r=To.getInstance().funcAppls[t.id];r&&(n.mathmlTree=r.mathmlTree,n.mathml=r.mathml,n.annotation=r.annotation,n.attributes=r.attributes,delete To.getInstance().funcAppls[t.id]),n.type=nt.PUNCTUATION,n.role=ot.APPLICATION;const o=To.getFunctionOp_(t,function(t){return xr(t,nt.FUNCTION)||xr(t,nt.IDENTIFIER)&&Fr(t,ot.SIMPLEFUNC)});return To.getInstance().functionalNode_(nt.APPL,[t,e],o,[n])}bigOpNode_(t,e){const n=To.getFunctionOp_(t,t=>xr(t,nt.LARGEOP));return To.getInstance().functionalNode_(nt.BIGOP,[t,e],n,[])}integralNode_(t,e,n){e=e||To.getInstance().factory_.makeEmptyNode(),n=n||To.getInstance().factory_.makeEmptyNode();const r=To.getFunctionOp_(t,t=>xr(t,nt.LARGEOP));return To.getInstance().functionalNode_(nt.INTEGRAL,[t,e,n],r,[])}functionalNode_(t,e,n,r){const o=e[0];let i;n&&(i=n.parent,r.push(n));const s=To.getInstance().factory_.makeBranchNode(t,e,r);return s.role=o.role,i&&(n.parent=i),s}fractionNode_(t,e){const n=To.getInstance().factory_.makeBranchNode(nt.FRACTION,[t,e],[]);return n.role=n.childNodes.every(function(t){return xr(t,nt.NUMBER)&&Fr(t,ot.INTEGER)})?ot.VULGAR:n.childNodes.every(uo)?ot.UNIT:ot.DIVISION,ar.run("propagateSimpleFunction",n)}scriptNode_(t,e,n){let r;switch(t.length){case 0:r=To.getInstance().factory_.makeEmptyNode();break;case 1:if(r=t[0],n)return r;break;default:r=To.getInstance().dummyNode_(t),r.addAnnotation("general","script")}return r.role=e,r}findNestedRow_(t,e,n,r){if(n>3)return null;for(let o,i=0;o=t[i];i++){const t=Y(o);if(t!==gr.MSPACE){if(t===gr.MROW)return To.getInstance().findNestedRow_(v(o.childNodes),e,n+1,r);if(To.findSemantics(o,e,r))return o}}return null}}function Io(t,e,n){const r=t[t.length-1];if(r&&(r.type===nt.RELATION||r.type===nt.OPERATOR))return e.addAnnotation("factor",r.type),[...t,e,...n];const o=n[0];return!o||o.type!==nt.RELATION&&o.type!==nt.OPERATOR?null:(e.addAnnotation("factor",o.type),[...t,e,...n])}function Ao(t,e){return t.forEach(t=>e.addAnnotation("empty",t)),e}To.FENCE_TO_PUNCT_={[ot.METRIC]:ot.METRIC,[ot.NEUTRAL]:ot.VBAR,[ot.OPEN]:ot.OPENFENCE,[ot.CLOSE]:ot.CLOSEFENCE},To.MML_TO_LIMIT_={[gr.MSUB]:{type:nt.LIMLOWER,length:1},[gr.MUNDER]:{type:nt.LIMLOWER,length:1},[gr.MSUP]:{type:nt.LIMUPPER,length:1},[gr.MOVER]:{type:nt.LIMUPPER,length:1},[gr.MSUBSUP]:{type:nt.LIMBOTH,length:2},[gr.MUNDEROVER]:{type:nt.LIMBOTH,length:2}},To.MML_TO_BOUNDS_={[gr.MSUB]:{type:nt.SUBSCRIPT,length:1,accent:!1},[gr.MSUP]:{type:nt.SUPERSCRIPT,length:1,accent:!1},[gr.MSUBSUP]:{type:nt.SUBSCRIPT,length:2,accent:!1},[gr.MUNDER]:{type:nt.UNDERSCORE,length:1,accent:!0},[gr.MOVER]:{type:nt.OVERSCORE,length:1,accent:!0},[gr.MUNDEROVER]:{type:nt.UNDERSCORE,length:2,accent:!0}},To.CLASSIFY_FUNCTION_={[ot.INTEGRAL]:"integral",[ot.SUM]:"bigop",[ot.PREFIXFUNC]:"prefix",[ot.LIMFUNC]:"prefix",[ot.SIMPLEFUNC]:"prefix",[ot.COMPFUNC]:"prefix"},To.MATHJAX_FONTS={"-tex-caligraphic":st.CALIGRAPHIC,"-tex-caligraphic-bold":st.CALIGRAPHICBOLD,"-tex-calligraphic":st.CALIGRAPHIC,"-tex-calligraphic-bold":st.CALIGRAPHICBOLD,"-tex-oldstyle":st.OLDSTYLE,"-tex-oldstyle-bold":st.OLDSTYLEBOLD,"-tex-mathit":st.ITALIC};let bo={};function Ro(t){return Array.from(t.textContent).map(xn.stringEmpty)}function Oo(t,e){const n=Array.from(t.textContent),r=[],o=To.getInstance(),i=t.ownerDocument;for(let t,s=0;t=n[s];s++){const n=o.getNodeFactory().makeLeafNode(t,st.UNKNOWN),s=o.identifierNode(n,st.UNKNOWN,"");e(s),r.push(s.xml(i))}return r}function yo(t){return Oo(t,function(t){t.textContent.match(/\W/)||(t.type=nt.NUMBER)})}function Co(t){return Oo(t,function(t){t.font=st.UNKNOWN,t.type=nt.IDENTIFIER})}const Lo=[nt.CASES,nt.CELL,nt.INTEGRAL,nt.LINE,nt.MATRIX,nt.MULTILINE,nt.OVERSCORE,nt.ROOT,nt.ROW,nt.SQRT,nt.SUBSCRIPT,nt.SUPERSCRIPT,nt.TABLE,nt.UNDERSCORE,nt.VECTOR];function Mo(t){return bo={},[t]}function _o(t,e,n,r,o,i){r=r||Lo,o=o||{},i=i||function(t){return!1};const s=W(e);if(bo[t]||(bo[t]={}),bo[t][s])return bo[t][s];if(i(e)||n.indexOf(e.tagName)<0)return 0;const a=vo(e,n,sr(r,n),o,i,0);return bo[t][s]=a,a}function vo(t,e,n,r,o,i){if(o(t)||n.indexOf(t.tagName)>-1||function(t,e){if(!t.attributes)return!1;const n=v(t.attributes);for(let t,r=0;t=n[r];r++)if(e[t.nodeName]===t.nodeValue)return!0;return!1}(t,r))return i;if(e.indexOf(t.tagName)>-1&&i++,!t.childNodes||0===t.childNodes.length)return i;const s=v(t.childNodes);return Math.max.apply(null,s.map(function(t){return vo(t,e,n,r,o,i)}))}function wo(t){return _o("fraction",t,["fraction"],Lo,{},gt.FUNCTIONS.fracNestDepth)}function Do(t,e,n){const r=wo(t),o=Array(r).fill(e);return n&&o.push(n),o.join(gt.MESSAGES.regexp.JOINER_FRAC)}function Po(t){return xn.singleton(Do(t,gt.MESSAGES.MS.START,gt.MESSAGES.MS.FRAC_V))}function xo(t){return xn.singleton(Do(t,gt.MESSAGES.MS.END,gt.MESSAGES.MS.FRAC_V),{kind:"LAST"})}function Uo(t){return xn.singleton(Do(t,gt.MESSAGES.MS.FRAC_OVER),{})}function Fo(t){return xn.singleton(Do(t,gt.MESSAGES.MS.START,gt.MESSAGES.MS.FRAC_B))}function ko(t){return xn.singleton(Do(t,gt.MESSAGES.MS.END,gt.MESSAGES.MS.FRAC_B),{kind:"LAST"})}function Bo(t){const e=wo(t);return xn.singleton(1===e?gt.MESSAGES.MS.FRAC_S:gt.FUNCTIONS.combineNestedFraction(gt.MESSAGES.MS.NEST_FRAC,gt.FUNCTIONS.radicalNestDepth(e-1),gt.MESSAGES.MS.FRAC_S))}function Go(t){const e=wo(t);return xn.singleton(1===e?gt.MESSAGES.MS.ENDFRAC:gt.FUNCTIONS.combineNestedFraction(gt.MESSAGES.MS.NEST_FRAC,gt.FUNCTIONS.radicalNestDepth(e-1),gt.MESSAGES.MS.ENDFRAC),{kind:"LAST"})}function Vo(t){const e=wo(t);return xn.singleton(1===e?gt.MESSAGES.MS.FRAC_OVER:gt.FUNCTIONS.combineNestedFraction(gt.MESSAGES.MS.NEST_FRAC,gt.FUNCTIONS.radicalNestDepth(e-1),gt.MESSAGES.MS.FRAC_OVER))}function Ho(t){return gt.FUNCTIONS.fracNestDepth(t)?[t]:[]}function jo(t,e,n){for(;t.parentNode;){const r=t.parentNode,o=r.parentNode;if(!o)break;const i=t.getAttribute&&t.getAttribute("role");(o.tagName===nt.SUBSCRIPT&&t===r.childNodes[1]||o.tagName===nt.TENSOR&&i&&(i===ot.LEFTSUB||i===ot.RIGHTSUB))&&(e=n.sub+gt.MESSAGES.regexp.JOINER_SUBSUPER+e),(o.tagName===nt.SUPERSCRIPT&&t===r.childNodes[1]||o.tagName===nt.TENSOR&&i&&(i===ot.LEFTSUPER||i===ot.RIGHTSUPER))&&(e=n.sup+gt.MESSAGES.regexp.JOINER_SUBSUPER+e),t=o}return e.trim()}function qo(t){return xn.singleton(jo(t,gt.MESSAGES.MS.SUBSCRIPT,{sup:gt.MESSAGES.MS.SUPER,sub:gt.MESSAGES.MS.SUB}))}function $o(t){return xn.singleton(jo(t,gt.MESSAGES.MS.SUB,{sup:gt.MESSAGES.MS.SUP,sub:gt.MESSAGES.MS.SUB}))}function Yo(t){return xn.singleton(jo(t,gt.MESSAGES.MS.SUPERSCRIPT,{sup:gt.MESSAGES.MS.SUPER,sub:gt.MESSAGES.MS.SUB}))}function Xo(t){return xn.singleton(jo(t,gt.MESSAGES.MS.SUP,{sup:gt.MESSAGES.MS.SUP,sub:gt.MESSAGES.MS.SUB}))}function Wo(t){const e=jo(t,"",{sup:gt.MESSAGES.MS.SUPER,sub:gt.MESSAGES.MS.SUB});return xn.singleton(e?e.replace(new RegExp(gt.MESSAGES.MS.SUB+"$"),gt.MESSAGES.MS.SUBSCRIPT).replace(new RegExp(gt.MESSAGES.MS.SUPER+"$"),gt.MESSAGES.MS.SUPERSCRIPT):gt.MESSAGES.MS.BASELINE)}function Ko(t){const e=jo(t,"",{sup:gt.MESSAGES.MS.SUP,sub:gt.MESSAGES.MS.SUB});return xn.singleton(e||gt.MESSAGES.MS.BASE)}function zo(t){return _o("radical",t,["sqrt","root"],Lo,{})}function Qo(t,e,n){const r=zo(t),o=function(t){const e="sqrt"===t.tagName?"2":M("children/*[1]",t)[0].textContent.trim();return gt.MESSAGES.MSroots[e]||""}(t);return n=o?gt.FUNCTIONS.combineRootIndex(n,o):n,1===r?n:gt.FUNCTIONS.combineNestedRadical(e,gt.FUNCTIONS.radicalNestDepth(r-1),n)}function Jo(t){return xn.singleton(Qo(t,gt.MESSAGES.MS.NESTED,gt.MESSAGES.MS.STARTROOT))}function Zo(t){return xn.singleton(Qo(t,gt.MESSAGES.MS.NESTED,gt.MESSAGES.MS.ENDROOT))}function ti(t){return xn.singleton(Qo(t,gt.MESSAGES.MS.NESTED,gt.MESSAGES.MS.ROOTINDEX))}function ei(t){return xn.singleton(Qo(t,gt.MESSAGES.MS.NEST_ROOT,gt.MESSAGES.MS.STARTROOT))}function ni(t){return xn.singleton(Qo(t,gt.MESSAGES.MS.NEST_ROOT,gt.MESSAGES.MS.ENDROOT))}function ri(t){return xn.singleton(Qo(t,gt.MESSAGES.MS.NEST_ROOT,gt.MESSAGES.MS.ROOTINDEX))}function oi(t){return xn.singleton(Qo(t,gt.MESSAGES.MS.NEST_ROOT,gt.MESSAGES.MS.ROOT))}function ii(t){return xn.singleton(Qo(t,gt.MESSAGES.MS.NEST_ROOT,gt.MESSAGES.MS.INDEX))}function si(t){const e=function(t){return _o("underscore",t,["underscore"],Lo,{},function(t){return t.tagName&&t.tagName===nt.UNDERSCORE&&t.childNodes[0].childNodes[1].getAttribute("role")===ot.UNDERACCENT})}(t);return xn.singleton(Array(e).join(gt.MESSAGES.MS.UNDER)+gt.MESSAGES.MS.UNDERSCRIPT)}function ai(t){return xn.singleton(gt.MESSAGES.MS.ENDSCRIPTS)}function ci(t){const e=function(t){return _o("overscore",t,["overscore"],Lo,{},function(t){return t.tagName&&t.tagName===nt.OVERSCORE&&t.childNodes[0].childNodes[1].getAttribute("role")===ot.OVERACCENT})}(t);return xn.singleton(Array(e).join(gt.MESSAGES.MS.OVER)+gt.MESSAGES.MS.OVERSCRIPT)}function li(t){if(t.tagName!==nt.MATRIX||t.getAttribute("role")!==ot.DETERMINANT)return[];const e=M("children/row/children/cell/children/*",t);for(let t,n=0;t=e[n];n++)if(t.tagName!==nt.NUMBER){if(t.tagName===nt.IDENTIFIER){const e=t.getAttribute("role");if(e===ot.LATINLETTER||e===ot.GREEKLETTER||e===ot.OTHERLETTER)continue}return[]}return[t]}function ui(){const t=t=>t.map(t=>"ancestor::"+t),e=t=>"not("+t+")",n=e(t(["subscript","superscript","tensor"]).join(" or ")),r=t(["relseq","multrel"]),o=t(["fraction","punctuation","fenced","sqrt","root"]);let i=[];for(let t,e=0;t=o[e];e++)i=i.concat(r.map(function(e){return t+"/"+e}));return[["ancestor::*/following-sibling::*",n,e(i.join(" | "))].join(" and ")]}function hi(t){if(!t.childNodes.length||!t.childNodes[0].childNodes.length||!t.childNodes[0].childNodes[0].childNodes.length)return xn.singleton("");const e=t.childNodes[0].childNodes[0].childNodes[0].textContent;return xn.singleton(e.match(/^\(.+\)$/)?e.slice(1,-1):e)}const di=new Map([[3,"CSFleftsuperscript"],[4,"CSFleftsubscript"],[2,"CSFbaseline"],[1,"CSFrightsubscript"],[0,"CSFrightsuperscript"]]),pi=new Map([[4,2],[3,3],[2,1],[1,4],[0,5]]);function fi(t){const e=[];let n="",r="",o=parseInt(t,2);for(let t=0;t<5;t++){const i="children/*["+pi.get(t)+"]";if(1&o){const e=di.get(t%5);n="[t] "+e+"Verbose; [n] "+i+";"+n,r="[t] "+e+"Brief; [n] "+i+";"+r}else e.unshift("name("+i+')="empty"');o>>=1}return[e,n,r]}function mi(t,e=!0){const n=["11111","11110","11101","11100","10111","10110","10101","10100","01111","01110","01101","01100"];for(const r of n){let n="tensor"+r,[o,i,s]=fi(r);if(t.defineRule(n,"default",i,"self::tensor",...o),e&&(t.defineRule(n,"brief",s,"self::tensor",...o),t.defineRule(n,"sbrief",s,"self::tensor",...o)),!(3&parseInt(r,2)))continue;const a=di.get(2);i+="; [t]"+a+"Verbose",s+="; [t]"+a+"Brief",n+="-baseline";const c="((.//*[not(*)])[last()]/@id)!=(((.//ancestor::fraction|ancestor::root|ancestor::sqrt|ancestor::cell|ancestor::line|ancestor::stree)[1]//*[not(*)])[last()]/@id)";t.defineRule(n,"default",i,"self::tensor",c,...o),e&&(t.defineRule(n,"brief",s,"self::tensor",c,...o),t.defineRule(n,"sbrief",s,"self::tensor",c,...o))}}function gi(t){let e=Object.keys(gt.MESSAGES.MSroots).length;if(!e)return[];if(e++,!t.childNodes||0===t.childNodes.length||!t.childNodes[0].childNodes)return[];const n=t.childNodes[0].childNodes[0].textContent;if(!/^\d+$/.test(n))return[];const r=parseInt(n,10);return r>1&&r<=e?[t]:[]}function Ei(t,e){let n=0;return function(){return gt.NUMBERS.numericOrdinal(++n)+" "+e}}function Ni(t,e){let n=0;return function(){return gt.NUMBERS.numberToOrdinal(++n,!1)+" "+e}}function Si(t){const e=pt(t,gt.MESSAGES.MS.FRAC_OVER);return e.convertible&&e.enumerator&&e.denominator?[xn.node(gt.NUMBERS.numberToWords(e.enumerator),t.childNodes[0].childNodes[0],{separator:""}),xn.stringAttr(gt.NUMBERS.vulgarSep,{separator:""}),xn.node(gt.NUMBERS.numberToOrdinal(e.denominator,1!==e.enumerator),t.childNodes[0].childNodes[1])]:[xn.node(e.content||"",t)]}function Ti(t){const e=v(t.parentNode.childNodes);return xn.singleton(gt.NUMBERS.numericOrdinal(e.indexOf(t)+1).toString())}function Ii(t){const e=Wo(t);return e[0].speech=e[0].speech.replace(/-$/,""),e}function Ai(t){const e=Ko(t);return e[0].speech=e[0].speech.replace(/-$/,""),e}function bi(t){const e=Yo(t);return e[0].speech=e[0].speech.replace(/^exposant/,"exposant gauche"),e}function Ri(t){const e=qo(t);return e[0].speech=e[0].speech.replace(/^indice/,"indice gauche"),e}function Oi(t){const e=Xo(t);return e[0].speech=e[0].speech.replace(/^sup/,"sup gauche"),e}function yi(t){const e=$o(t);return e[0].speech=e[0].speech.replace(/^sub/,"sub gauche"),e}function Ci(t,e,n){const r=wo(t),o=[...Array(r)].map(t=>e);return n&&o.unshift(n),o.join(gt.MESSAGES.regexp.JOINER_FRAC)}function Li(t){return xn.singleton(Ci(t,gt.MESSAGES.MS.START,gt.MESSAGES.MS.FRAC_V))}function Mi(t){return xn.singleton(Ci(t,gt.MESSAGES.MS.END,gt.MESSAGES.MS.FRAC_V))}function _i(t){return xn.singleton(Ci(t,gt.MESSAGES.MS.START,gt.MESSAGES.MS.FRAC_B))}function vi(t){return xn.singleton(Ci(t,gt.MESSAGES.MS.END,gt.MESSAGES.MS.FRAC_B))}function wi(t){const e=wo(t);return 1===e?xn.singleton(gt.MESSAGES.MS.FRAC_S):xn.singleton(gt.FUNCTIONS.combineNestedFraction(gt.FUNCTIONS.radicalNestDepth(e-1),gt.MESSAGES.MS.NEST_FRAC,gt.MESSAGES.MS.FRAC_S))}function Di(t){const e=wo(t);return 1===e?xn.singleton(gt.MESSAGES.MS.ENDFRAC):xn.singleton(gt.FUNCTIONS.combineNestedFraction(gt.FUNCTIONS.radicalNestDepth(e-1),gt.MESSAGES.MS.NEST_FRAC,gt.MESSAGES.MS.ENDFRAC))}function Pi(t){const e=wo(t);return 1===e?xn.singleton(gt.MESSAGES.MS.FRAC_OVER):xn.singleton(gt.FUNCTIONS.combineNestedFraction(gt.FUNCTIONS.radicalNestDepth(e-1),gt.MESSAGES.MS.NEST_FRAC,gt.MESSAGES.MS.FRAC_OVER))}function xi(t){return 1===M("children/*[1]",t)[0].toString().match(/[^>\u2062>]+<\/[^>]*>/g).length?[t]:[]}function Ui(t,e,n){const r=zo(t);return 1===r?n:gt.FUNCTIONS.combineNestedRadical(gt.FUNCTIONS.radicalNestDepth(r-1),e,n)}function Fi(t){return xn.singleton(Ui(t,gt.MESSAGES.MS.NESTED,gt.MESSAGES.MS.STARTROOT))}function ki(t){return xn.singleton(Ui(t,gt.MESSAGES.MS.NESTED,gt.MESSAGES.MS.ENDROOT))}function Bi(t){return xn.singleton(Ui(t,gt.MESSAGES.MS.NEST_ROOT,gt.MESSAGES.MS.STARTROOT))}function Gi(t){return xn.singleton(Ui(t,gt.MESSAGES.MS.NEST_ROOT,gt.MESSAGES.MS.ENDROOT))}function Vi(t){return xn.singleton(Ui(t,gt.MESSAGES.MS.NEST_ROOT,gt.MESSAGES.MS.ROOT))}function Hi(t,e){const n=function(t){const e=M("children/*[1]",t)[0].textContent.trim();return gt.MESSAGES.MSroots[e]||e+"\uc81c\uacf1\uadfc"}(t);return n||e}function ji(t){return xn.singleton(Hi(t,gt.MESSAGES.MS.ROOTINDEX))}function qi(t){return xn.singleton(Hi(t,gt.MESSAGES.MS.ROOTINDEX))}function $i(t){return xn.singleton(Hi(t,gt.MESSAGES.MS.INDEX))}function Yi(t){const e=M("children/*",t);return xn.singleton(gt.NUMBERS.wordOrdinal(e.length))}function Xi(t){const e=M("children/*",t);return xn.singleton(gt.NUMBERS.wordOrdinal(e.length-1))}function Wi(t){const e=M("children/*",t),n=M("content/*",t);return xn.singleton(gt.NUMBERS.wordOrdinal(e.length-n.length))}function Ki(t,e){const n=t;let r=0;return function(){const t=kn.create({text:Qi(n[r])&&Ji(n[r+1])?gt.MESSAGES.unitTimes:""},{});return r++,[t]}}const zi=[nt.SUPERSCRIPT,nt.SUBSCRIPT,nt.OVERSCORE,nt.UNDERSCORE];function Qi(t){for(;t;){if("unit"===t.getAttribute("role"))return!0;const e=t.tagName,n=M("children/*",t);t=-1!==zi.indexOf(e)?n[0]:n[n.length-1]}return!1}function Ji(t){for(;t;){if("unit"===t.getAttribute("role"))return!0;t=M("children/*",t)[0]}return!1}function Zi(t){for(;t;){if("number"===t.tagName&&"1"===t.textContent)return[t];if("infixop"!==t.tagName||"multiplication"!==t.getAttribute("role")&&"implicit"!==t.getAttribute("role"))return[];t=M("children/*",t)[0]}return[]}function ts(t){const e=wo(t);return xn.singleton(new Array(e).join(gt.MESSAGES.MS.FRACTION_REPEAT)+gt.MESSAGES.MS.FRACTION_START)}function es(t){const e=wo(t);return xn.singleton(new Array(e).join(gt.MESSAGES.MS.FRACTION_REPEAT)+gt.MESSAGES.MS.FRACTION_END)}function ns(t){const e=wo(t);return xn.singleton(new Array(e).join(gt.MESSAGES.MS.FRACTION_REPEAT)+gt.MESSAGES.MS.FRACTION_OVER)}function rs(t){const e=wo(t);return xn.singleton(new Array(e).join(gt.MESSAGES.MS.FRACTION_REPEAT)+"\u2838"+gt.MESSAGES.MS.FRACTION_OVER)}function os(t){return gt.MESSAGES.regexp.HYPER===wo(t).toString()?[t]:[]}function is(t,e){const n=ss(t);return xn.singleton(1===n?e:new Array(n).join(gt.MESSAGES.MS.NESTED)+e)}function ss(t,e){const n=e||0;return t.parentNode?ss(t.parentNode,"root"===t.tagName||"sqrt"===t.tagName?n+1:n):n}function as(t){return is(t,gt.MESSAGES.MS.STARTROOT)}function cs(t){return is(t,gt.MESSAGES.MS.ENDROOT)}function ls(t){return is(t,gt.MESSAGES.MS.ROOTINDEX)}function us(t,e){var n;const r=t.slice(0);let o=!0;const i=t[0].parentNode.parentNode,s=null===(n=i.getAttribute("annotation"))||void 0===n?void 0:n.match(/depth:(\d+)/),a=s?s[1]:"";let c;return c=t.length>0?M("./content/*",i):[],function(){const t=c.shift(),n=r.shift(),s=r[0],l=e?[kn.create({text:e},{translate:!0})]:[];if(!t)return l;const u=n?jo(n,"",{sup:gt.MESSAGES.MS.SUPER,sub:gt.MESSAGES.MS.SUB}):"",h=n&&"EMPTY"!==Y(n)||o&&i&&i.previousSibling?[kn.create({text:gt.MESSAGES.regexp.SPACE+u},{})]:[],d=s&&"EMPTY"!==Y(s)||!c.length&&i&&i.nextSibling?[kn.create({text:gt.MESSAGES.regexp.SPACE},{})]:[],p=A.evaluateNode(t);return p.unshift(new kn({text:"",layout:`beginrel${a}`})),p.push(new kn({text:"",layout:`endrel${a}`})),o=!1,l.concat(h,p,d)}}function hs(t,e){const n=t.slice(0);let r;return r=t.length>0?M("../../content/*",t[0]):[],function(){const t=n.shift(),o=n[0],i=r.shift(),s=e?[kn.create({text:e},{translate:!0})]:[];if(!i)return s;const a=t&&"NUMBER"===Y(t),c=o&&"NUMBER"===Y(o);return s.concat(a&&c&&i.getAttribute("role")===ot.SPACE?[kn.create({text:gt.MESSAGES.regexp.SPACE},{})]:[])}}function ds(t,e){var n;const r=jn(t,e),o=null===(n=t[0].parentNode.parentNode.getAttribute("annotation"))||void 0===n?void 0:n.match(/depth:(\d+)/),i=o?o[1]:"";return function(){const t=r();return t.unshift(new kn({text:"",layout:`beginrel${i}`})),t.push(new kn({text:"",layout:`endrel${i}`})),t}}bt.getInstance().setCorrection("enlargeFence",function(t){const e="\u2820";if(1===t.length)return e+t;const n=t.split("");return n.every(function(t){return"\u2833"===t})?e+n.join(e):t.slice(0,-1)+e+t.slice(-1)}),bt.getInstance().setCorrection("ignoreEnglish",function(t){return Rt(t,gt.ALPHABETS.languagePrefix.english)}),bt.getInstance().setCorrection("literal",function(t){return Array.from(t).map(t=>A.getInstance().evaluator(t,A.getInstance().dynamicCstr)).join("")});let ps=!1;function fs(){ps||(Gn(s.BASE_LOCALE+".speech.mathspeak","",{CQFspaceoutNumber:yo,CQFspaceoutIdentifier:Co,CSFspaceoutText:Ro,CSFopenFracVerbose:Po,CSFcloseFracVerbose:xo,CSFoverFracVerbose:Uo,CSFopenFracBrief:Fo,CSFcloseFracBrief:ko,CSFopenFracSbrief:Bo,CSFcloseFracSbrief:Go,CSFoverFracSbrief:Vo,CSFvulgarFraction:Si,CQFvulgarFractionSmall:Ho,CSFopenRadicalVerbose:Jo,CSFcloseRadicalVerbose:Zo,CSFindexRadicalVerbose:ti,CSFopenRadicalBrief:ei,CSFcloseRadicalBrief:ni,CSFindexRadicalBrief:ri,CSFopenRadicalSbrief:oi,CSFindexRadicalSbrief:ii,CQFisSmallRoot:gi,CSFsuperscriptVerbose:Yo,CSFsuperscriptBrief:Xo,CSFsubscriptVerbose:qo,CSFsubscriptBrief:$o,CSFbaselineVerbose:Wo,CSFbaselineBrief:Ko,CSFleftsuperscriptVerbose:Yo,CSFleftsubscriptVerbose:qo,CSFrightsuperscriptVerbose:Yo,CSFrightsubscriptVerbose:qo,CSFleftsuperscriptBrief:Xo,CSFleftsubscriptBrief:$o,CSFrightsuperscriptBrief:Xo,CSFrightsubscriptBrief:$o,CSFunderscript:si,CSFoverscript:ci,CSFendscripts:ai,CTFordinalCounter:Ei,CTFwordCounter:Ni,CTFcontentIterator:jn,CQFdetIsSimple:li,CSFRemoveParens:hi,CQFresetNesting:Mo,CGFbaselineConstraint:ui,CGFtensorRules:mi}),Gn("es.speech.mathspeak",s.BASE_LOCALE+".speech.mathspeak",{CTFunitMultipliers:Ki,CQFoneLeft:Zi}),Gn("fr.speech.mathspeak",s.BASE_LOCALE+".speech.mathspeak",{CSFbaselineVerbose:Ii,CSFbaselineBrief:Ai,CSFleftsuperscriptVerbose:bi,CSFleftsubscriptVerbose:Ri,CSFleftsuperscriptBrief:Oi,CSFleftsubscriptBrief:yi}),Gn("ko.speech.mathspeak",s.BASE_LOCALE+".speech.mathspeak",{CSFopenFracVerbose:Li,CSFcloseFracVerbose:Mi,CSFopenFracBrief:_i,CSFcloseFracBrief:vi,CSFopenFracSbrief:wi,CSFoverFracSbrief:Pi,CSFcloseFracSbrief:Di,CQFisSimpleIndex:xi,CSFindexRadicalVerbose:ji,CSFindexRadicalBrief:qi,CSFindexRadicalSbrief:$i,CSFopenRadicalVerbose:Fi,CSFcloseRadicalVerbose:ki,CSFopenRadicalBrief:Bi,CSFcloseRadicalBrief:Gi,CSFopenRadicalSbrief:Vi}),Gn(s.BASE_LOCALE+".speech.clearspeak","",{CTFpauseSeparator:Hn,CTFnodeCounter:qn,CTFcontentIterator:jn,CSFvulgarFraction:Si,CQFvulgarFractionSmall:Wn,CQFcellsSimple:Xn,CSFordinalExponent:Kn,CSFwordOrdinal:rr,CQFmatchingFences:Jn,CSFnestingDepth:Qn,CQFfencedArguments:Zn,CQFsimpleArguments:tr,CQFspaceoutNumber:yo,CQFisUnit:or}),Gn("en.prefix.default","",{CSFordinalPosition:Ti}),Gn("en.speech.chromevox","",{CTFnodeCounter:Vn,CTFcontentIterator:jn}),Gn("en.speech.emacspeak","en.speech.chromevox",{CQFvulgarFractionSmall:Ho,CSFvulgarFraction:Si}),Gn("ko.summary.","ko.speech.mathspeak",{CSFordinalConversion:Yi,CSFdecreasedOrdinalConversion:Xi,CSFlistOrdinalConversion:Wi}),Gn("nemeth.braille.default",s.BASE_LOCALE+".speech.mathspeak",{CSFopenFraction:ts,CSFcloseFraction:es,CSFoverFraction:ns,CSFoverBevFraction:rs,CQFhyperFraction:os,CSFopenRadical:as,CSFcloseRadical:cs,CSFindexRadical:ls,CSFsubscript:qo,CSFsuperscript:Yo,CSFbaseline:Wo,CGFtensorRules:t=>mi(t,!1),CTFcontentIterator:ds,CTFrelationIterator:us,CTFimplicitIterator:hs}),Gn("euro.braille.default","nemeth.braille.default",{}),ps=!0)}class ms{constructor(t,e,n){this.domain=t,this.name=e,this.func=n,this.active=!1}annotate(t){t.childNodes.forEach(this.annotate.bind(this)),t.contentNodes.forEach(this.annotate.bind(this)),t.addAnnotation(this.domain,this.func(t))}}class gs{constructor(t,e,n,r={}){this.domain=t,this.name=e,this.func=n,this.def=r,this.active=!1}visit(t,e){let n=this.func(t,e);t.addAnnotation(this.domain,n[0]);for(let e,r=0;e=t.childNodes[r];r++)n=this.visit(e,n[1]);for(let e,r=0;e=t.contentNodes[r];r++)n=this.visit(e,n[1]);return n}}const Es=new Map,Ns=new Map;function Ss(t){const e=t.domain+":"+t.name;t instanceof ms?Es.set(e,t):Ns.set(e,t)}function Ts(t,e){const n=t+":"+e,r=Es.get(n)||Ns.get(n);r&&(r.active=!0)}class Is{constructor(t,e,n,r){this.name=t,this.dynamicCstr=e,this.precondition=n,this.action=r,this.context=null}toString(){return this.name+" | "+this.dynamicCstr.toString()+" | "+this.precondition.toString()+" ==> "+this.action.toString()}}var As,bs;function Rs(t){switch(t){case"[n]":return As.NODE;case"[m]":return As.MULTI;case"[t]":return As.TEXT;case"[p]":return As.PERSONALITY;default:throw"Parse error: "+t}}!function(t){t.NODE="NODE",t.MULTI="MULTI",t.TEXT="TEXT",t.PERSONALITY="PERSONALITY"}(As||(As={}));class Os{static grammarFromString(t){return bt.parseInput(t)}static fromString(t){const e={type:Rs(t.substring(0,3))};let n=t.slice(3).trim();if(!n)throw new Ls("Missing content.");switch(e.type){case As.TEXT:if('"'===n[0]){const t=Ms(n,"\\(")[0].trim();if('"'!==t.slice(-1))throw new Ls("Invalid string syntax.");e.content=t,n=n.slice(t.length).trim(),-1===n.indexOf("(")&&(n="");break}case As.NODE:case As.MULTI:{const t=n.indexOf(" (");if(-1===t){e.content=n.trim(),n="";break}e.content=n.substring(0,t).trim(),n=n.slice(t).trim()}}if(n){const t=Os.attributesFromString(n);t.grammar&&(e.grammar=t.grammar,delete t.grammar),Object.keys(t).length&&(e.attributes=t)}return new Os(e)}static attributesFromString(t){if("("!==t[0]||")"!==t.slice(-1))throw new Ls("Invalid attribute expression: "+t);const e={},n=Ms(t.slice(1,-1),",");for(const t of n){const n=t.indexOf(":");if(-1===n)e[t.trim()]="true";else{const r=t.substring(0,n).trim(),o=t.slice(n+1).trim();e[r]=r===At?Os.grammarFromString(o):o}}return e}constructor({type:t,content:e,attributes:n,grammar:r}){this.type=t,this.content=e,this.attributes=n,this.grammar=r}toString(){let t="";t+=function(t){switch(t){case As.NODE:return"[n]";case As.MULTI:return"[m]";case As.TEXT:return"[t]";case As.PERSONALITY:return"[p]";default:throw"Unknown type error: "+t}}(this.type),t+=this.content?" "+this.content:"";const e=this.attributesToString();return t+=e?" "+e:"",t}grammarToString(){return this.getGrammar().join(":")}getGrammar(){if(!this.grammar)return[];const t=[];for(const[e,n]of Object.entries(this.grammar))t.push(!0===n?e:!1===n?`!${e}`:`${e}=${n}`);return t}attributesToString(){const t=this.getAttributes(),e=this.grammarToString();return e&&t.push("grammar:"+e),t.length>0?"("+t.join(", ")+")":""}getAttributes(){if(!this.attributes)return[];const t=[];for(const[e,n]of Object.entries(this.attributes))t.push("true"===n?e:`${e}:${n}`);return t}}class ys{static fromString(t){const e=Ms(t,";").filter(function(t){return t.match(/\S/)}).map(function(t){return t.trim()}),n=[];for(let t=0,r=e.length;t<r;t++){const r=Os.fromString(e[t]);r&&n.push(r)}return ys.naiveSpan(n),new ys(n)}static naiveSpan(t){var e;let n=!1;for(let r,o=0;r=t[o];o++){if(n&&(r.type!==As.TEXT||'"'!==r.content[0]&&!r.content.match(/^CSF/)))continue;if(!n&&r.type===As.PERSONALITY)continue;if(!n){n=!0;continue}if(null===(e=r.attributes)||void 0===e?void 0:e.span)continue;const i=t[o+1];i&&i.type!==As.NODE||ys.addNaiveSpan(r,i?i.content:"LAST")}}static addNaiveSpan(t,e){t.attributes||(t.attributes={}),t.attributes.span=e}constructor(t){this.components=t}toString(){return this.components.map(function(t){return t.toString()}).join("; ")}}class Cs{static constraintValue(t,e){for(let n,r=0;n=e[r];r++)if(t.match(n))return++r;return 0}toString(){const t=this.constraints.join(", ");return`${this.query}, ${t} (${this.priority}, ${this.rank})`}constructor(t,...e){this.query=t,this.constraints=e;const[n,r]=this.presetPriority();this.priority=n?r:this.calculatePriority()}calculatePriority(){const t=Cs.constraintValue(this.query,Cs.queryPriorities);if(!t)return 0;const e=this.query.match(/^self::.+\[(.+)\]/);let n=0;if((null==e?void 0:e.length)&&e[1]){const t=e[1];n=Cs.constraintValue(t,Cs.attributePriorities)}return 100*t+10*n}presetPriority(){if(!this.constraints.length)return[!1,0];const t=this.constraints[this.constraints.length-1].match(/^priority=(.*$)/);if(!t)return[!1,0];this.constraints.pop();const e=parseFloat(t[1]);return[!0,isNaN(e)?0:e]}}Cs.queryPriorities=[/^self::\*$/,/^self::[\w-]+$/,/^self::\*\[.+\]$/,/^self::[\w-]+\[.+\]$/],Cs.attributePriorities=[/^@[\w-]+$/,/^@[\w-]+!=".+"$/,/^not\(contains\(@[\w-]+,\s*".+"\)\)$/,/^contains\(@[\w-]+,".+"\)$/,/^@[\w-]+=".+"$/];class Ls extends I{constructor(t){super(t),this.name="RuleError"}}function Ms(t,e){const n=[];let r="";for(;""!==t;){const o=t.search(e);if(-1===o){if((t.match(/"/g)||[]).length%2!=0)throw new Ls("Invalid string in expression: "+t);n.push(r+t),r="",t=""}else if((t.substring(0,o).match(/"/g)||[]).length%2==0)n.push(r+t.substring(0,o)),r="",t=t.substring(o+1);else{const e=t.substring(o).search('"');if(-1===e)throw new Ls("Invalid string in expression: "+t);r+=t.substring(0,o+e+1),t=t.substring(o+e+1)}}return r&&n.push(r),n}class _s{constructor(t,e){this.prefix=t,this.store=e}add(t,e){this.checkCustomFunctionSyntax_(t)&&(this.store[t]=e)}addStore(t){const e=Object.keys(t.store);for(let n,r=0;n=e[r];r++)this.add(n,t.store[n])}lookup(t){return this.store[t]}checkCustomFunctionSyntax_(t){const e=new RegExp("^"+this.prefix);return!!t.match(e)||(console.error("FunctionError: Invalid function name. Expected prefix "+this.prefix),!1)}}class vs extends _s{constructor(){super("CQF",{})}}class ws extends _s{constructor(){super("CSF",{})}}class Ds extends _s{constructor(){super("CTF",{})}}class Ps extends _s{constructor(){super("CGF",{})}}class xs{constructor(){this.customQueries=new vs,this.customStrings=new ws,this.contextFunctions=new Ds,this.customGenerators=new Ps}applyCustomQuery(t,e){const n=this.customQueries.lookup(e);return n?n(t):null}applySelector(t,e){return this.applyCustomQuery(t,e)||M(e,t)}applyQuery(t,e){const n=this.applySelector(t,e);return n.length>0?n[0]:null}applyConstraint(t,e){return!!this.applyQuery(t,e)||function(t,e){let n;try{n=L(t,e,R.result.BOOLEAN_TYPE)}catch(t){return!1}return n.booleanValue}(e,t)}constructString(t,e){const n=this.constructString_(t,e);return Array.isArray(n)?n.map(t=>t.speech).join(""):n}constructSpan(t,e,n){const r=this.constructString_(t,e);if(Array.isArray(r)){const t=r[r.length-1];return t.attributes=Object.assign({},n,t.attributes),r}return[xn.node(r,t,n)]}constructString_(t,e){if(!e)return"";if('"'===e.charAt(0))return e.slice(1,-1);const n=this.customStrings.lookup(e);return n?n(t):function(t,e){let n;try{n=L(t,e,R.result.STRING_TYPE)}catch(t){return""}return n.stringValue}(e,t)}parse(t){const e=Array.isArray(t)?t:Object.entries(t);for(const t of e){switch(t[0].slice(0,3)){case"CQF":this.customQueries.add(t[0],t[1]);break;case"CSF":this.customStrings.add(t[0],t[1]);break;case"CTF":this.contextFunctions.add(t[0],t[1]);break;case"CGF":this.customGenerators.add(t[0],t[1]);break;default:console.error("FunctionError: Invalid function name "+t[0])}}}}class Us{static compareStaticConstraints_(t,e){if(t.length!==e.length)return!1;for(let n,r=0;n=t[r];r++)if(-1===e.indexOf(n))return!1;return!0}static comparePreconditions_(t,e){const n=t.precondition,r=e.precondition;return n.query===r.query&&Us.compareStaticConstraints_(n.constraints,r.constraints)}constructor(){this.context=new xs,this.parseOrder=s.DEFAULT_ORDER,this.parser=new a(this.parseOrder),this.locale=s.DEFAULT_VALUES[e.LOCALE],this.modality=s.DEFAULT_VALUES[e.MODALITY],this.domain="",this.initialized=!1,this.inherits=null,this.kind="standard",this.customTranscriptions={},this.preconditions=new Map,this.speechRules_=[],this.rank=0,this.parseMethods={Rule:this.defineRule,Generator:this.generateRules,Action:this.defineAction,Precondition:this.definePrecondition,Ignore:this.ignoreRules}}defineRule(t,e,n,r,...o){const i=this.parseAction(n),s=this.parsePrecondition(r,o),a=this.parseCstr(e);if(!(i&&s&&a))return console.error(`Rule Error: ${r}, (${e}): ${n}`),null;const c=new Is(t,a,s,i);return c.precondition.rank=this.rank++,this.addRule(c),c}addRule(t){t.context=this.context,this.speechRules_.unshift(t)}deleteRule(t){const e=this.speechRules_.indexOf(t);-1!==e&&this.speechRules_.splice(e,1)}findRule(t){for(let e,n=0;e=this.speechRules_[n];n++)if(t(e))return e;return null}findAllRules(t){return this.speechRules_.filter(t)}evaluateDefault(t){const e=t.textContent.slice(0);return e.match(/^\s+$/)?this.evaluateWhitespace(e):this.evaluateString(e)}evaluateWhitespace(t){return[]}evaluateCustom(t){const e=this.customTranscriptions[t];return void 0!==e?kn.create({text:e},{adjust:!0,translate:!1}):null}evaluateCharacter(t){return this.evaluateCustom(t)||kn.create({text:t},{adjust:!0,translate:!0})}removeDuplicates(t){for(let e,n=this.speechRules_.length-1;e=this.speechRules_[n];n--)e!==t&&t.dynamicCstr.equal(e.dynamicCstr)&&Us.comparePreconditions_(e,t)&&this.speechRules_.splice(n,1)}getSpeechRules(){return this.speechRules_}setSpeechRules(t){this.speechRules_=t}getPreconditions(){return this.preconditions}parseCstr(t){try{return this.parser.parse(this.preParseCstr(t))}catch(e){if("RuleError"===e.name)return console.error("Rule Error ",`Illegal Dynamic Constraint: ${t}.`,e.message),null;throw e}}parsePrecondition(t,e){try{const n=this.parsePrecondition_(t);t=n[0];let r=n.slice(1);for(const t of e)r=r.concat(this.parsePrecondition_(t));return new Cs(t,...r)}catch(n){if("RuleError"===n.name)return console.error("Rule Error ",`Illegal preconditions: ${t}, ${e}.`,n.message),null;throw n}}parseAction(t){try{return ys.fromString(t)}catch(e){if("RuleError"===e.name)return console.error("Rule Error ",`Illegal action: ${t}.`,e.message),null;throw e}}parse(t){this.modality=t.modality||this.modality,this.locale=t.locale||this.locale,this.domain=t.domain||this.domain,this.context.parse(t.functions||[]),"actions"!==t.kind&&(this.kind=t.kind||this.kind,this.inheritRules()),this.parseRules(t.rules||[])}parseRules(t){for(let e,n=0;e=t[n];n++){const t=e[0],n=this.parseMethods[t];t&&n&&n.apply(this,e.slice(1))}}generateRules(t){const e=this.context.customGenerators.lookup(t);e&&e(this)}defineAction(t,e){let n;try{n=ys.fromString(e)}catch(t){if("RuleError"===t.name)return void console.error("Action Error ",e,t.message);throw t}const r=this.getFullPreconditions(t);if(!r)return void console.error(`Action Error: No precondition for action ${t}`);this.ignoreRules(t);const o=new RegExp("^\\w+\\.\\w+\\.");r.conditions.forEach(([e,r])=>{const i=this.parseCstr(e.toString().replace(o,""));this.addRule(new Is(t,i,r,n))})}getFullPreconditions(t){const e=this.preconditions.get(t);return e||!this.inherits?e:this.inherits.getFullPreconditions(t)}definePrecondition(t,e,n,...r){const o=this.parsePrecondition(n,r),i=this.parseCstr(e);o&&i?(o.rank=this.rank++,this.preconditions.set(t,new Fs(i,o))):console.error(`Precondition Error: ${n}, (${e})`)}inheritRules(){if(!this.inherits||!this.inherits.getSpeechRules().length)return;const t=new RegExp("^\\w+\\.\\w+\\."+(this.domain?"\\w+\\.":""));this.inherits.getSpeechRules().forEach(e=>{const n=this.parseCstr(e.dynamicCstr.toString().replace(t,""));this.addRule(new Is(e.name,n,e.precondition,e.action))})}ignoreRules(t,...e){let n=this.findAllRules(e=>e.name===t);if(!e.length)return void n.forEach(this.deleteRule.bind(this));let r=[];for(const t of e){const e=this.parseCstr(t);for(const t of n)e.equal(t.dynamicCstr)?this.deleteRule(t):r.push(t);n=r,r=[]}}parsePrecondition_(t){const e=this.context.customGenerators.lookup(t);return e?e():[t]}preParseCstr(t){const e=t.match("(.+)\\.(.+)");return this.locale+"."+this.modality+"."+(e?t:(this.domain?this.domain:"")+"."+t)}}class Fs{constructor(t,e){this.base=t,this._conditions=[],this.constraints=[],this.allCstr={},this.constraints.push(t),this.addCondition(t,e)}get conditions(){return this._conditions}addConstraint(t){if(this.constraints.filter(e=>e.equal(t)).length)return;this.constraints.push(t);const e=[];for(const[n,r]of this.conditions)this.base.equal(n)&&e.push([t,r]);this._conditions=this._conditions.concat(e)}addBaseCondition(t){this.addCondition(this.base,t)}addFullCondition(t){this.constraints.forEach(e=>this.addCondition(e,t))}addCondition(t,e){const n=t.toString()+" "+e.toString();this.allCstr.condStr||(this.allCstr[n]=!0,this._conditions.push([t,e]))}}class ks extends Us{constructor(){super(),this.annotators=[],this.parseMethods.Alias=this.defineAlias,this.parseMethods.AliasRule=this.defineRulesAlias,this.parseMethods.SpecializedRule=this.defineSpecializedRule,this.parseMethods.Specialized=this.defineSpecialized}initialize(){this.initialized||(this.annotations(),this.initialized=!0)}annotations(){for(let t,e=0;t=this.annotators[e];e++)Ts(this.domain,t)}defineAlias(t,e,...n){const r=this.parsePrecondition(e,n);if(!r)return void console.error(`Precondition Error: ${e} ${n}`);const o=this.preconditions.get(t)||this.getFullPreconditions(t);o?o.addFullCondition(r):console.error(`Alias Error: No precondition by the name of ${t}`)}defineRulesAlias(t,e,...n){const r=this.findAllRules(function(e){return e.name===t});if(0===r.length)throw new Ls("Rule with name "+t+" does not exist.");const o=[];r.forEach(t=>{(t=>{const e=t.dynamicCstr.toString(),n=t.action.toString();for(let t,r=0;t=o[r];r++)if(t.action===n&&t.cstr===e)return!1;return o.push({cstr:e,action:n}),!0})(t)&&this.addAlias_(t,e,n)})}defineSpecializedRule(t,e,n,r){const o=this.parseCstr(e),i=this.findRule(e=>e.name===t&&o.equal(e.dynamicCstr)),s=this.parseCstr(n);if(!i&&r)throw new Ls("Rule named "+t+" with style "+e+" does not exist.");const a=r?ys.fromString(r):i.action,c=new Is(i.name,s,i.precondition,a);this.addRule(c)}defineSpecialized(t,e,n){const r=this.parseCstr(n);if(!r)return void console.error(`Dynamic Constraint Error: ${n}`);const o=this.preconditions.get(t);o?o.addConstraint(r):console.error(`Alias Error: No precondition by the name of ${t}`)}evaluateString(t){const e=[];if(t.match(/^\s+$/))return e;let n=this.matchNumber(t);if(n&&n.length===t.length)return e.push(this.evaluateCharacter(n.number)),e;const r=t.replace(/\s/g," ").split(" ").filter(t=>t);for(let t,o=0;t=r[o];o++)if(1===t.length)e.push(this.evaluateCharacter(t));else if(t.match(new RegExp("^["+gt.MESSAGES.regexp.TEXT+"]+$")))e.push(this.evaluateCharacter(t));else{let r=t;for(;r;){n=this.matchNumber(r);const t=r.match(new RegExp("^["+gt.MESSAGES.regexp.TEXT+"]+"));if(n)e.push(this.evaluateCharacter(n.number)),r=r.substring(n.length);else if(t)e.push(this.evaluateCharacter(t[0])),r=r.substring(t[0].length);else{const t=Array.from(r),n=t[0];e.push(this.evaluateCharacter(n)),r=t.slice(1).join("")}}}return e}parse(t){super.parse(t),this.annotators=t.annotators||[]}addAlias_(t,e,n){const r=this.parsePrecondition(e,n),o=new Is(t.name,t.dynamicCstr,r,t.action);o.name=t.name,this.addRule(o)}matchNumber(t){const e=t.match(new RegExp("^"+gt.MESSAGES.regexp.NUMBER)),n=t.match(new RegExp("^"+ks.regexp.NUMBER));if(!e&&!n)return null;const r=n&&n[0]===t;if(e&&e[0]===t||!r)return e?{number:e[0],length:e[0].length}:null;return{number:n[0].replace(new RegExp(ks.regexp.DIGIT_GROUP,"g"),"X").replace(new RegExp(ks.regexp.DECIMAL_MARK,"g"),gt.MESSAGES.regexp.DECIMAL_MARK).replace(/X/g,gt.MESSAGES.regexp.DIGIT_GROUP.replace(/\\/g,"")),length:n[0].length}}}ks.regexp={NUMBER:"((\\d{1,3})(?=(,| ))((,| )\\d{3})*(\\.\\d+)?)|^\\d*\\.\\d+|^\\d+",DECIMAL_MARK:"\\.",DIGIT_GROUP:","};class Bs extends ks{constructor(){super(...arguments),this.modality="braille",this.customTranscriptions={"\u22ca":"\u2808\u2821\u2833"}}evaluateString(t){const e=[],n=Array.from(t);for(let t=0;t<n.length;t++)e.push(this.evaluateCharacter(n[t]));return e}annotations(){for(let t,e=0;t=this.annotators[e];e++)Ts(this.locale,t)}}class Gs extends Bs{constructor(){super(...arguments),this.locale="euro",this.customTranscriptions={},this.customCommands={"\\cdot":"*","\\lt":"<","\\gt":">"},this.lastSpecial=!1,this.specialChars=["^","_","{","}"]}evaluateString(t){const e=t.split(/(\\[a-z]+|\\{|\\}|\\\\)/i),n=this.cleanup(e);return super.evaluateString(n)}cleanup(t){const e=[];let n=!1,r=null;for(let o of t){if(o.match(/^\\/)){"\\text"===o&&(n=!0),this.addSpace(on.LatexCommands.get(o))&&e.push(" "),o=this.customCommands[o]||o;const t=o.match(/^\\/);t&&o.match(/^\\[a-zA-Z]+$/)&&r&&e.push(" "),r=t?o:null,e.push(o);continue}const t=o.split("");for(const o of t)n?(e.push(o),n="}"!==o,r=null):o.match(/[a-z]/i)&&r?(r=null,e.push(" "),e.push(o)):o.match(/\s/)||(this.addSpace(o)&&e.push(" "),e.push(o),r=null)}return e.join("")}addSpace(t){if(!t)return!1;if(-1!==this.specialChars.indexOf(t))return this.lastSpecial=!0,!1;if(this.lastSpecial)return this.lastSpecial=!1,!1;const e=on.Meaning.get(t);return e.type===nt.OPERATOR||e.type===nt.RELATION||e.type===nt.PUNCTUATION&&e.role===ot.COLON}}!function(t){t.ROOT="root",t.DYNAMIC="dynamic",t.QUERY="query",t.BOOLEAN="boolean",t.STATIC="static"}(bs||(bs={}));class Vs{constructor(t,e){this.constraint=t,this.test=e,this.children_={},this.kind=bs.ROOT}getConstraint(){return this.constraint}getKind(){return this.kind}applyTest(t){return this.test(t)}addChild(t){const e=t.getConstraint(),n=this.children_[e];return this.children_[e]=t,n}getChild(t){return this.children_[t]}getChildren(){const t=[];for(const e of Object.values(this.children_))t.push(e);return t}findChildren(t){const e=[];for(const n of Object.values(this.children_))n.applyTest(t)&&e.push(n);return e}removeChild(t){delete this.children_[t]}toString(){return this.constraint}}class Hs extends Vs{constructor(t,e){super(t,e),this.rule_=null,this.kind=bs.STATIC}getRule(){return this.rule_}setRule(t){this.rule_&&g.getInstance().output("Replacing rule "+this.rule_+" with "+t),this.rule_=t}toString(){return this.getRule()?this.constraint+"\n==> "+this.getRule().action:this.constraint}}function js(t,e,n){switch(t){case bs.ROOT:return new qs;case bs.DYNAMIC:return new $s(e);case bs.QUERY:return new Ws(e,n);case bs.BOOLEAN:return new Ks(e,n);default:return null}}class qs extends Vs{constructor(){super("",()=>!0),this.kind=bs.ROOT}}class $s extends Vs{constructor(t){super(t,e=>e===t),this.kind=bs.DYNAMIC}}const Ys={"=":(t,e)=>t===e,"!=":(t,e)=>t!==e,"<":(t,e)=>t<e,">":(t,e)=>t>e,"<=":(t,e)=>t<=e,">=":(t,e)=>t>=e};function Xs(t){if(t.match(/^self::\*$/))return t=>!0;if(t.match(/^self::\w+$/)){const e=t.slice(6).toUpperCase();return t=>t.tagName&&Y(t)===e}if(t.match(/^self::\w+:\w+$/)){const e=t.split(":"),n=y(e[2]);if(!n)return null;const r=e[3].toUpperCase();return t=>t.localName&&t.localName.toUpperCase()===r&&t.namespaceURI===n}if(t.match(/^@\w+$/)){const e=t.slice(1);return t=>t.hasAttribute&&t.hasAttribute(e)}if(t.match(/^@\w+="[\w\d ]+"$/)){const e=t.split("="),n=e[0].slice(1),r=e[1].slice(1,-1);return t=>t.hasAttribute&&t.hasAttribute(n)&&t.getAttribute(n)===r}if(t.match(/^@\w+!="[\w\d ]+"$/)){const e=t.split("!="),n=e[0].slice(1),r=e[1].slice(1,-1);return t=>!t.hasAttribute||!t.hasAttribute(n)||t.getAttribute(n)!==r}if(t.match(/^contains\(\s*@grammar\s*,\s*"[\w\d ]+"\s*\)$/)){const e=t.split('"')[1];return t=>!!bt.getInstance().getParameter(e)}if(t.match(/^not\(\s*contains\(\s*@grammar\s*,\s*"[\w\d ]+"\s*\)\s*\)$/)){const e=t.split('"')[1];return t=>!bt.getInstance().getParameter(e)}if(t.match(/^name\(\.\.\/\.\.\)="\w+"$/)){const e=t.split('"')[1].toUpperCase();return t=>{var n,r;return(null===(r=null===(n=t.parentNode)||void 0===n?void 0:n.parentNode)||void 0===r?void 0:r.tagName)&&Y(t.parentNode.parentNode)===e}}if(t.match(/^count\(preceding-sibling::\*\)=\d+$/)){const e=t.split("="),n=parseInt(e[1],10);return t=>{var e;return(null===(e=t.parentNode)||void 0===e?void 0:e.childNodes[n])===t}}if(t.match(/^.+\[@category!?=".+"\]$/)){let[,e,n,r]=t.match(/^(.+)\[@category(!?=)"(.+)"\]$/);const o=r.match(/^unit:(.+)$/);let i="";return o&&(r=o[1],i=":unit"),t=>{const o=M(e,t)[0];if(o){const t=wn(o.textContent+i);return"="===n?t===r:t!==r}return!1}}if(t.match(/^string-length\(.+\)\W+\d+/)){const[,e,n,r]=t.match(/^string-length\((.+)\)(\W+)(\d+)/),o=Ys[n]||Ys["="],i=parseInt(r,10);return t=>{const n=M(e,t)[0];return!!n&&o(Array.from(n.textContent).length,i)}}return null}class Ws extends Hs{constructor(t,e){super(t,Xs(t)),this.context=e,this.kind=bs.QUERY}applyTest(t){return this.test?this.test(t):this.context.applyQuery(t,this.constraint)===t}}class Ks extends Hs{constructor(t,e){super(t,Xs(t)),this.context=e,this.kind=bs.BOOLEAN}applyTest(t){return this.test?this.test(t):this.context.applyConstraint(t,this.constraint)}}class zs{static collectRules_(t){const e=[];let n=[t];for(;n.length;){const t=n.shift();if(t.getKind()===bs.QUERY||t.getKind()===bs.BOOLEAN){const n=t.getRule();n&&e.unshift(n)}n=n.concat(t.getChildren())}return e}static printWithDepth_(t,e,n){n+=new Array(e+2).join(e.toString())+": "+t.toString()+"\n";const r=t.getChildren();for(let t,o=0;t=r[o];o++)n=zs.printWithDepth_(t,e+1,n);return n}static order_(t){const e=t.getChildren();if(!e.length)return 0;const n=Math.max.apply(null,e.map(zs.order_));return Math.max(e.length,n)}constructor(){this.root=js(bs.ROOT,"",null)}addRule(t){let e=this.root;const n=t.context,r=t.dynamicCstr.getValues();for(let t=0,o=r.length;t<o;t++)e=this.addNode_(e,r[t],bs.DYNAMIC,n);e=this.addNode_(e,t.precondition.query,bs.QUERY,n);const o=t.precondition.constraints;for(let t=0,r=o.length;t<r;t++)e=this.addNode_(e,o[t],bs.BOOLEAN,n);e.setRule(t)}lookupRules(t,e){let n=[this.root];const r=[];for(;e.length;){const t=e.shift(),r=[];for(;n.length;){n.shift().getChildren().forEach(e=>{e.getKind()===bs.DYNAMIC&&-1===t.indexOf(e.getConstraint())||r.push(e)})}n=r.slice()}for(;n.length;){const e=n.shift();if(e.getRule){const t=e.getRule();t&&r.push(t)}const o=e.findChildren(t);n=n.concat(o)}return r}hasSubtrie(t){let e=this.root;for(let n=0,r=t.length;n<r;n++){const r=t[n];if(e=e.getChild(r),!e)return!1}return!0}toString(){return zs.printWithDepth_(this.root,0,"")}collectRules(t=this.root){return zs.collectRules_(t)}order(){return zs.order_(this.root)}enumerate(t){return this.enumerate_(this.root,t)}byConstraint(t){let e=this.root;for(;t.length&&e;){const n=t.shift();e=e.getChild(n)}return e||null}enumerate_(t,e){e=e||{};const n=t.getChildren();for(let t,r=0;t=n[r];r++)t.kind===bs.DYNAMIC&&(e[t.getConstraint()]=this.enumerate_(t,e[t.getConstraint()]));return e}addNode_(t,e,n,r){let o=t.getChild(e);return o||(o=js(n,e,r),t.addChild(o)),o}}var Qs;!function(t){t[t.ENTER=13]="ENTER",t[t.ESC=27]="ESC",t[t.SPACE=32]="SPACE",t[t.PAGE_UP=33]="PAGE_UP",t[t.PAGE_DOWN=34]="PAGE_DOWN",t[t.END=35]="END",t[t.HOME=36]="HOME",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.TAB=9]="TAB",t[t.LESS=188]="LESS",t[t.GREATER=190]="GREATER",t[t.DASH=189]="DASH",t[t.ZERO=48]="ZERO",t[t.ONE=49]="ONE",t[t.TWO=50]="TWO",t[t.THREE=51]="THREE",t[t.FOUR=52]="FOUR",t[t.FIVE=53]="FIVE",t[t.SIX=54]="SIX",t[t.SEVEN=55]="SEVEN",t[t.EIGHT=56]="EIGHT",t[t.NINE=57]="NINE",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z"}(Qs||(Qs={}));const Js=new Map([[13,"ENTER"],[27,"ESC"],[32,"SPACE"],[33,"PAGE_UP"],[34,"PAGE_DOWN"],[35,"END"],[36,"HOME"],[37,"LEFT"],[38,"UP"],[39,"RIGHT"],[40,"DOWN"],[9,"TAB"],[188,"LESS"],[190,"GREATER"],[189,"DASH"],[48,"ZERO"],[49,"ONE"],[50,"TWO"],[51,"THREE"],[52,"FOUR"],[53,"FIVE"],[54,"SIX"],[55,"SEVEN"],[56,"EIGHT"],[57,"NINE"],[65,"A"],[66,"B"],[67,"C"],[68,"D"],[69,"E"],[70,"F"],[71,"G"],[72,"H"],[73,"I"],[74,"J"],[75,"K"],[76,"L"],[77,"M"],[78,"N"],[79,"O"],[80,"P"],[81,"Q"],[82,"R"],[83,"S"],[84,"T"],[85,"U"],[86,"V"],[87,"W"],[88,"X"],[89,"Y"],[90,"Z"]]);var Zs;!function(t){t.CLICK="click",t.DBLCLICK="dblclick",t.MOUSEDOWN="mousedown",t.MOUSEUP="mouseup",t.MOUSEOVER="mouseover",t.MOUSEOUT="mouseout",t.MOUSEMOVE="mousemove",t.SELECTSTART="selectstart",t.KEYPRESS="keypress",t.KEYDOWN="keydown",t.KEYUP="keyup",t.TOUCHSTART="touchstart",t.TOUCHMOVE="touchmove",t.TOUCHEND="touchend",t.TOUCHCANCEL="touchcancel"}(Zs||(Zs={}));function ta(t,e,n){return t?{pause:ea(t.pause,e.pause,n)}:e}function ea(t,e,n){return(n||function(n,r){return"number"==typeof n&&"number"==typeof r?n+r:"number"==typeof n?r:"number"==typeof r?n:[t,e].sort()[0]}).call(null,t,e)}function na(t,e){delete t.open,e.close.forEach(e=>delete t[e]),e.open.forEach(n=>t[n]=e[n]);const n=Object.keys(t);t.open=n}function ra(t,e){if(t.length<=1)return t;const n=[];for(let r,o=0;r=e[o],t.length;o++)r.close&&r.close.length&&r.close.forEach(function(e){const r=t.indexOf(e);-1!==r&&(n.unshift(e),t.splice(r,1))});return n}let oa={},ia=[];function sa(t){t=t.map(t=>t.clone()),oa={},ia=[];let e=[];const n={};for(let o,i=0;o=t[i];i++){let t=null;const i=o.descriptionSpan(),s=o.personality,a=s[r.JOIN];delete s[r.JOIN],void 0!==s[r.PAUSE]&&(t={[r.PAUSE]:s[r.PAUSE]},delete s[r.PAUSE]);da(e,i,pa(s,n),a,t,!0)}return e=e.concat(function(){const t=[];for(let e=ia.length-1;e>=0;e--){const n=ia[e];if(n.length){const e={open:[],close:[]};for(let t=0;t<n.length;t++){const r=n[t];e.close.push(r),e[r]=0}t.push(e)}}return t}()),e=function(t){const e={},n=[];for(let r,o=0;r=t[o];o++){if(!la(r)){aa(n,r);continue}if(!r.close||1!==r.close.length||r.open.length){ca(r,e),n.push(r);continue}let i=t[o+1];if(!i||ha(i)){ca(r,e),n.push(r);continue}const s=ua(i)?i:null;s&&(i=t[o+2]),i&&la(i)&&i.open[0]===r.close[0]&&!i.close.length&&i[i.open[0]]===e[i.open[0]]?s?(aa(n,s),o+=2):o+=1:(ca(r,e),n.push(r))}return n}(e),e=A.getInstance().options.cleanpause?function(t){for(;ua(t[0]);)t.shift();for(;ua(t[t.length-1]);)t.pop();return t}(e):e,e}function aa(t,e){const n=t[t.length-1];if(n){if(ha(e)&&ha(n)){if(void 0===n.join)return void(n.span=n.span.concat(e.span));const t=n.span.pop(),r=e.span.shift();return n.span.push(t+n.join+r),n.span=n.span.concat(e.span),void(n.join=e.join)}ua(e)&&ua(n)?n.pause=ea(n.pause,e.pause):t.push(e)}else t.push(e)}function ca(t,e){t.rate&&(e.rate=t.rate),t.pitch&&(e.pitch=t.pitch),t.volume&&(e.volume=t.volume)}function la(t){return"object"==typeof t&&t.open}function ua(t){return"object"==typeof t&&1===Object.keys(t).length&&Object.keys(t)[0]===r.PAUSE}function ha(t){const e=Object.keys(t);return"object"==typeof t&&(1===e.length&&"span"===e[0]||2===e.length&&("span"===e[0]&&"join"===e[1]||"span"===e[1]&&"join"===e[0]))}function da(t,e,n,o,i,s=!1){if(s){const s=t[t.length-1];let a;if(s&&(a=s[r.JOIN]),s&&!e.speech&&i&&ua(s)){const t=r.PAUSE;s[t]=ea(s[t],i[t]),i=null}if(s&&e.speech&&0===Object.keys(n).length&&ha(s)){if(void 0!==a){const t=s.span.pop();e=xn.stringAttr(t.speech+a+e.speech,t.attributes)}s.span.push(e),e=xn.empty(),s[r.JOIN]=o}}0!==Object.keys(n).length&&t.push(n),e.speech&&t.push({span:[e],join:o}),i&&t.push(i)}function pa(t,e){if(!e)return t;const n={};for(const r of l){const o=t[r],i=e[r];if(!o&&!i||o&&i&&o===i)continue;const s=o||0;la(n)||(n.open=[],n.close=[]),o||n.close.push(r),i||n.open.push(r),i&&o&&(n.close.push(r),n.open.push(r)),e[r]=s,n[r]=s,oa[r]?oa[r].push(s):oa[r]=[s]}if(la(n)){let t=n.close.slice();for(;t.length>0;){let r=ia.pop();const o=sr(r,t);if(t=sr(t,r),r=o,0!==t.length){if(0!==r.length){n.close=n.close.concat(r),n.open=n.open.concat(r);for(let t,o=0;t=r[o];o++)n[t]=e[t]}}else 0!==r.length&&ia.push(r)}ia.push(n.open)}return n}class fa{constructor(){this.separator_=" "}set separator(t){this.separator_=t}get separator(){return"braille"===A.getInstance().options.modality?"":this.separator_}error(t){return null}merge(t){let e="";const n=t.length-1;for(let r,o=0;r=t[o];o++)if(e+=r.speech,o<n){const t=r.attributes.separator;e+=void 0!==t?t:this.separator}return e}finalize(t){return t}pauseValue(t){let e;switch(t){case"long":e=750;break;case"medium":e=500;break;case"short":e=250;break;default:e=parseInt(t,10)}return Math.floor(e*A.getInstance().getRate()/100)}}class ma extends fa{constructor(){super(...arguments),this.ignoreElements=[r.LAYOUT],this.scaleFunction=null}setScaleFunction(t,e,n,r,o=0){this.scaleFunction=i=>{const s=(i-t)/(e-t),a=n*(1-s)+r*s;return+(Math.round(a+"e+"+o)+"e-"+o)}}applyScaleFunction(t){return this.scaleFunction?this.scaleFunction(t):t}ignoreElement(t){return-1!==this.ignoreElements.indexOf(t)}}class ga extends ma{markup(t){this.setScaleFunction(-2,2,-100,100,2);const e=sa(t),n=[],r=[];for(let t,o=0;t=e[o];o++)if(t.span)n.push(this.merge(t.span));else if(ua(t))n.push(this.pause(t));else{if(t.close.length)for(let e=0;e<t.close.length;e++){const e=r.pop();if(-1===t.close.indexOf(e))throw new I("Unknown closing markup element: "+e);n.push(this.closeTag(e))}if(t.open.length){ra(t.open.slice(),e.slice(o+1)).forEach(e=>{n.push(this.prosodyElement(e,t[e])),r.push(e)})}}return n.join(" ")}}class Ea extends ga{constructor(){super(...arguments),this.values=new Map}finalize(t){return function(t){if(Ia.clear(),!t)return;const e=Object.keys(t).map(t=>parseInt(t)).sort();for(let t,n=0;t=e[n];n++)Ia.set(t,n+1)}(this.values.get("rel")),function(t){Na="";const e=w(`<all>${t}</all>`);return g.getInstance().generate(()=>[V(e.toString())]),Na=ba(e),Na}(t)}pause(t){return""}prosodyElement(t,e){return t===r.LAYOUT?`<${e}>`:""}closeTag(t){return`</${t}>`}markup(t){this.values.clear();const e=[];let n=[];for(const r of t){if(!r.layout){n.push(r);continue}e.push(this.processContent(n)),n=[];const[t,o,i]=this.layoutValue(r.layout);"begin"!==t?"end"!==t?console.warn("Something went wrong with layout markup: "+o):e.push("</"+o+">"):e.push("<"+o+(i?` value="${i}"`:"")+">")}return e.push(this.processContent(n)),e.join("")}processContent(t){const e=[],n=sa(t);for(let t,r=0;t=n[r];r++)t.span?e.push(this.merge(t.span)):ua(t);return e.join("")}layoutValue(t){const e=t.match(/^(begin|end|)(.*\D)(\d*)$/),n=e[3];return n?(t=e[2],this.values.has(t)||this.values.set(t,{}),this.values.get(t)[n]=!0,[e[1],t,n]):[e[1],e[2],""]}}Ea.options={cayleyshort:A.getInstance().options.cayleyshort,linebreaks:A.getInstance().options.linebreaks};let Na="";const Sa={TABLE:function(t){let e=Ca(t);e.forEach(t=>{t.cells=t.cells.slice(1).slice(0,-1),t.width=t.width.slice(1).slice(0,-1)});const[n,r]=La(e);return e=Ma(e,r),_a(e,n)},CASES:function(t){let e=Ca(t);e.forEach(t=>{t.cells=t.cells.slice(0,-1),t.width=t.width.slice(0,-1)});const[n,r]=La(e);return e=Ma(e,r),_a(e,n)},CAYLEY:function(t){let e=Ca(t);e.forEach(t=>{t.cells=t.cells.slice(1).slice(0,-1),t.width=t.width.slice(1).slice(0,-1),t.sep=t.sep+t.sep});const[n,r]=La(e),o={lfence:"",rfence:"",cells:r.map(t=>"\u2810"+new Array(t).join("\u2812")),width:r,height:1,sep:e[0].sep};A.getInstance().options.cayleyshort&&"\u2800"===e[0].cells[0]&&(o.cells[0]="\u2800");return e.splice(1,0,o),e=Ma(e,r),_a(e,n)},MATRIX:function(t){let e=Ca(t);const[n,r]=La(e);return e=Ma(e,r),_a(e,n)},CELL:ba,FENCE:ba,ROW:ba,FRACTION:function(t){const[e,n,,r,o]=Array.from(t.childNodes),i=Ta(n),s=Ta(r),a=Oa(i),c=Oa(s);let l=Math.max(a,c);const u=e+new Array(l+1).join("\u2812")+o;return l=u.length,`${Pa(i,l)}\n${u}\n${Pa(s,l)}`},NUMERATOR:xa,DENOMINATOR:xa,REL:Ua,OP:Ua};function Ta(t){const e=Y(t),n=Sa[e];return n?n(t):t.textContent}const Ia=new Map;function Aa(t,e){if(!t||!e)return t+e;const n=Ra(t),r=Ra(e),o=n-r;t=o<0?ya(t,r,Oa(t)):t,e=o>0?ya(e,n,Oa(e)):e;const i=t.split(/\r\n|\r|\n/),s=e.split(/\r\n|\r|\n/),a=[];for(let t=0;t<i.length;t++)a.push(i[t]+s[t]);return a.join("\n")}function ba(t){let e="";for(const n of Array.from(t.childNodes))e=n.nodeType!==D.TEXT_NODE?Aa(e,Ta(n)):Aa(e,n.textContent);return e}function Ra(t){return t.split(/\r\n|\r|\n/).length}function Oa(t){return t.split(/\r\n|\r|\n/).reduce((t,e)=>Math.max(e.length,t),0)}function ya(t,e,n){return t=function(t,e){const n=e-Ra(t);return t+(n>0?new Array(n+1).join("\n"):"")}(t,e),function(t,e){const n=t.split(/\r\n|\r|\n/),r=[];for(const t of n){const n=e-t.length;r.push(t+(n>0?new Array(n+1).join("\u2800"):""))}return r.join("\n")}(t,n)}function Ca(t){const e=Array.from(t.childNodes),n=[];for(const t of e)t.nodeType===D.ELEMENT_NODE&&n.push(Da(t));return n}function La(t){const e=t.reduce((t,e)=>Math.max(e.height,t),0),n=[];for(let e=0;e<t[0].width.length;e++)n.push(t.map(t=>t.width[e]).reduce((t,e)=>Math.max(t,e),0));return[e,n]}function Ma(t,e){const n=[];for(const r of t){if(0===r.height)continue;const t=[];for(let n=0;n<r.cells.length;n++)t.push(ya(r.cells[n],r.height,e[n]));r.cells=t,n.push(r)}return n}function _a(t,e){if(1===e)return t.map(t=>t.lfence+t.cells.join(t.sep)+t.rfence).join("\n");const n=[];for(const e of t){const t=va(e.sep,e.height);let r=e.cells.shift();for(;e.cells.length;)r=Aa(r,t),r=Aa(r,e.cells.shift());r=Aa(va(e.lfence,e.height),r),r=Aa(r,va(e.rfence,e.height)),n.push(r),n.push(e.lfence+new Array(Oa(r)-3).join(e.sep)+e.rfence)}return n.slice(0,-1).join("\n")}function va(t,e){let n="";for(;e;)n+=t+"\n",e--;return n.slice(0,-1)}function wa(t){return t.nodeType===D.ELEMENT_NODE&&"FENCE"===Y(t)?Ta(t):""}function Da(t){const e=Array.from(t.childNodes),n=wa(e[0]),r=wa(e[e.length-1]);n&&e.shift(),r&&e.pop();let o="";const i=[];for(const t of e){if(t.nodeType===D.TEXT_NODE){o=t.textContent;continue}const e=Ta(t);i.push(e)}return{lfence:n,rfence:r,sep:o,cells:i,height:i.reduce((t,e)=>Math.max(Ra(e),t),0),width:i.map(Oa)}}function Pa(t,e){const n=(e-Oa(t))/2,[r,o]=Math.floor(n)===n?[n,n]:[Math.floor(n),Math.ceil(n)],i=t.split(/\r\n|\r|\n/),s=[],[a,c]=[new Array(r+1).join("\u2800"),new Array(o+1).join("\u2800")];for(const t of i)s.push(a+t+c);return s.join("\n")}function xa(t){const e=t.firstChild,n=ba(t);if(e&&e.nodeType===D.ELEMENT_NODE){if("ENGLISH"===Y(e))return"\u2830"+n;if("NUMBER"===Y(e))return"\u283c"+n}return n}function Ua(t){if(!A.getInstance().options.linebreaks)return ba(t);const e=Ia.get(parseInt(t.getAttribute("value")));return(e?`<br value="${e}"/>`:"")+ba(t)}class Fa extends fa{markup(t){const e=sa(t);let n="",o=null,i=!1;for(let t,s=0;t=e[s];s++)la(t)||(ua(t)?o=t:(o&&(n+=this.pause(o[r.PAUSE]),o=null),n+=(i?this.separator:"")+this.merge(t.span),i=!0));return n}pause(t){let e;return e="number"==typeof t?t<=250?"short":t<=500?"medium":"long":t,Fa.PAUSE_PUNCTUATION.get(e)||""}}Fa.PAUSE_PUNCTUATION=new Map([["short",","],["medium",";"],["long","."]]);class ka extends ga{finalize(t){return`<?xml version="1.0"?><speak version="1.1" xmlns="http://www.w3.org/2001/10/synthesis" xml:lang="${A.getInstance().options.locale}"><prosody rate="`+A.getInstance().getRate()+'%">'+this.separator+t+this.separator+"</prosody></speak>"}pause(t){return'<break time="'+this.pauseValue(t[r.PAUSE])+'ms"/>'}prosodyElement(t,e){const n=(e=Math.floor(this.applyScaleFunction(e)))<0?e.toString():"+"+e.toString();return"<prosody "+t.toLowerCase()+'="'+n+(t===r.VOLUME?">":'%">')}closeTag(t){return"</prosody>"}markup(t){return ka.MARKS={},super.markup(t)}merge(t){const e=[];let n="";for(let r=0;r<t.length;r++){const o=t[r];if(this.isEmptySpan(o))continue;const i=ka.MARK_KIND?o.attributes.kind:"",s=A.getInstance().options.automark?o.attributes.id:A.getInstance().options.mark?o.attributes.extid:"";!s||s===n||ka.MARK_ONCE&&ka.MARKS[s]||(e.push(i?`<mark name="${s}" kind="${i}"/>`:`<mark name="${s}"/>`),n=s,ka.MARKS[s]=!0),A.getInstance().options.character&&1===o.speech.length&&o.speech.match(/[a-zA-Z]/)?e.push('<say-as interpret-as="'+ka.CHARACTER_ATTR+'">'+o.speech+"</say-as>"):e.push(o.speech)}return e.join(this.separator)}isEmptySpan(t){const e=t.attributes.separator;return t.speech.match(/^\s*$/)&&(!e||e.match(/^\s*$/))}}ka.MARK_ONCE=!1,ka.MARK_KIND=!0,ka.CHARACTER_ATTR="character",ka.MARKS={};class Ba extends fa{markup(t){let e="";const n=sa(t).filter(t=>t.span);if(!n.length)return e;const r=n.length-1;for(let t,o=0;t=n[o];o++){if(t.span&&(e+=this.merge(t.span)),o>=r)continue;const n=t.join;e+=void 0===n?this.separator:n}return e}}const Ga=new ka,Va=new Map([[h.NONE,new Ba],[h.COUNTING,new class extends Ba{finalize(t){const e=super.finalize(t),n="braille"===A.getInstance().options.modality?"\u28ff\u2800\u28ff\u2800\u28ff\u2800\u28ff\u2800\u28ff\u2800":"0123456789";let r=new Array(Math.trunc(e.length/10)+1).join(n);return r+=n.slice(0,e.length%10),e+"\n"+r}}],[h.PUNCTUATION,new Fa],[h.LAYOUT,new Ea],[h.ACSS,new class extends ma{markup(t){this.setScaleFunction(-2,2,0,10,0);const e=sa(t),n=[],r={open:[]};let o=null,i=!1;for(let t,s=0;t=e[s];s++){if(la(t)){na(r,t);continue}if(ua(t)){i&&(o=ta(o,t,Math.max));continue}const e='"'+this.merge(t.span)+'"';i=!0,o&&(n.push(this.pause(o)),o=null);const s=this.prosody_(r);n.push(s?"(text ("+s+") "+e+")":e)}return"(exp "+n.join(" ")+")"}error(t){return'(error "'+Js.get(t)+'")'}prosodyElement(t,e){switch(e=this.applyScaleFunction(e),t){case r.RATE:return"(richness . "+e+")";case r.PITCH:return"(average-pitch . "+e+")";case r.VOLUME:return"(stress . "+e+")"}return"(value . "+e+")"}pause(t){return"(pause . "+this.pauseValue(t[r.PAUSE])+")"}prosody_(t){const e=t.open,n=[];for(let r,o=0;r=e[o];o++)n.push(this.prosodyElement(r,t[r]));return n.join(" ")}}],[h.SABLE,new class extends ga{finalize(t){return'<?xml version="1.0"?><!DOCTYPE SABLE PUBLIC "-//SABLE//DTD SABLE speech mark up//EN" "Sable.v0_2.dtd" []><SABLE>'+this.separator+t+this.separator+"</SABLE>"}pause(t){return'<BREAK MSEC="'+this.pauseValue(t[r.PAUSE])+'"/>'}prosodyElement(t,e){switch(e=this.applyScaleFunction(e),t){case r.PITCH:return'<PITCH RANGE="'+e+'%">';case r.RATE:return'<RATE SPEED="'+e+'%">';case r.VOLUME:return'<VOLUME LEVEL="'+e+'%">';default:return"<"+t.toUpperCase()+' VALUE="'+e+'">'}}closeTag(t){return"</"+t.toUpperCase()+">"}}],[h.VOICEXML,Ga],[h.SSML,Ga]]);function Ha(t){const e=Va.get(A.getInstance().options.markup);return e?e.markup(t):""}function ja(t){const e=Va.get(A.getInstance().options.markup);return e?e.finalize(t):t}class qa{getSpeechMap(t){let e=this.speechMaps.get(t);return e||(e=new Map,this.speechMaps.set(t,e)),e}setMap(t,e,n){this.getSpeechMap(e).set(t,n.map(t=>t.clone()))}constructor(t){this.node=t,this.speechMaps=new Map,this.nodeMap=null}addNode(t,e,n="speech"){t.nodeType===D.ELEMENT_NODE&&t.hasAttribute("id")&&this.setMap(n,t.getAttribute("id"),e)}get(t){return this.speechMaps.get(t)}getNodeMap(){if(this.nodeMap)return this.nodeMap;this.nodeMap=new Map;for(const t of j(this.node,"id")){const e=t.getAttribute("id");if(!this.nodeMap.has(e)){this.nodeMap.set(t.getAttribute("id"),t);continue}const n=t.parentNode.tagName;"children"!==n&&"stree"!==n||this.nodeMap.set(e,t)}return this.nodeMap}completeModality(t,e){const n=A.getInstance().options.modality;A.getInstance().options.modality=t;for(const[n,r]of this.getNodeMap()){this.getSpeechMap(n).has(t)||e(r)}A.getInstance().options.modality=n}json(t=["none"]){const e={},n=A.getInstance().options.markup;for(const[n,r]of this.speechMaps){const o={};for(const i of t)A.getInstance().options.markup=i,r.forEach((t,e)=>o[`${e}-${i}`]=Ha(t)),e[n]=o}return A.getInstance().options.markup=n,e}}class $a{static getInstance(){return $a.instance=$a.instance||new $a,$a.instance}static debugSpeechRule(t,e){const n=t.precondition,r=t.context.applyQuery(e,n.query);g.getInstance().output(n.query,r?r.toString():r),n.constraints.forEach(n=>g.getInstance().output(n,t.context.applyConstraint(e,n)))}static debugNamedSpeechRule(t,e){const n=$a.getInstance().trie.collectRules().filter(e=>e.name==t);for(let r,o=0;r=n[o];o++)g.getInstance().output("Rule",t,"DynamicCstr:",r.dynamicCstr.toString(),"number",o),$a.debugSpeechRule(r,e)}evaluateNode(t,e=!1){_(t),this.speechStructure&&!e||(this.speechStructure=new qa(t));const n=(new Date).getTime();let r=[];try{r=this.evaluateNode_(t)}catch(t){console.error("Something went wrong computing speech."),g.getInstance().output(t)}const o=(new Date).getTime();return g.getInstance().output("Time:",o-n),r}toString(){return this.trie.collectRules().map(t=>t.toString()).join("\n")}runInSetting(t,e){var n,r;const o=A.getInstance(),i=o.options,s=new N;for(const e of N.BINARY_FEATURES)s[e]=null!==(n=t[e])&&void 0!==n?n:i[e];for(const e of N.STRING_FEATURES)s[e]=null!==(r=t[e])&&void 0!==r?r:i[e];o.options=s,o.setDynamicCstr();const a=e();return o.options=i,o.setDynamicCstr(),a}static addStore(t){const n=function(t){const n=`${t.locale}.${t.modality}.${t.domain}`;if("actions"===t.kind){const e=Ya.get(n);return e.parse(t),e}fs(),t&&!t.functions&&(t.functions=function(t,n,r){return Bn.get([t,n,r].join("."))||Bn.get([s.DEFAULT_VALUES[e.LOCALE],n,r].join("."))||Bn.get([s.BASE_LOCALE,n,r].join("."))||{}}(t.locale,t.modality,t.domain));const r=function(t,e){if("braille"===e&&"euro"===t)return new Gs;if("braille"===e)return new Bs;return new ks}(t.locale,t.modality);Ya.set(n,r),t.inherits&&(r.inherits=Ya.get(`${t.inherits}.${t.modality}.${t.domain}`));return r.parse(t),r.initialize(),r}(t);"abstract"!==n.kind&&n.getSpeechRules().forEach(t=>$a.getInstance().trie.addRule(t)),$a.getInstance().addEvaluator(n)}processGrammar(t,e,n){const r={};for(const[o,i]of Object.entries(n))r[o]="string"==typeof i?t.constructString(e,i):i;bt.getInstance().pushState(r)}addEvaluator(t){const e=t.evaluateDefault.bind(t),n=this.evaluators_[t.locale];if(n)return void(n[t.modality]=e);const r={};r[t.modality]=e,this.evaluators_[t.locale]=r}getEvaluator(t,n){const r=this.evaluators_[t]||this.evaluators_[s.DEFAULT_VALUES[e.LOCALE]];return r[n]||r[s.DEFAULT_VALUES[e.MODALITY]]}enumerate(t){return this.trie.enumerate(t)}constructor(){this.trie=null,this.evaluators_={},this.speechStructure=null,this.trie=new zs}evaluateNode_(t){if(!t)return[];this.updateConstraint_();let e=this.evaluateTree_(t);return e=function(t){const e=new Fn(t);for(const t of e.annotations){const n=t.data;if("punctuation"===n.annotation){const r=e.prevText(t);if(!r)continue;const o=r.data;"punctuation"!==o.annotation&&"\u2800"!==o.text&&1===n.text.length&&-1!==Xa.indexOf(n.text)&&(n.text="\u2838"+n.text)}}return e.toList()}(e),e}evaluateTree_(t){const e=this.evaluateTreeInternal_(t);return this.speechStructure.addNode(t,e,A.getInstance().options.modality),e}evaluateTreeInternal_(t){const e=A.getInstance();let r;g.getInstance().generate(()=>[t.toString()]),bt.getInstance().setAttribute(t);const o=this.lookupRule(t,e.dynamicCstr);if(!o)return e.options.strict?[]:(r=this.getEvaluator(e.options.locale,e.options.modality)(t),t.attributes&&this.addPersonality_(r,{},!1,t),r);g.getInstance().generate(()=>["Apply Rule:",o.name,o.dynamicCstr.toString(),e.mode===n.HTTP?W(t):t.toString()]),bt.getInstance().processSingles();const i=o.context,s=o.action.components;r=[];for(let e,n=0;e=s[n];n++){let n=[];const o=e.content||"",s=e.attributes||{};let a=!1;e.grammar&&this.processGrammar(i,t,e.grammar);let c=null;if(s.engine){c=A.getInstance().dynamicCstr.getComponents();const t=Object.assign({},c,bt.parseInput(s.engine));A.getInstance().setDynamicCstr(t),this.updateConstraint_()}switch(e.type){case As.NODE:{const e=i.applyQuery(t,o);e&&(n=this.evaluateTree_(e))}break;case As.MULTI:{a=!0;const e=i.applySelector(t,o);e.length>0&&(n=this.evaluateNodeList_(i,e,s.sepFunc,i.constructString(t,s.separator),s.ctxtFunc,i.constructString(t,s.context)))}break;case As.TEXT:{const e=s.span;let r={};if(e){const n=M(e,t);r=n.length?xn.getAttributes(n[0]):{kind:e}}n=i.constructSpan(t,o,r).map(function(t){return kn.create({text:t.speech,attributes:t.attributes},{adjust:!0})})}break;case As.PERSONALITY:default:n=[kn.create({text:o})]}n[0]&&!a&&(s.context&&(n[0].context=i.constructString(t,s.context)+(n[0].context||"")),s.annotation&&(n[0].annotation=s.annotation)),this.addLayout(n,s,a),e.grammar&&bt.getInstance().popState(),r=r.concat(this.addPersonality_(n,s,a,t)),c&&(A.getInstance().setDynamicCstr(c),this.updateConstraint_())}return bt.getInstance().popState(),r}evaluateNodeList_(t,e,n,r,o,i){if(!e.length)return[];const s=r||"",a=i||"",c=t.contextFunctions.lookup(o),l=c?c(e,a):function(){return a},u=t.contextFunctions.lookup(n),h=u?u(e,s):function(){return[kn.create({text:s},{translate:!0})]};let d=[];for(let t,n=0;t=e[n];n++){const r=this.evaluateTree_(t);if(r.length>0&&(r[0].context=l()+(r[0].context||""),d=d.concat(r)),n<e.length-1){const t=h();d=d.concat(t)}}return d}addLayout(t,e,n){const r=e.layout;r&&(r.match(/^begin/)?t.unshift(new kn({text:"",layout:r})):r.match(/^end/)?t.push(new kn({text:"",layout:r})):(t.unshift(new kn({text:"",layout:`begin${r}`})),t.push(new kn({text:"",layout:`end${r}`}))))}addPersonality_(t,e,n,o){const i={};let s=null;for(const t of l){const n=e[t];if(void 0===n)continue;const o=parseFloat(n),a=isNaN(o)?'"'===n.charAt(0)?n.slice(1,-1):n:o;t===r.PAUSE?s=a:i[t]=a}for(let e,n=0;e=t[n];n++)this.addRelativePersonality_(e,i),this.addExternalAttributes_(e,o);if(n&&t.length&&delete t[t.length-1].personality[r.JOIN],s&&t.length){const e=t[t.length-1];e.text||Object.keys(e.personality).length?t.push(kn.create({text:"",personality:{pause:s}})):e.personality[r.PAUSE]=s}return t}addExternalAttributes_(t,e){var n;if(void 0===t.attributes.id&&(t.attributes.id=e.getAttribute("id")),null===(n=e.attributes)||void 0===n?void 0:n.length){const n=e.attributes;for(let e=n.length-1;e>=0;e--){const r=n[e].name;!t.attributes[r]&&r.match(/^ext/)&&(t.attributes[r]=n[e].value)}}}addRelativePersonality_(t,e){if(!t.personality)return t.personality=e,t;const n=t.personality;for(const[t,r]of Object.entries(e))n[t]&&"number"==typeof n[t]&&"number"==typeof r?n[t]=(n[t]+r).toString():n[t]||(n[t]=r);return t}updateConstraint_(){const t=A.getInstance().dynamicCstr,n=this.trie,r={};let o=t.getValue(e.LOCALE),i=t.getValue(e.MODALITY),a=t.getValue(e.DOMAIN);n.hasSubtrie([o,i,a])||(a=s.DEFAULT_VALUES[e.DOMAIN],n.hasSubtrie([o,i,a])||(i=s.DEFAULT_VALUES[e.MODALITY],n.hasSubtrie([o,i,a])||(o=s.DEFAULT_VALUES[e.LOCALE]))),r[e.LOCALE]=[o],r[e.MODALITY]=["summary"!==i?i:s.DEFAULT_VALUES[e.MODALITY]],r[e.DOMAIN]=["speech"!==i?s.DEFAULT_VALUES[e.DOMAIN]:a];const c=t.getOrder();for(let e,n=0;e=c[n];n++)if(!r[e]){const n=t.getValue(e),o=this.makeSet_(n,t.preference),i=s.DEFAULT_VALUES[e];n!==i&&o.push(i),r[e]=o}t.updateProperties(r)}makeSet_(t,e){return e&&Object.keys(e).length?t.split(":"):[t]}lookupRule(t,e){if(!t||t.nodeType!==D.ELEMENT_NODE&&t.nodeType!==D.TEXT_NODE)return null;const n=this.lookupRules(t,e);return n.length>0?this.pickMostConstraint_(e,n):null}lookupRules(t,e){return this.trie.lookupRules(t,e.allProperties())}pickMostConstraint_(t,e){const n=A.getInstance().comparator;return e.sort(function(t,e){return n.compare(t.dynamicCstr,e.dynamicCstr)||e.precondition.priority-t.precondition.priority||e.precondition.constraints.length-t.precondition.constraints.length||e.precondition.rank-t.precondition.rank}),g.getInstance().generate((()=>["Applicable Rules:",...e.map(t=>t.name+"("+t.dynamicCstr.toString()+")")]).bind(this)),e[0]}}const Ya=new Map;A.nodeEvaluator=$a.getInstance().evaluateNode.bind($a.getInstance());const Xa=["\u2806","\u2812","\u2832","\u2826","\u2834","\u2804"];const Wa={small:["default"],capital:["default"],digit:["default"]};function Ka(t){const e=A.getInstance().options.locale;A.getInstance().options.locale=t,Ze(),Tn({locale:t}),function(){const t=gt.ALPHABETS,e=(t,e)=>{const n={};return Object.keys(t).forEach(t=>n[t]=!0),Object.keys(e).forEach(t=>n[t]=!0),Object.keys(n)};Wa.small=e(t.smallPrefix,t.letterTrans),Wa.capital=e(t.capPrefix,t.letterTrans),Wa.digit=e(t.digitPrefix,t.digitTrans)}();for(const t of Z.values()){const e=t.unicode;if("offset"in t)Ja(e,t.font,t.offset||0);else{Qa(e,gt.ALPHABETS[t.base],t.font,!!t.capital)}}A.getInstance().options.locale=e,Ze()}function za(t){return function(t){return"string"==typeof t?{font:t,combiner:gt.ALPHABETS.combiner}:{font:t[0],combiner:gt.COMBINERS[t[1]]||dt[t[1]]||gt.ALPHABETS.combiner}}("normal"===t||"fullwidth"===t?"":gt.MESSAGES.font[t]||gt.MESSAGES.embellish[t]||"")}function Qa(t,e,n,r){const o=za(n);for(let n,i,s=0;n=t[s],i=e[s];s++){const t=r?gt.ALPHABETS.capPrefix:gt.ALPHABETS.smallPrefix,e=r?Wa.capital:Wa.small;Za(o.combiner,n,i,o.font,t,gt.ALPHABETS.letterTrans,e)}}function Ja(t,e,n){const r=za(e);for(let e,o=0;e=t[o];o++){const t=gt.ALPHABETS.digitPrefix,i=o+n;Za(r.combiner,e,i,r.font,t,gt.ALPHABETS.digitTrans,Wa.digit)}}function Za(t,e,n,r,o,i,s){for(let a,c=0;a=s[c];c++){const s=a in i?i[a]:i.default,c=a in o?o[a]:o.default;Ln(a,"default",e,t(s(n),r,c))}}var tc=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}c((r=r.apply(t,e||[])).next())})};const ec={functions:function(t){for(const e of t)Tn(e)||(mn(e.key,e.names||[]),"base"!==Nn?(yn(e),_n(e)):Rn.set(e.key,e))},symbols:function(t){for(const e of t){if(Tn(e))continue;const t=En.parseUnicode(e.key);"base"!==Nn?Cn(t,t,e.mappings):Rn.set(t,e)}},units:function(t){for(const e of t)Tn(e)||(e.key+=":unit","base"!==Nn?(yn(e),e.names&&(e.names=e.names.map(function(t){return t+":unit"})),e.si&&vn(e),_n(e)):Rn.set(e.key,e))},si:t=>t.forEach(An),messages:function(t){const e=Je[t.locale];if(!e)return void console.error("Locale "+t.locale+" does not exist!");const n=t.kind.toUpperCase(),r=t.messages;if(!r)return;const o=e();for(const[t,e]of Object.entries(r))o[n][t]=e},rules:$a.addStore,characters:t=>t.forEach(Mn)};let nc=!1;function rc(){return tc(this,arguments,void 0,function*(t=A.getInstance().options.locale){return nc||(!function(){for(const t of Z.values()){const e=t.unicode;for(const n of e)Rn.set(n,{key:n,category:t.category})}}(),oc(s.BASE_LOCALE),nc=!0),b.promises[s.BASE_LOCALE].then(()=>tc(this,void 0,void 0,function*(){const e=A.getInstance().defaultLocale;return e?(oc(e),b.promises[e].then(()=>tc(this,void 0,void 0,function*(){return oc(t),b.promises[t]}))):(oc(t),b.promises[t])}))})}function oc(t=A.getInstance().options.locale){b.loaded[t]||(b.loaded[t]=[!1,!1],Nn=s.DEFAULT_VALUES[e.LOCALE],Sn=s.DEFAULT_VALUES[e.MODALITY],function(t){const e=function(){if(A.getInstance().customLoader)return A.getInstance().customLoader;return ic()}(),n=new Promise(n=>{e(t).then(e=>{var r;(function(t,e){let n=!0;for(let r,o=0;r=Object.keys(t)[o];o++){const o=r.split("/");e&&e!==o[0]||(n&&"symbols"===o[1]&&"base"!==o[0]&&(Ka(o[0]),n=!1),ec[o[1]](t[r]))}})("string"==typeof(r=e)?JSON.parse(r):r),b.loaded[t]=[!0,!0],n(t)},e=>{b.loaded[t]=[!0,!1],console.error(`Unable to load locale: ${t}`),A.getInstance().options.locale=A.getInstance().defaultLocale,n(t)})});b.promises[t]=n}(t))}function ic(){switch(A.getInstance().mode){case n.ASYNC:return sc;case n.HTTP:return cc;case n.SYNC:default:return ac}}function sc(t){const e=m(t);return new Promise((t,n)=>{p.f.fs.readFile(e,"utf8",(e,r)=>{if(e)return n(e);t(r)})})}function ac(t){const e=m(t);return new Promise((t,n)=>{let r="{}";try{r=p.f.fs.readFileSync(e,"utf8")}catch(t){return n(t)}t(r)})}function cc(t){const e=m(t),n=new XMLHttpRequest;return new Promise((t,r)=>{n.onreadystatechange=function(){if(4===n.readyState){const e=n.status;0===e||e>=200&&e<400?t(n.responseText):r(e)}},n.open("GET",e,!0),n.send()})}var lc=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}c((r=r.apply(t,e||[])).next())})};function uc(t){return lc(this,void 0,void 0,function*(){t.debug&&g.getInstance().init();const e=A.getInstance();return e.setup(t),Ze(),e.setDynamicCstr(),e.init?(b.promises.init=new Promise((t,e)=>{setTimeout(()=>{t("init")},10)}),e.init=!1,b.get()):e.options.delay?(e.options.delay=!1,b.get()):rc()})}class hc{constructor(t){this.type=t,this.factory_=new Pr}getFactory(){return this.factory_}setFactory(t){this.factory_=t}getType(){return this.type}parseList(t){const e=[];for(let n,r=0;n=t[r];r++)e.push(this.parse(n));return e}}class dc extends hc{static getAttribute_(t,e,n){if(!t.hasAttribute(e))return n;const r=t.getAttribute(e);return r.match(/^\s*$/)?null:r}constructor(t){super("MathML"),this.options=t,ar.options=t,this.parseMap_=new Map([[gr.SEMANTICS,this.semantics_.bind(this)],[gr.MATH,this.rows_.bind(this)],[gr.MROW,this.rows_.bind(this)],[gr.MPADDED,this.rows_.bind(this)],[gr.MSTYLE,this.rows_.bind(this)],[gr.MFRAC,this.fraction_.bind(this)],[gr.MSUB,this.limits_.bind(this)],[gr.MSUP,this.limits_.bind(this)],[gr.MSUBSUP,this.limits_.bind(this)],[gr.MOVER,this.limits_.bind(this)],[gr.MUNDER,this.limits_.bind(this)],[gr.MUNDEROVER,this.limits_.bind(this)],[gr.MROOT,this.root_.bind(this)],[gr.MSQRT,this.sqrt_.bind(this)],[gr.MTABLE,this.table_.bind(this)],[gr.MLABELEDTR,this.tableLabeledRow_.bind(this)],[gr.MTR,this.tableRow_.bind(this)],[gr.MTD,this.tableCell_.bind(this)],[gr.MS,this.text_.bind(this)],[gr.MTEXT,this.text_.bind(this)],[gr.MSPACE,this.space_.bind(this)],[gr.ANNOTATIONXML,this.text_.bind(this)],[gr.MI,this.identifier_.bind(this)],[gr.MN,this.number_.bind(this)],[gr.MO,this.operator_.bind(this)],[gr.MFENCED,this.fenced_.bind(this)],[gr.MENCLOSE,this.enclosed_.bind(this)],[gr.MMULTISCRIPTS,this.multiscripts_.bind(this)],[gr.ANNOTATION,this.empty_.bind(this)],[gr.NONE,this.empty_.bind(this)],[gr.MACTION,this.action_.bind(this)],[gr.MPHANTOM,this.phantom_.bind(this)]]);const e={type:nt.IDENTIFIER,role:ot.NUMBERSET,font:st.DOUBLESTRUCK};["C","H","N","P","Q","R","Z","\u2102","\u210d","\u2115","\u2119","\u211a","\u211d","\u2124"].forEach((t=>this.getFactory().defaultMap.set(t,e)).bind(this))}parse(t){To.getInstance().setNodeFactory(this.getFactory());const e=v(t.childNodes),n=Y(t),r=this.parseMap_.get(n),o=(r||this.dummy_.bind(this))(t,e);return o.noupdate?o:(Lr(o,t),-1!==[gr.MATH,gr.MROW,gr.MPADDED,gr.MSTYLE,gr.SEMANTICS,gr.MACTION].indexOf(n)||(o.mathml.unshift(t),o.mathmlTree=t),o)}semantics_(t,e){return e.length?this.parse(e[0]):this.getFactory().makeEmptyNode()}rows_(t,e){const n=t.getAttribute("semantics");if(n&&n.match("bspr_"))return To.proof(t,n,this.parseList.bind(this));let r;if(1===(e=Cr(e)).length)r=this.parse(e[0]),r.type!==nt.EMPTY||r.mathmlTree||(r.mathmlTree=t);else{const n=ar.run("function_from_identifiers",t);r=n&&n!==t?n:To.getInstance().row(this.parseList(e))}return r.mathml.unshift(t),r}fraction_(t,e){if(!e.length)return this.getFactory().makeEmptyNode();const n=this.parse(e[0]),r=e[1]?this.parse(e[1]):this.getFactory().makeEmptyNode();return To.getInstance().fractionLikeNode(n,r,t.getAttribute("linethickness"),"true"===t.getAttribute("bevelled"))}limits_(t,e){return To.getInstance().limitNode(Y(t),this.parseList(e))}root_(t,e){return e[1]?this.getFactory().makeBranchNode(nt.ROOT,[this.parse(e[1]),this.parse(e[0])],[]):this.sqrt_(t,e)}sqrt_(t,e){const n=this.parseList(Cr(e));return this.getFactory().makeBranchNode(nt.SQRT,[To.getInstance().row(n)],[])}table_(t,e){const n=t.getAttribute("semantics");if(n&&n.match("bspr_"))return To.proof(t,n,this.parseList.bind(this));const r=this.getFactory().makeBranchNode(nt.TABLE,this.parseList(e),[]);return r.mathmlTree=t,To.tableToMultiline(r)}tableRow_(t,e){const n=this.getFactory().makeBranchNode(nt.ROW,this.parseList(e),[]);return n.role=ot.TABLE,n}tableLabeledRow_(t,e){var n;if(!e.length)return this.tableRow_(t,e);const r=this.parse(e[0]);r.role=ot.LABEL,(null===(n=r.childNodes[0])||void 0===n?void 0:n.type)===nt.TEXT&&(r.childNodes[0].role=ot.LABEL);const o=this.getFactory().makeBranchNode(nt.ROW,this.parseList(e.slice(1)),[r]);return o.role=ot.TABLE,o}tableCell_(t,e){const n=this.parseList(Cr(e));let r;r=n.length?1===n.length&&xr(n[0],nt.EMPTY)?n:[To.getInstance().row(n)]:[];const o=this.getFactory().makeBranchNode(nt.CELL,r,[]);return o.role=ot.TABLE,o}phantom_(t,e){let n;return e.length?(n=this.getFactory().makeUnprocessed(t),n.type=nt.TEXT,n.role=ot.SPACE):n=this.empty_(t,e),n}space_(t,e){const n=t.getAttribute("width"),r=n&&n.match(/[a-z]*$/);if(!r)return this.empty_(t,e);const o=r[0],i=parseFloat(n.slice(0,r.index)),s={cm:.4,pc:.5,em:.5,ex:1,in:.15,pt:5,mm:5}[o];if(!s||isNaN(i)||i<s)return this.empty_(t,e);const a=this.getFactory().makeUnprocessed(t);return To.getInstance().text(a,Y(t))}text_(t,e){const n=this.leaf_(t,e);return t.textContent?(n.updateContent(t.textContent,!0),To.getInstance().text(n,Y(t))):n}identifier_(t,e){const n=this.leaf_(t,e);return To.getInstance().identifierNode(n,To.getInstance().font(t.getAttribute("mathvariant")),t.getAttribute("class"))}number_(t,e){const n=this.leaf_(t,e);return To.number(n),n}operator_(t,e){const n=this.leaf_(t,e);return To.getInstance().operatorNode(n),n}fenced_(t,e){const n=this.parseList(e);n.forEach(t=>{xr(t,nt.EMPTY)&&t.addAnnotation("empty","MFENCED")});const r=dc.getAttribute_(t,"separators",","),o=dc.getAttribute_(t,"open","("),i=dc.getAttribute_(t,"close",")"),s=To.getInstance().mfenced(o,i,r,n);s.mathmlTree=t,s.mathml=[t];return To.getInstance().tablesInRow([s])[0]}enclosed_(t,e){const n=this.parseList(Cr(e)),r=this.getFactory().makeBranchNode(nt.ENCLOSE,[To.getInstance().row(n)],[]);return r.role=t.getAttribute("notation")||ot.UNKNOWN,r}multiscripts_(t,e){if(!e.length)return this.getFactory().makeEmptyNode();const n=this.parse(e.shift());if(!e.length)return n;const r=[],o=[],i=[],s=[];let a=!1,c=0;for(let t,n=0;t=e[n];n++)Y(t)!==gr.MPRESCRIPTS?(a?1&c?r.push(t):o.push(t):1&c?i.push(t):s.push(t),c++):(a=!0,c=0);return Cr(r).length||Cr(o).length?To.getInstance().tensor(n,this.parseList(o),this.parseList(r),this.parseList(s),this.parseList(i)):To.getInstance().pseudoTensor(n,this.parseList(s),this.parseList(i))}empty_(t,e){const n=this.getFactory().makeEmptyNode();return n.mathml=[t],n.mathmlTree=t,n}action_(t,e){const n=e[t.hasAttribute("selection")?parseInt(t.getAttribute("selection"),10)-1:0],r=this.parse(n);return r.mathmlTree=n,r}dummy_(t,e){const n=this.getFactory().makeUnprocessed(t);return n.role=t.tagName,n.textContent=t.textContent,n}leaf_(t,e){if(1===e.length&&e[0].nodeType!==D.TEXT_NODE){const n=this.getFactory().makeUnprocessed(t);return n.role=e[0].tagName,Lr(n,e[0]),n}const n=this.getFactory().makeLeafNode(t.textContent,To.getInstance().font(t.getAttribute("mathvariant")));return t.hasAttribute("data-latex")&&on.LatexCommands.set(t.getAttribute("data-latex"),t.textContent),n}}class pc{constructor(t,e,n=t=>!1){this.name=t,this.apply=e,this.applicable=n}}class fc extends pc{}class mc extends pc{}const gc="data-semantic-";var Ec;!function(t){t.ADDED="data-semantic-added",t.ALTERNATIVE="data-semantic-alternative",t.CHILDREN="data-semantic-children",t.COLLAPSED="data-semantic-collapsed",t.CONTENT="data-semantic-content",t.EMBELLISHED="data-semantic-embellished",t.FENCEPOINTER="data-semantic-fencepointer",t.FONT="data-semantic-font",t.ID="data-semantic-id",t.ANNOTATION="data-semantic-annotation",t.ATTRIBUTES="data-semantic-attributes",t.OPERATOR="data-semantic-operator",t.OWNS="data-semantic-owns",t.PARENT="data-semantic-parent",t.POSTFIX="data-semantic-postfix",t.PREFIX="data-semantic-prefix",t.ROLE="data-semantic-role",t.SPEECH="data-semantic-speech",t.STRUCTURE="data-semantic-structure",t.SUMMARY="data-semantic-summary",t.TYPE="data-semantic-type"}(Ec||(Ec={}));const Nc=[Ec.ADDED,Ec.ALTERNATIVE,Ec.CHILDREN,Ec.COLLAPSED,Ec.CONTENT,Ec.EMBELLISHED,Ec.FENCEPOINTER,Ec.FONT,Ec.ID,Ec.ANNOTATION,Ec.ATTRIBUTES,Ec.OPERATOR,Ec.OWNS,Ec.PARENT,Ec.POSTFIX,Ec.PREFIX,Ec.ROLE,Ec.SPEECH,Ec.STRUCTURE,Ec.SUMMARY,Ec.TYPE];function Sc(t){return t.map(function(t){return t.id}).join(",")}function Tc(t,e){t.setAttribute(Ec.TYPE,e.type);const n=e.allAttributes();for(let e,r=0;e=n[r];r++)t.setAttribute(gc+e[0].toLowerCase(),e[1]);e.childNodes.length&&t.setAttribute(Ec.CHILDREN,Sc(e.childNodes)),e.contentNodes.length&&t.setAttribute(Ec.CONTENT,Sc(e.contentNodes)),e.parent&&t.setAttribute(Ec.PARENT,e.parent.id.toString());const r=e.attributesXml();r&&t.setAttribute(Ec.ATTRIBUTES,r),function(t,e){const n=[];e.role===ot.MGLYPH&&n.push("image");e.attributes.href&&n.push("link");n.length&&t.setAttribute(Ec.POSTFIX,n.join(" "))}(t,e)}function Ic(t){return gc+t}function Ac(){const t=k("mrow");return t.setAttribute(Ec.ADDED,"true"),t}class bc{static fromTree(t){return bc.fromNode(t.root)}static fromNode(t){return new bc(bc.fromNode_(t))}static fromString(t){return new bc(bc.fromString_(t))}static simpleCollapseStructure(t){return"number"==typeof t}static contentCollapseStructure(t){return!!t&&!bc.simpleCollapseStructure(t)&&"c"===t[0]}static interleaveIds(t,e){return ir(bc.collapsedLeafs(t),bc.collapsedLeafs(e))}static collapsedLeafs(...t){return t.reduce((t,e)=>{return t.concat((n=e,bc.simpleCollapseStructure(n)?[n]:bc.contentCollapseStructure(n[1])?n.slice(2):n.slice(1)));var n},[])}static fromStructure(t,e,n){return new bc(bc.tree_(t,e.root,n))}static combineContentChildren(t,e,n,r){switch(t){case nt.RELSEQ:case nt.INFIXOP:case nt.MULTIREL:return ir(r,n);case nt.PREFIXOP:return n.concat(r);case nt.POSTFIXOP:return r.concat(n);case nt.MATRIX:case nt.VECTOR:case nt.FENCED:return r.unshift(n[0]),r.push(n[1]),r;case nt.CASES:return r.unshift(n[0]),r;case nt.APPL:return[r[0],n[0],r[1]];case nt.ROOT:return[r[0],r[1]];case nt.ROW:case nt.LINE:return n.length&&r.push(n[0]),r;default:return r}}static makeSexp_(t){return bc.simpleCollapseStructure(t)?t.toString():bc.contentCollapseStructure(t)?"(c "+t.slice(1).map(bc.makeSexp_).join(" ")+")":"("+t.map(bc.makeSexp_).join(" ")+")"}static fromString_(t){let e=t.replace(/\(/g,"[");return e=e.replace(/\)/g,"]"),e=e.replace(/ /g,","),e=e.replace(/c/g,'"c"'),JSON.parse(e)}static fromNode_(t){if(!t)return[];const e=t.contentNodes;let n;e.length&&(n=e.map(bc.fromNode_),n.unshift("c"));const r=t.childNodes;if(!r.length)return e.length?[t.id,n]:t.id;const o=r.map(bc.fromNode_);return e.length&&o.unshift(n),o.unshift(t.id),o}static tree_(t,e,n,r=0,o=1,i=1){if(!e)return[];const s=e.id,a=[s];_(t);const c=M(`.//self::*[@${Ec.ID}=${s}]`,t)[0];if(!e.childNodes.length)return bc.addAria(c,r,o,i,n),e.id;const l=bc.combineContentChildren(e.type,e.role,e.contentNodes.map(function(t){return t}),e.childNodes.map(function(t){return t}));c&&bc.addOwns_(c,l);for(let e,o=0,i=l.length;e=l[o];o++)a.push(bc.tree_(t,e,n,r+1,o+1,i));return bc.addAria(c,r,o,i,n),a}static addAria(t,e,n,r,o){const i=o.tree?e?"treeitem":"tree":"treeitem";o.aria&&t&&(t.setAttribute("aria-level",e.toString()),t.setAttribute("aria-posinset",n.toString()),t.setAttribute("aria-setsize",r.toString()),t.setAttribute("role",i),t.hasAttribute(Ec.OWNS)&&t.setAttribute("aria-owns",t.getAttribute(Ec.OWNS)))}static addOwns_(t,e){const n=t.getAttribute(Ec.COLLAPSED),r=n?bc.realLeafs_(bc.fromString(n).array):e.map(t=>t.id);t.setAttribute(Ec.OWNS,r.join(" "))}static realLeafs_(t){if(bc.simpleCollapseStructure(t))return[t];if(bc.contentCollapseStructure(t))return[];let e=[];for(let n=1;n<t.length;n++)e=e.concat(bc.realLeafs_(t[n]));return e}constructor(t){this.parents=null,this.levelsMap=null,t=0===t?t:t||[],this.array=t}populate(){this.parents&&this.levelsMap||(this.parents={},this.levelsMap={},this.populate_(this.array,this.array,[]))}toString(){return bc.makeSexp_(this.array)}populate_(t,e,n){if(bc.simpleCollapseStructure(t))return this.levelsMap[t]=e,void(this.parents[t]=t===n[0]?n.slice(1):n);const r=bc.contentCollapseStructure(t)?t.slice(1):t,o=[r[0]].concat(n);for(let e=0,n=r.length;e<n;e++){const n=r[e];this.populate_(n,t,o)}}isRoot(t){return t===this.levelsMap[t][0]}directChildren(t){if(!this.isRoot(t))return[];return this.levelsMap[t].slice(1).map(t=>bc.simpleCollapseStructure(t)?t:bc.contentCollapseStructure(t)?t[1]:t[0])}subtreeNodes(t){if(!this.isRoot(t))return[];const e=(t,n)=>{bc.simpleCollapseStructure(t)?n.push(t):(bc.contentCollapseStructure(t)&&(t=t.slice(1)),t.forEach(t=>e(t,n)))},n=this.levelsMap[t],r=[];return e(n.slice(1),r),r}}function Rc(t,e,n){let r=null;if(!t.length)return r;const o=n[n.length-1],i=o&&o.length,s=e&&e.length,a=To.getInstance();if(i&&s){if(e[0].type===nt.INFIXOP&&e[0].role===ot.IMPLICIT)return r=t.pop(),o.push(a.postfixNode_(o.pop(),t)),r;r=t.shift();const n=a.prefixNode_(e.shift(),t);return e.unshift(n),r}return i?(o.push(a.postfixNode_(o.pop(),t)),r):(s&&e.unshift(a.prefixNode_(e.shift(),t)),r)}function Oc(t,e,n){if(!e.length)return t;const r=t.pop(),o=e.shift(),i=n.shift();if(o.type===nt.INFIXOP&&(o.role===ot.IMPLICIT||o.role===ot.UNIT)){g.getInstance().output("Juxta Heuristic Case 2");const s=(r?[r,o]:[o]).concat(i);return Oc(t.concat(s),e,n)}if(!r)return g.getInstance().output("Juxta Heuristic Case 3"),Oc([o].concat(i),e,n);const s=i.shift();if(!s){g.getInstance().output("Juxta Heuristic Case 9");const i=ar.factory.makeBranchNode(nt.INFIXOP,[r,e.shift()],[o],o.textContent);return i.role=ot.IMPLICIT,ar.run("combine_juxtaposition",i),e.unshift(i),Oc(t,e,n)}if($r(r)||$r(s))return g.getInstance().output("Juxta Heuristic Case 4"),Oc(t.concat([r,o,s]).concat(i),e,n);let a=null;return fo(r)&&fo(s)?(g.getInstance().output("Juxta Heuristic Case 5"),r.contentNodes.push(o),r.contentNodes=r.contentNodes.concat(s.contentNodes),r.childNodes.push(s),r.childNodes=r.childNodes.concat(s.childNodes),s.childNodes.forEach(t=>t.parent=r),o.parent=r,r.addMathmlNodes(o.mathml),r.addMathmlNodes(s.mathml),a=r):fo(r)?(g.getInstance().output("Juxta Heuristic Case 6"),r.contentNodes.push(o),r.childNodes.push(s),s.parent=r,o.parent=r,r.addMathmlNodes(o.mathml),r.addMathmlNodes(s.mathml),a=r):fo(s)?(g.getInstance().output("Juxta Heuristic Case 7"),s.contentNodes.unshift(o),s.childNodes.unshift(r),r.parent=s,o.parent=s,s.addMathmlNodes(o.mathml),s.addMathmlNodes(r.mathml),a=s):(g.getInstance().output("Juxta Heuristic Case 8"),a=ar.factory.makeBranchNode(nt.INFIXOP,[r,s],[o],o.textContent),a.role=ot.IMPLICIT),t.push(a),Oc(t.concat(i),e,n)}function yc(t){return t.childNodes[0]&&t.childNodes[0].childNodes[0]&&Y(t.childNodes[0])===gr.MPADDED&&Y(t.childNodes[0].childNodes[0])===gr.MPADDED&&Y(t.childNodes[0].childNodes[t.childNodes[0].childNodes.length-1])===gr.MPHANTOM}ar.add(new fc("combine_juxtaposition",function(t){for(let e,n=t.childNodes.length-1;e=t.childNodes[n];n--)fo(e)&&!e.nobreaking&&(t.childNodes.splice(n,1,...e.childNodes),t.contentNodes.splice(n,0,...e.contentNodes),e.childNodes.concat(e.contentNodes).forEach(function(e){e.parent=t}),t.addMathmlNodes(e.mathml));return t})),ar.add(new fc("propagateSimpleFunction",t=>(t.type!==nt.INFIXOP&&t.type!==nt.FRACTION||!t.childNodes.every(io)||(t.role=ot.COMPFUNC),t),t=>"clearspeak"===ar.options.domain)),ar.add(new fc("simpleNamedFunction",t=>(t.role!==ot.UNIT&&-1!==["f","g","h","F","G","H"].indexOf(t.textContent)&&(t.role=ot.SIMPLEFUNC),t),t=>"clearspeak"===ar.options.domain)),ar.add(new fc("propagateComposedFunction",t=>(t.type===nt.FENCED&&t.childNodes[0].role===ot.COMPFUNC&&(t.role=ot.COMPFUNC),t),t=>"clearspeak"===ar.options.domain)),ar.add(new fc("multioperator",t=>{t.role!==ot.UNKNOWN||t.textContent.length<=1||(To.compSemantics(t,"role",ot),To.compSemantics(t,"type",nt))})),ar.add(new mc("convert_juxtaposition",t=>{let e=vr(t,function(t){return t.textContent===en.invisibleTimes&&t.type===nt.OPERATOR});e=e.rel.length?function(t){const e=[],n=[];let r=t.comp.shift(),o=null,i=[];for(;t.comp.length;)if(i=[],r.length)o&&e.push(o),n.push(r),o=t.rel.shift(),r=t.comp.shift();else{for(o&&i.push(o);!r.length&&t.comp.length;)r=t.comp.shift(),i.push(t.rel.shift());o=Rc(i,r,n)}i.length||r.length?(e.push(o),n.push(r)):(i.push(o),Rc(i,r,n));return{rel:e,comp:n}}(e):e,t=e.comp[0];for(let n,r,o=1;n=e.comp[o],r=e.rel[o-1];o++)t.push(r),t=t.concat(n);return e=vr(t,function(t){return t.textContent===en.invisibleTimes&&(t.type===nt.OPERATOR||t.type===nt.INFIXOP)}),e.rel.length?Oc(e.comp.shift(),e.rel,e.comp):t})),ar.add(new fc("simple2prefix",t=>(t.textContent.length>1&&!t.textContent[0].match(/[A-Z]/)&&(t.role=ot.PREFIXFUNC),t),t=>"braille"===ar.options.modality&&t.type===nt.IDENTIFIER)),ar.add(new fc("detect_cycle",t=>{t.type=nt.MATRIX,t.role=ot.CYCLE;const e=t.childNodes[0];return e.type=nt.ROW,e.role=ot.CYCLE,e.textContent="",e.contentNodes=[],t},t=>t.type===nt.FENCED&&t.childNodes[0].type===nt.INFIXOP&&t.childNodes[0].role===ot.IMPLICIT&&t.childNodes[0].childNodes.every(function(t){return t.type===nt.NUMBER})&&t.childNodes[0].contentNodes.every(function(t){return t.role===ot.SPACE}))),ar.add(new mc("intvar_from_implicit",function(t){const e=t[0].childNodes;t.splice(0,1,...e),t.forEach(t=>t.parent=null)},t=>t[0]&&po(t[0]))),ar.add(new fc("intvar_from_fraction",function(t){const e=t.childNodes[1],n=e.childNodes[0];if(Hr(n))return void(n.role=ot.INTEGRAL);if(!po(n))return;const r=n.childNodes.length,o=n.childNodes[r-2],i=n.childNodes[r-1];if(Hr(i))return void(i.role=ot.INTEGRAL);if(Vr(o,i)){const t=To.getInstance().prefixNode_(i,[o]);t.role=ot.INTEGRAL,2===r?e.childNodes[0]=t:(n.childNodes.pop(),n.contentNodes.pop(),n.childNodes[r-2]=t,t.parent=n)}},t=>{if(t.type!==nt.INTEGRAL)return!1;const[,e,n]=t.childNodes;return n.type===nt.EMPTY&&e.type===nt.FRACTION})),ar.add(new fc("rewrite_subcases",function(t){t.addAnnotation("Emph","top");let e=[];if(t.hasAnnotation("Emph","left")){const n=Lc(t.childNodes[0].childNodes[0].childNodes[0],!0);n.forEach(t=>t.addAnnotation("Emph","left")),e=e.concat(n);for(let e,n=0;e=t.childNodes[n];n++)e.childNodes.shift()}if(e.push(t),t.hasAnnotation("Emph","right")){const n=Lc(t.childNodes[0].childNodes[t.childNodes[0].childNodes.length-1].childNodes[0]);n.forEach(t=>t.addAnnotation("Emph","left")),e=e.concat(n),t.childNodes[0].childNodes.pop()}To.tableToMultiline(t);const n=To.getInstance().row(e),r=t.annotation.Emph;return t.annotation.Emph=["table"],r.forEach(t=>n.addAnnotation("Emph",t)),n},t=>{let e=!0,n=!0;const r=t.childNodes[0].childNodes[0];if(!r)return!1;if(yc(r.mathmlTree)){for(let n,r=1;n=t.childNodes[r];r++)if(n.childNodes[0].childNodes.length){e=!1;break}}else e=!1;e&&t.addAnnotation("Emph","left");if(yc(t.childNodes[0].childNodes[t.childNodes[0].childNodes.length-1].mathmlTree)){const e=t.childNodes[0].childNodes.length;for(let r,o=1;r=t.childNodes[o];o++)if(r.childNodes.length>=e){n=!1;break}}else n=!1;return n&&t.addAnnotation("Emph","right"),e||n}));const Cc=[nt.PUNCTUATED,nt.RELSEQ,nt.MULTIREL,nt.INFIXOP,nt.PREFIXOP,nt.POSTFIXOP];function Lc(t,e){if(!t.childNodes.length)return _c(t),[t];let n=null;if(t.type===nt.PUNCTUATED&&(e?t.role===ot.ENDPUNCT:t.role===ot.STARTPUNCT)){const r=t.childNodes;_c(r[e?r.length-1:0])&&(t=r[e?0:r.length-1],n=r[e?r.length-1:0])}if(-1!==Cc.indexOf(t.type)){const r=t.childNodes;_c(r[e?r.length-1:0]);const o=bc.combineContentChildren(t.type,t.role,t.contentNodes,t.childNodes);return n&&(e?o.push(n):o.unshift(n)),o}return n?e?[t,n]:[n,t]:[t]}const Mc={[ot.METRIC]:ot.METRIC,[ot.VBAR]:ot.NEUTRAL,[ot.OPENFENCE]:ot.OPEN,[ot.CLOSEFENCE]:ot.CLOSE};function _c(t){if(t.type!==nt.PUNCTUATION)return!1;const e=Mc[t.role];return!!e&&(t.role=e,t.type=nt.FENCE,t.addAnnotation("Emph","fence"),!0)}function vc(t,e,n,r=n){const o=[];for(;t&&t.role===n;)o.push(t),t=e.shift();return o.length?(t&&e.unshift(t),[1===o.length?o[0]:wc(o,r),e]):[t,e]}function wc(t,e){const n=ar.factory.makeBranchNode(nt.PUNCTUATION,t,[]);return n.role=e,n}function Dc(t){return["[","\uff3b"].includes(t)}function Pc(t){return["]","\uff3d"].includes(t)}function xc(t){return["(","\u207d","\u208d"].includes(t)}function Uc(t){return[")","\u207e","\u208e"].includes(t)}function Fc(t){return t.role===ot.INFTY||t.type===nt.PREFIXOP&&t.childNodes[0].role===ot.INFTY}function kc(t){const e=t.childNodes[0];if(t.type!==nt.FENCED||(null==e?void 0:e.type)!==nt.PUNCTUATED||3!==(null==e?void 0:e.childNodes.length)||1!==(null==e?void 0:e.contentNodes.length)||(null==e?void 0:e.childNodes[1].role)!==ot.COMMA)return!1;const n=t.childNodes[0].childNodes[0],r=t.childNodes[0].childNodes[2],o=t.contentNodes[0].textContent,i=t.contentNodes[1].textContent;return!!(Dc(o)&&Uc(i)||xc(o)&&Pc(i))||!(!xc(o)||!Uc(i)||!Fc(n)&&!Fc(r))}function Bc(t){return jc(t)||function(t){return Vc(t)||t.type===nt.INFIXOP&&t.role===ot.IMPLICIT&&(2===t.childNodes.length&&(Vc(t.childNodes[0])||jc(t.childNodes[0]))&&Vc(t.childNodes[1])||3===t.childNodes.length&&jc(t.childNodes[0])&&Vc(t.childNodes[1])&&Vc(t.childNodes[2]))}(t)||function(t){return t.type===nt.PUNCTUATED&&t.role===ot.ENDPUNCT&&2===t.childNodes.length&&t.childNodes[1].role===ot.DEGREE&&(Vc(t.childNodes[0])||Hc(t.childNodes[0])||t.childNodes[0].type===nt.PREFIXOP&&t.childNodes[0].role===ot.NEGATIVE&&(Vc(t.childNodes[0].childNodes[0])||Hc(t.childNodes[0].childNodes[0])))}(t)||function(t){return t.type===nt.PREFIXOP&&t.role===ot.NEGATIVE&&Gc(t.childNodes[0])&&t.childNodes[0].type!==nt.PREFIXOP&&t.childNodes[0].type!==nt.APPL&&t.childNodes[0].type!==nt.PUNCTUATED}(t)||function(t){return t.type===nt.APPL&&(t.childNodes[0].role===ot.PREFIXFUNC||t.childNodes[0].role===ot.SIMPLEFUNC)&&(Gc(t.childNodes[1])||t.childNodes[1].type===nt.FENCED&&Gc(t.childNodes[1].childNodes[0]))}(t)}function Gc(t){return t.hasAnnotation("clearspeak","simple")}function Vc(t){return t.type===nt.IDENTIFIER&&(t.role===ot.LATINLETTER||t.role===ot.GREEKLETTER||t.role===ot.OTHERLETTER||t.role===ot.SIMPLEFUNC)}function Hc(t){return t.type===nt.NUMBER&&(t.role===ot.INTEGER||t.role===ot.FLOAT)}function jc(t){return Hc(t)||function(t){if(qc("Fraction_Over")||qc("Fraction_FracOver"))return!1;if(t.type!==nt.FRACTION||t.role!==ot.VULGAR)return!1;if(qc("Fraction_Ordinal"))return!0;const e=parseInt(t.childNodes[0].textContent,10),n=parseInt(t.childNodes[1].textContent,10);return e>0&&e<20&&n>0&&n<11}(t)}function qc(t){return A.getInstance().options.style===t}function $c(t){return t.type===nt.TEXT&&t.role!==ot.LABEL||t.type===nt.PUNCTUATED&&t.role===ot.TEXT&&Hc(t.childNodes[0])&&function(t){for(let e=0;e<t.length-1;e++)if(t[e].type!==nt.TEXT||""!==t[e].textContent)return!1;return t[t.length-1].type===nt.TEXT}(t.childNodes.slice(1))||t.type===nt.IDENTIFIER&&t.role===ot.UNIT||t.type===nt.INFIXOP&&(t.role===ot.IMPLICIT||t.role===ot.UNIT)}ar.add(new mc("ellipses",t=>{const e=[];let n=t.shift();for(;n;)[n,t]=vc(n,t,ot.FULLSTOP,ot.ELLIPSIS),[n,t]=vc(n,t,ot.DASH),e.push(n),n=t.shift();return e},t=>t.length>1)),ar.add(new mc("op_with_limits",t=>{const e=t[0];return e.type=nt.LARGEOP,e.role=ot.SUM,t},t=>(t[0].type===nt.OPERATOR||t[0].type===nt.IDENTIFIER&&"OP"===t[0].attributes.texclass)&&t.slice(1).some(t=>t.type===nt.RELSEQ||t.type===nt.MULTIREL||t.type===nt.INFIXOP&&t.role===ot.ELEMENT||t.type===nt.PUNCTUATED&&t.role===ot.SEQUENCE))),ar.add(new class extends pc{}("function_from_identifiers",t=>{const e=v(t.childNodes).map(t=>t.textContent.trim()).join("");if(on.Meaning.get(e).type===nt.UNKNOWN)return t;const n=ar.factory.makeLeafNode(e,To.getInstance().font(t.getAttribute("mathvariant")));return n.mathmlTree=t,n},t=>{const e=v(t.childNodes);return!(e.length<2)&&e.every(t=>Y(t)===gr.MI&&on.Meaning.get(t.textContent.trim()).role===ot.LATINLETTER)})),ar.add(new mc("bracketed_interval",t=>{const e=t[0],n=t[1],r=t.slice(2),o=To.getInstance().row(r),i=ar.factory.makeBranchNode(nt.FENCED,[o],[e,n]);return i.role=ot.INTERVAL,i},t=>{const e=t[0],n=t[1],r=t.slice(2);if(!(e&&n&&(Pc(e.textContent)&&(Dc(n.textContent)||Pc(n.textContent))||Dc(n.textContent)&&(Dc(e.textContent)||Pc(e.textContent)))))return!1;if(1===r.length&&r[0].type===nt.PUNCTUATED&&1===r[0].contentNodes.length)return!0;const o=vr(r,Xr);return!(1!==o.rel.length||!o.comp[0].length||!o.comp[1].length)})),ar.add(new fc("interval_heuristic",t=>(t.role=ot.INTERVAL,t),t=>kc(t))),ar.add(new fc("propagateInterval",t=>(t.childNodes.forEach(t=>{kc(t)&&(t.role=ot.INTERVAL)}),t),t=>So(t))),Ss(new ms("clearspeak","simple",function(t){return Bc(t)?"simple":""})),Ts("clearspeak","simple"),Ss(new ms("clearspeak","unit",function(t){return $c(t)?"unit":""})),Ts("clearspeak","unit");const Yc=[nt.MULTIREL,nt.RELSEQ,nt.APPL,nt.ROW,nt.LINE],Xc=[nt.SUBSCRIPT,nt.SUPERSCRIPT,nt.OVERSCORE,nt.UNDERSCORE];function Wc(t,e){const n=t.parent;if(!n)return!1;const r=n.type;return-1!==Yc.indexOf(r)||r===nt.PREFIXOP&&n.role===ot.NEGATIVE&&!e.script&&!e.enclosed||r===nt.PREFIXOP&&n.role===ot.GEOMETRY||!(r!==nt.PUNCTUATED||e.enclosed&&n.role!==ot.TEXT)}Ss(new gs("nemeth","number",function(t,e){return t.childNodes.length?(-1!==Xc.indexOf(t.type)&&(e.script=!0),t.type===nt.FENCED?(e.number=!1,e.enclosed=!0,["",e]):t.type===nt.PREFIXOP&&t.role!==ot.GEOMETRY&&t.role!==ot.NEGATIVE?(e.number=!1,["",e]):(Wc(t,e)&&(e.number=!0,e.enclosed=!1),["",e])):(Wc(t,e)&&(e.number=!0,e.script=!1,e.enclosed=!1),[e.number?"number":"",{number:!1,enclosed:e.enclosed,script:e.script}])},{number:!0})),Ts("nemeth","number"),Ss(new gs("depth","depth",function(t){return t.parent?[parseInt(t.parent.annotation.depth[0])+1]:[1]})),Ts("depth","depth");class Kc{static empty(){const t=w("<math/>"),e=new Kc(t,new N);return e.mathml=t,e}static fromNode(t,e){const n=Kc.empty();return n.root=t,e&&(n.mathml=e),n}static fromRoot(t,e){let n=t;for(;n.parent;)n=n.parent;const r=Kc.fromNode(n);return e&&(r.mathml=e),r}static fromXml(t){const e=Kc.empty();return t.childNodes[0]&&(e.root=Dr.fromXml(t.childNodes[0])),e}constructor(t,e){this.mathml=t,this.options=e,this.parser=new dc(e),this.root=this.parser.parse(t),this.root=To.rewriteTrivialTable(this.root),this.collator=this.parser.getFactory().leafMap.collateMeaning();const n=this.collator.newDefault();n&&(this.parser=new dc(e),this.parser.getFactory().defaultMap=n,this.root=this.parser.parse(t)),zc.visit(this.root,{}),function(t){for(const e of Es.values())e.active&&e.annotate(t);for(const e of Ns.values())e.active&&e.visit(t,Object.assign({},e.def))}(this.root)}xml(t){const e=w("<stree></stree>"),n=this.root.xml(e.ownerDocument,t);return e.appendChild(n),e}toString(t){return W(this.xml(t))}formatXml(t){return V(this.toString(t))}displayTree(){this.root.displayTree()}replaceNode(t,e){const n=t.parent;n?n.replaceChild(t,e):this.root=e}toJson(){const t={};return t.stree=this.root.toJson(),t}}const zc=new gs("general","unit",(t,e)=>(ho(t)&&(t.role=ot.UNIT),!1));function Qc(t,e){return Jc(t,e).xml()}function Jc(t,e){return new Kc(t,e)}const Zc=[],tl=!0,el=new Map;function nl(t){g.getInstance().generate(()=>["WALKING START: ",t.toString()]);const e=function(t){for(let e,n=0;e=Zc[n];n++)if(e.test(t))return e.constr(t);return null}(t);let n;if(e)return n=e.getMathml(),g.getInstance().generate(()=>["WALKING END: ",t.toString()]),ml(n);if(1===t.mathml.length){if(g.getInstance().output("Walktree Case 0"),!t.childNodes.length)return g.getInstance().output("Walktree Case 0.1"),n=t.mathml[0],Tc(n,t),g.getInstance().generate(()=>["WALKING END: ",t.toString()]),ml(n);const e=t.childNodes[0];if(1===t.childNodes.length&&e.type===nt.EMPTY)return g.getInstance().output("Walktree Case 0.2"),n=t.mathml[0],Tc(n,t),n.appendChild(nl(e)),g.getInstance().generate(()=>["WALKING END: ",t.toString()]),ml(n);t.childNodes.forEach(t=>{t.mathml.length||(t.mathml=[bl(t)])})}const r=t.contentNodes.map(Il);Rl(t,r);const o=t.childNodes.map(nl),i=bc.combineContentChildren(t.type,t.role,r,o);if(n=t.mathmlTree,null===n)g.getInstance().output("Walktree Case 1"),n=rl(i,t);else{n=Al(n);const t=dl(i);g.getInstance().output("Walktree Case 2"),t?(g.getInstance().output("Walktree Case 2.1"),n=Sl(t)):(g.getInstance().output("Walktree Case 2.2"),n=Ol(n))}return function(t,e,n){if(!e.length)return;if(1===e.length&&t===e[0])return;const r=n.role===ot.IMPLICIT&&ar.flags.combine_juxtaposition?function(t,e,n){const r=[];let o=v(t.childNodes),i=!1;for(;o.length;){const t=o.shift();if(t.hasAttribute(Ec.TYPE)){r.push(t);continue}const n=il(t,e);0!==n.length&&(1!==n.length?(i?t.setAttribute("AuxiliaryImplicit",!0):i=!0,o=n.concat(o)):r.push(t))}const s=[],a=n.childNodes.map(function(t){return t.mathmlTree});for(;a.length;){const t=a.pop();if(t){if(-1!==r.indexOf(t))break;-1!==e.indexOf(t)&&s.unshift(t)}}return r.concat(s)}(t,e,n):v(t.childNodes);if(!r.length)return void e.forEach(function(e){t.appendChild(e)});let o=0;for(;e.length;){const n=e[0];if(r[o]===n||ul(r[o],n)){e.shift(),o++;continue}if(r[o]&&-1===e.indexOf(r[o])){o++;continue}if(ll(n,t)){e.shift();continue}const i=r[o];if(!i){if(n.parentNode){t=Sl(n),e.shift();continue}const r=e[1];if(r&&r.parentNode){al(t=Sl(r),n,r),e.shift(),e.shift();continue}al(t,n,null),e.shift();continue}sl(t,i,n),e.shift()}}(n,i,t),el.has(t.id)||(el.set(t.id,!0),Tc(n,t)),g.getInstance().generate(()=>["WALKING END: ",t.toString()]),ml(n,t)}function rl(t,e){const n=function(t){const e=dl(t);if(!e)return{type:hl.INVALID,node:null};const n=dl(t.slice().reverse());if(e===n)return{type:hl.VALID,node:e};const r=pl(e),o=function(t,e){let n=0;for(;t[n]&&-1===e.indexOf(t[n]);)n++;return t.slice(0,n+1)}(r,t),i=pl(n,function(t){return-1!==o.indexOf(t)}),s=i[0],a=o.indexOf(s);if(-1===a)return{type:hl.INVALID,node:null};return{type:o.length!==r.length?hl.PRUNED:fl(o[a+1],i[1])?hl.VALID:hl.INVALID,node:s}}(t);let r=n.node;const o=n.type;if(o!==hl.VALID||!Or(r)||!r.parentNode&&e.parent)if(g.getInstance().output("Walktree Case 1.1"),r=Ac(),o===hl.PRUNED)g.getInstance().output("Walktree Case 1.1.0"),r=function(t,e,n){let r=gl(e);if(br(r)){g.getInstance().output("Walktree Case 1.1.0.0"),ol(r,t),v(r.childNodes).forEach(function(e){t.appendChild(e)});const e=t;t=r,r=e}const o=n.indexOf(e);return n[o]=r,F(r,t),t.appendChild(r),n.forEach(function(e){t.appendChild(e)}),t}(r,n.node,t);else if(t[0]){g.getInstance().output("Walktree Case 1.1.1");const e=dl(t);if(e){const n=function(t,e){const n=v(t.childNodes);let r=1/0,o=-1/0;return e.forEach(function(t){const e=n.indexOf(t);-1!==e&&(r=Math.min(r,e),o=Math.max(o,e))}),n.slice(r,o+1)}(Sl(e),t);F(e,r),n.forEach(function(t){r.appendChild(t)})}else ol(r,t[0]),r=t[0]}return e.mathmlTree||(e.mathmlTree=r),r}function ol(t,e){for(const n of Nc)t.hasAttribute(n)&&(e.setAttribute(n,t.getAttribute(n)),t.removeAttribute(n))}function il(t,e){const n=[];let r=v(t.childNodes);for(;r.length;){const t=r.shift();t.nodeType===D.ELEMENT_NODE&&(t.hasAttribute(Ec.TYPE)||-1!==e.indexOf(t)?n.push(t):r=v(t.childNodes).concat(r))}return n}function sl(t,e,n){let r=e,o=Sl(r);for(;o&&cl(o,r)&&!r.hasAttribute("AuxiliaryImplicit")&&o!==t;)r=o,o=Sl(r);o&&(al(o,n,r),r.removeAttribute("AuxiliaryImplicit"))}function al(t,e,n){Y(t)===gr.MACTION?al(Sl(t),e,t):t.insertBefore(e,n)}function cl(t,e){if(Y(t)!==gr.MACTION)return t.firstChild===e;const n=parseInt(t.getAttribute("selection"))||1;return t.childNodes[n-1]===e}function ll(t,e){if(!t)return!1;do{if((t=Sl(t))===e)return!0}while(t);return!1}function ul(t,e){const n=en.functionApplication;if(t&&e&&t.textContent&&e.textContent&&t.textContent===n&&e.textContent===n&&"true"===e.getAttribute(Ec.ADDED)){for(let n,r=0;n=t.attributes[r];r++)e.hasAttribute(n.nodeName)||e.setAttribute(n.nodeName,n.nodeValue);return F(t,e),!0}return!1}var hl;function dl(t){let e=0,n=null;for(;!n&&e<t.length;)t[e].parentNode&&(n=t[e]),e++;return n}function pl(t,e){const n=e||(t=>!1),r=[t];for(;!n(t)&&!br(t)&&t.parentNode;)t=Sl(t),r.unshift(t);return r}function fl(t,e){return!(!t||!e||t.previousSibling||e.nextSibling)}function ml(t,e){var n;let r=e&&!e.hasAnnotation("empty","MFENCED")&&e.getAnnotation("empty");for(;!br(t)&&(El(t)||r&&t.parentNode&&r.includes(null===(n=Sl(t).tagName)||void 0===n?void 0:n.toUpperCase()));)t=Sl(t);return t}function gl(t){const e=v(t.childNodes);if(!e)return t;const n=e.filter(function(t){return t.nodeType===D.ELEMENT_NODE&&!Rr(t)});return 1===n.length&&Or(n[0])&&!n[0].hasAttribute(Ec.TYPE)?gl(n[0]):t}function El(t){const e=Sl(t);return!(!e||!Or(e))&&v(e.childNodes).every(function(e){return e===t||Nl(e)})}function Nl(t){if(t.nodeType!==D.ELEMENT_NODE)return!0;if(!t||Rr(t))return!0;const e=v(t.childNodes);return!(!Or(t)&&e.length||function(t){return!!t&&Ir.includes(Y(t))}(t)||t.hasAttribute(Ec.TYPE)||yr(t))&&v(t.childNodes).every(Nl)}function Sl(t){return t.parentNode}function Tl(t,e){const n=new bc(e);t.setAttribute(Ec.COLLAPSED,n.toString())}function Il(t){if(t.mathml.length)return nl(t);const e=tl?bl(t):Ac();return t.mathml=[e],e}function Al(t){if(Y(t)!==gr.MFENCED)return t;const e=Ac();for(let n,r=0;n=t.attributes[r];r++)-1===["open","close","separators"].indexOf(n.name)&&e.setAttribute(n.name,n.value);return v(t.childNodes).forEach(function(t){e.appendChild(t)}),F(t,e),e}function bl(t){const e=k("mo"),n=G(t.textContent);return e.appendChild(n),Tc(e,t),e.setAttribute(Ec.ADDED,"true"),e}function Rl(t,e){const n=t.type+(t.textContent?","+t.textContent:"");e.forEach(function(t){Ol(t).setAttribute(Ec.OPERATOR,n)})}function Ol(t){if(Rr(t))return t;const e=v(t.childNodes);if(!e)return t;const n=e.filter(function(t){return!Nl(t)}),r=[];for(let t,e=0;t=n[e];e++)if(Or(t)&&t.getAttribute(Ec.TYPE)!==nt.PUNCTUATION){const e=Ol(t);e&&e!==t&&r.push(e)}else r.push(t);return 1===r.length?r[0]:t}function yl(t){return V(t.toString()).toString().replace(new RegExp(gc,"g"),"")}function Cl(t,e){const n=!!e,r=e||[],o=t.parent,i=t.contentNodes.map(function(t){return t.id});i.unshift("c");const s=[t.id,i];for(let e,i=0;e=t.childNodes[i];i++){const t=nl(e);r.push(t);const i=Ol(t);o&&!n&&i.setAttribute(Ec.PARENT,o.id.toString()),s.push(e.id)}return s}!function(t){t.VALID="valid",t.INVALID="invalid",t.PRUNED="pruned"}(hl||(hl={}));class Ll{constructor(t){this.semantic=t}}class Ml extends Ll{static test(t){return!t.mathmlTree&&t.type===nt.LINE&&t.role===ot.BINOMIAL}constructor(t){super(t),this.mml=t.mathmlTree}getMathml(){if(!this.semantic.childNodes.length)return this.mml;const t=this.semantic.childNodes[0];if(this.mml=nl(t),this.mml.hasAttribute(Ec.TYPE)){const t=Ac();F(this.mml,t),t.appendChild(this.mml),this.mml=t}return Tc(this.mml,this.semantic),this.mml}}class _l extends Ll{static test(t){var e,n;return!!t.getAnnotation("collapsed").length&&(null===(n=null===(e=t.mathmlTree)||void 0===e?void 0:e.parentNode)||void 0===n?void 0:n.childNodes.length)>2}getMathml(){nl(this.semantic.childNodes[0]),nl(this.semantic.childNodes[1]);const t=this.semantic.mathmlTree,e=rl([this.semantic.childNodes[0].mathmlTree,t],this.semantic);return Tc(e,this.semantic),e}}class vl extends Ll{static test(t){if(!t.mathmlTree||!t.childNodes.length)return!1;const e=Y(t.mathmlTree),n=t.childNodes[0].role;return e===gr.MSUBSUP&&n===ot.SUBSUP||e===gr.MUNDEROVER&&n===ot.UNDEROVER}constructor(t){super(t),this.mml=t.mathmlTree}getMathml(){const t=this.semantic.childNodes[0],e=t.childNodes[0],n=this.semantic.childNodes[1],r=t.childNodes[1],o=nl(n),i=nl(e),s=nl(r);return Tc(this.mml,this.semantic),this.mml.setAttribute(Ec.CHILDREN,Sc([e,r,n])),[i,s,o].forEach(t=>Ol(t).setAttribute(Ec.PARENT,this.mml.getAttribute(Ec.ID))),this.mml.setAttribute(Ec.TYPE,t.role),Tl(this.mml,[this.semantic.id,[t.id,e.id,r.id],n.id]),this.mml}}class wl extends Ll{static multiscriptIndex(t){return t.type===nt.PUNCTUATED&&t.contentNodes[0].role===ot.DUMMY&&t.hasAnnotation("general","script")?Cl(t):(nl(t),t.id)}static createNone_(t){const e=k("none");return t&&Tc(e,t),e.setAttribute(Ec.ADDED,"true"),e}constructor(t){super(t),this.mml=t.mathmlTree}completeMultiscript(t,e){const n=v(this.mml.childNodes).slice(1);let r=0;const o=t=>{for(const e of t){const t=n[r];if(t&&e===parseInt(t.getAttribute(Ec.ID)))t.setAttribute(Ec.PARENT,this.semantic.id.toString()),r++;else if(t&&e===parseInt(Ol(t).getAttribute(Ec.ID)))Ol(t).setAttribute(Ec.PARENT,this.semantic.id.toString()),r++;else{const n=this.semantic.querySelectorAll(t=>t.id===e);this.mml.insertBefore(wl.createNone_(n[0]),t||null)}}};o(t),n[r]&&Y(n[r])!==gr.MPRESCRIPTS?this.mml.insertBefore(n[r],k("mprescripts")):r++,o(e)}}class Dl extends wl{static test(t){if(!t.mathmlTree)return!1;return Y(t.mathmlTree)===gr.MMULTISCRIPTS&&(t.type===nt.SUPERSCRIPT||t.type===nt.SUBSCRIPT)}constructor(t){super(t)}getMathml(){let t,e,n;if(Tc(this.mml,this.semantic),this.semantic.childNodes[0]&&this.semantic.childNodes[0].role===ot.SUBSUP){const r=this.semantic.childNodes[0];t=r.childNodes[0],e=wl.multiscriptIndex(this.semantic.childNodes[1]),n=wl.multiscriptIndex(r.childNodes[1]);const o=[this.semantic.id,[r.id,t.id,n],e];Tl(this.mml,o),this.mml.setAttribute(Ec.TYPE,r.role),this.completeMultiscript(bc.interleaveIds(n,e),[])}else{t=this.semantic.childNodes[0],e=wl.multiscriptIndex(this.semantic.childNodes[1]);const n=[this.semantic.id,t.id,e];Tl(this.mml,n)}const r=bc.collapsedLeafs(n||[],e);return Ol(nl(t)).setAttribute(Ec.PARENT,this.semantic.id.toString()),r.unshift(t.id),this.mml.setAttribute(Ec.CHILDREN,r.join(",")),this.mml}}class Pl extends wl{static test(t){return!!t.mathmlTree&&t.type===nt.TENSOR}constructor(t){super(t)}getMathml(){nl(this.semantic.childNodes[0]);const t=wl.multiscriptIndex(this.semantic.childNodes[1]),e=wl.multiscriptIndex(this.semantic.childNodes[2]),n=wl.multiscriptIndex(this.semantic.childNodes[3]),r=wl.multiscriptIndex(this.semantic.childNodes[4]);Tc(this.mml,this.semantic);const o=[this.semantic.id,this.semantic.childNodes[0].id,t,e,n,r];Tl(this.mml,o);const i=bc.collapsedLeafs(t,e,n,r);return i.unshift(this.semantic.childNodes[0].id),this.mml.setAttribute(Ec.CHILDREN,i.join(",")),this.completeMultiscript(bc.interleaveIds(n,r),bc.interleaveIds(t,e)),this.mml}}class xl extends Ll{static test(t){return!(!t.mathmlTree||!t.fencePointer||t.mathmlTree.getAttribute("data-semantic-type"))}static makeEmptyNode_(t){const e=Ac(),n=new Dr(t);return n.type=nt.EMPTY,n.mathmlTree=e,n}static fencedMap_(t,e){e[t.id]=t.mathmlTree,t.embellished&&xl.fencedMap_(t.childNodes[0],e)}constructor(t){super(t),this.fenced=null,this.fencedMml=null,this.fencedMmlNodes=[],this.ofence=null,this.ofenceMml=null,this.ofenceMap={},this.cfence=null,this.cfenceMml=null,this.cfenceMap={},this.parentCleanup=[]}getMathml(){this.getFenced_(),this.fencedMml=nl(this.fenced),this.getFencesMml_(),this.fenced.type!==nt.EMPTY||this.fencedMml.parentNode||(this.fencedMml.setAttribute(Ec.ADDED,"true"),this.cfenceMml.parentNode.insertBefore(this.fencedMml,this.cfenceMml)),this.getFencedMml_();return this.rewrite_()}fencedElement(t){return t.type===nt.FENCED||t.type===nt.MATRIX||t.type===nt.VECTOR}getFenced_(){let t=this.semantic;for(;!this.fencedElement(t);)t=t.childNodes[0];this.fenced=t.childNodes[0],this.ofence=t.contentNodes[0],this.cfence=t.contentNodes[1],xl.fencedMap_(this.ofence,this.ofenceMap),xl.fencedMap_(this.cfence,this.cfenceMap)}getFencedMml_(){let t=this.ofenceMml.nextSibling;for(t=t===this.fencedMml?t:this.fencedMml;t&&t!==this.cfenceMml;)this.fencedMmlNodes.push(t),t=t.nextSibling}getFencesMml_(){let t=this.semantic;const e=Object.keys(this.ofenceMap),n=Object.keys(this.cfenceMap);for(;!(this.ofenceMml&&this.cfenceMml||t===this.fenced);)-1===e.indexOf(t.fencePointer)||this.ofenceMml||(this.ofenceMml=t.mathmlTree),-1===n.indexOf(t.fencePointer)||this.cfenceMml||(this.cfenceMml=t.mathmlTree),t=t.childNodes[0];this.ofenceMml||(this.ofenceMml=this.ofence.mathmlTree),this.cfenceMml||(this.cfenceMml=this.cfence.mathmlTree),this.ofenceMml&&(this.ofenceMml=ml(this.ofenceMml)),this.cfenceMml&&(this.cfenceMml=ml(this.cfenceMml))}rewrite_(){let t=this.semantic,e=null;const n=this.introduceNewLayer_();for(Tc(n,this.fenced.parent);!this.fencedElement(t);){const r=t.mathmlTree,o=this.specialCase_(t,r);if(o)t=o;else{Tc(r,t);const e=[];for(let n,r=1;n=t.childNodes[r];r++)e.push(nl(n));t=t.childNodes[0]}const i=k("dummy"),s=r.childNodes[0];F(r,i),F(n,r),F(r.childNodes[0],n),F(i,s),e||(e=r)}return nl(this.ofence),nl(this.cfence),this.cleanupParents_(),e||n}specialCase_(t,e){const n=Y(e);let r,o=null;if(n===gr.MSUBSUP?(o=t.childNodes[0],r=vl):n===gr.MMULTISCRIPTS&&(t.type===nt.SUPERSCRIPT||t.type===nt.SUBSCRIPT?r=Dl:t.type===nt.TENSOR&&(r=Pl),o=r&&t.childNodes[0]&&t.childNodes[0].role===ot.SUBSUP?t.childNodes[0]:t),!o)return null;const i=o.childNodes[0],s=xl.makeEmptyNode_(i.id);return o.childNodes[0]=s,e=new r(t).getMathml(),o.childNodes[0]=i,this.parentCleanup.push(e),o.childNodes[0]}introduceNewLayer_(){const t=this.fullFence(this.ofenceMml),e=this.fullFence(this.cfenceMml);let n=Ac();if(F(this.fencedMml,n),this.fencedMmlNodes.forEach(t=>n.appendChild(t)),n.insertBefore(t,this.fencedMml),n.appendChild(e),!n.parentNode){const t=Ac();for(;n.childNodes.length>0;)t.appendChild(n.childNodes[0]);n.appendChild(t),n=t}return n}fullFence(t){const e=this.fencedMml.parentNode;let n=t;for(;n.parentNode&&n.parentNode!==e;)n=n.parentNode;return n}cleanupParents_(){this.parentCleanup.forEach(function(t){const e=t.childNodes[1].getAttribute(Ec.PARENT);t.childNodes[0].setAttribute(Ec.PARENT,e)})}}class Ul extends Ll{static test(t){return!!t.mathmlTree&&t.hasAnnotation("Emph","top")}constructor(t){super(t),this.mrows=[],this.mml=t.mathmlTree}getMathml(){if(this.recurseToTable(this.semantic),this.mrows.length){const t=Ac();this.mml.parentNode.insertBefore(t,this.mml);for(const e of this.mrows)t.appendChild(e);t.appendChild(this.mml)}return this.mml}recurseToTable(t){var e,n;if(t.hasAnnotation("Emph","top")||t.hasAnnotation("Emph","fence")||!t.hasAnnotation("Emph","left")&&!t.hasAnnotation("Emph","right")){if(!t.mathmlTree||Y(t.mathmlTree)===gr.MTABLE&&(null===(e=t.annotation.Emph)||void 0===e?void 0:e.length)&&"table"!==t.annotation.Emph[0]){const e=Ac();Tc(e,t),this.mrows.unshift(e)}else{if(Y(t.mathmlTree)===gr.MTABLE&&(null===(n=t.annotation.Emph)||void 0===n?void 0:n.length)&&"table"===t.annotation.Emph[0])return void this.finalizeTable(t);Tc(t.mathmlTree,t)}if(t.childNodes.forEach(this.recurseToTable.bind(this)),t.textContent||"punctuated"===t.type){const e=t.contentNodes.map(t=>{const e=Il(t);return e.hasAttribute("data-semantic-added")?this.mrows.unshift(e):this.recurseToTable(t),e});return void Rl(t,e)}t.contentNodes.forEach(this.recurseToTable.bind(this))}else nl(t)}finalizeTable(t){Tc(t.mathmlTree,t),t.contentNodes.forEach(t=>{nl(t)}),t.childNodes.forEach(t=>{nl(t)})}}class Fl extends Ll{static test(t){if(!t.mathmlTree||!t.childNodes.length)return!1;const e=Y(t.mathmlTree),n=t.type;return(n===nt.LIMUPPER||n===nt.LIMLOWER)&&(e===gr.MSUBSUP||e===gr.MUNDEROVER)||n===nt.LIMBOTH&&(e===gr.MSUB||e===gr.MUNDER||e===gr.MSUP||e===gr.MOVER)}static walkTree_(t){t&&nl(t)}constructor(t){super(t),this.mml=t.mathmlTree}getMathml(){const t=this.semantic.childNodes;return this.semantic.type!==nt.LIMBOTH&&this.mml.childNodes.length>=3&&(this.mml=rl([this.mml],this.semantic)),Tc(this.mml,this.semantic),t[0].mathmlTree||(t[0].mathmlTree=this.semantic.mathmlTree),t.forEach(Fl.walkTree_),this.mml}}class kl extends Ll{static test(t){return!!t.mathmlTree&&t.type===nt.LINE}constructor(t){super(t),this.mml=t.mathmlTree}getMathml(){return this.semantic.contentNodes.length&&nl(this.semantic.contentNodes[0]),this.semantic.childNodes.length&&nl(this.semantic.childNodes[0]),Tc(this.mml,this.semantic),this.mml}}class Bl extends Ll{static test(t){return!!t.mathmlTree&&(t.type===nt.INFERENCE||t.type===nt.PREMISES)}constructor(t){super(t),this.mml=t.mathmlTree}getMathml(){return this.semantic.childNodes.length?(this.semantic.contentNodes.forEach(function(t){nl(t),Tc(t.mathmlTree,t)}),this.semantic.childNodes.forEach(function(t){nl(t)}),Tc(this.mml,this.semantic),this.mml.getAttribute("data-semantic-id")===this.mml.getAttribute("data-semantic-parent")&&this.mml.removeAttribute("data-semantic-parent"),this.mml):this.mml}}class Gl extends Ll{static test(t){return t.type===nt.MATRIX||t.type===nt.VECTOR||t.type===nt.CASES}constructor(t){super(t),this.inner=[],this.mml=t.mathmlTree}getMathml(){const t=Il(this.semantic.contentNodes[0]),e=this.semantic.contentNodes[1]?Il(this.semantic.contentNodes[1]):null;if(this.inner=this.semantic.childNodes.map(nl),this.mml)if(Y(this.mml)===gr.MFENCED){const n=this.mml.childNodes;this.mml.insertBefore(t,n[0]||null),e&&this.mml.appendChild(e),this.mml=Al(this.mml)}else{const n=[t,this.mml];e&&n.push(e),this.mml=rl(n,this.semantic)}else this.mml=rl([t].concat(this.inner,[e]),this.semantic);return Tc(this.mml,this.semantic),this.mml}}class Vl extends Ll{static test(t){return t.type===nt.PUNCTUATED&&(t.role===ot.TEXT||t.contentNodes.every(t=>t.role===ot.DUMMY))}constructor(t){super(t),this.mml=t.mathmlTree}getMathml(){const t=[],e=Cl(this.semantic,t);return this.mml=rl(t,this.semantic),Tc(this.mml,this.semantic),this.mml.removeAttribute(Ec.CONTENT),Tl(this.mml,e),this.mml}}function Hl(t,e){const n=X(t);return function(t,e,n){return g.getInstance().generate(()=>["Original MathML",yl(t)]),el.clear(),nl(e.root),n.structure&&t.setAttribute(Ec.STRUCTURE,bc.fromStructure(t,e,n).toString()),g.getInstance().generate(()=>["Semantic Tree\n",yl(e),"Semantically enriched MathML\n",yl(t)]),t}(n,Jc(n,e),e)}Zc.push({test:Fl.test,constr:t=>new Fl(t)},{test:xl.test,constr:t=>new xl(t)},{test:_l.test,constr:t=>new _l(t)},{test:vl.test,constr:t=>new vl(t)},{test:Pl.test,constr:t=>new Pl(t)},{test:Dl.test,constr:t=>new Dl(t)},{test:kl.test,constr:t=>new kl(t)},{test:Ml.test,constr:t=>new Ml(t)},{test:Bl.test,constr:t=>new Bl(t)},{test:Ul.test,constr:t=>new Ul(t)},{test:Gl.test,constr:t=>new Gl(t)},{test:Vl.test,constr:t=>new Vl(t)});let jl=0;class ql{constructor(){this.counter=jl++,this.ATTR="sre-highlight-"+this.counter.toString(),this.color=null,this.mactionName="",this.currentHighlights=[]}highlight(t){this.currentHighlights.push(t.map(t=>{const e=this.highlightNode(t);return this.setHighlighted(t),e}))}highlightAll(t){const e=this.getMactionNodes(t);for(let t,n=0;t=e[n];n++)this.highlight([t])}unhighlight(){const t=this.currentHighlights.pop();t&&t.forEach(t=>{this.isHighlighted(t.node)&&(this.unhighlightNode(t),this.unsetHighlighted(t.node))})}unhighlightAll(){for(;this.currentHighlights.length>0;)this.unhighlight()}setColor(t){this.color=t}colorString(){return this.color.rgba()}addEvents(t,e){const n=this.getMactionNodes(t);for(let t,r=0;t=n[r];r++)for(const[n,r]of Object.entries(e))t.addEventListener(n,r)}getMactionNodes(t){return Array.from(t.getElementsByClassName(this.mactionName))}isMactionNode(t){const e=t.className||t.getAttribute("class");return!!e&&!!e.match(new RegExp(this.mactionName))}isHighlighted(t){return t.hasAttribute(this.ATTR)}setHighlighted(t){t.setAttribute(this.ATTR,"true")}unsetHighlighted(t){t.removeAttribute(this.ATTR)}colorizeAll(t){_(t);M(`.//*[@${Ec.ID}]`,t).forEach(t=>this.colorize(t))}uncolorizeAll(t){M(`.//*[@${Ec.ID}]`,t).forEach(t=>this.uncolorize(t))}colorize(t){const e=Ic("foreground");t.hasAttribute(e)&&(t.setAttribute(e+"-old",t.style.color),t.style.color=t.getAttribute(e))}uncolorize(t){const e=Ic("foreground")+"-old";t.hasAttribute(e)&&(t.style.color=t.getAttribute(e))}}class $l extends ql{constructor(){super(),this.mactionName="mjx-maction"}highlightNode(t){const e={node:t,background:t.style.backgroundColor,foreground:t.style.color};if(!this.isHighlighted(t)){const e=this.colorString();t.style.backgroundColor=e.background,t.style.color=e.foreground}return e}unhighlightNode(t){t.node.style.backgroundColor=t.background,t.node.style.color=t.foreground}}const Yl={red:{red:255,green:0,blue:0},green:{red:0,green:255,blue:0},blue:{red:0,green:0,blue:255},yellow:{red:255,green:255,blue:0},cyan:{red:0,green:255,blue:255},magenta:{red:255,green:0,blue:255},white:{red:255,green:255,blue:255},black:{red:0,green:0,blue:0}};function Xl(t,e){const n=t||{color:e};let r=Object.prototype.hasOwnProperty.call(n,"color")?Yl[n.color]:n;return r||(r=Yl[e]),r.alpha=Object.prototype.hasOwnProperty.call(n,"alpha")?n.alpha:1,function(t){const e=t=>(t=Math.max(t,0),t=Math.min(255,t),Math.round(t));return t.red=e(t.red),t.green=e(t.green),t.blue=e(t.blue),t.alpha=Math.max(t.alpha,0),t.alpha=Math.min(1,t.alpha),t}(r)}class Wl{static toHex(t){const e=t.toString(16);return 1===e.length?"0"+e:e}constructor(t,e){this.foreground=Xl(e,Wl.DEFAULT_FOREGROUND_),this.background=Xl(t,Wl.DEFAULT_BACKGROUND_)}rgba(){const t=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"};return{background:t(this.background),foreground:t(this.foreground)}}rgb(){const t=function(t){return"rgb("+t.red+","+t.green+","+t.blue+")"};return{background:t(this.background),alphaback:this.background.alpha.toString(),foreground:t(this.foreground),alphafore:this.foreground.alpha.toString()}}hex(){const t=function(t){return"#"+Wl.toHex(t.red)+Wl.toHex(t.green)+Wl.toHex(t.blue)};return{background:t(this.background),alphaback:this.background.alpha.toString(),foreground:t(this.foreground),alphafore:this.foreground.alpha.toString()}}}Wl.DEFAULT_BACKGROUND_="blue",Wl.DEFAULT_FOREGROUND_="black";class Kl{constructor(){this.hue=10,this.sat=100,this.light=50,this.incr=50}generate(){return e=function(t,e,n){e=e>1?e/100:e,n=n>1?n/100:n;const r=(1-Math.abs(2*n-1))*e,o=r*(1-Math.abs(t/60%2-1)),i=n-r/2;let s=0,a=0,c=0;return 0<=t&&t<60?[s,a,c]=[r,o,0]:60<=t&&t<120?[s,a,c]=[o,r,0]:120<=t&&t<180?[s,a,c]=[0,r,o]:180<=t&&t<240?[s,a,c]=[0,o,r]:240<=t&&t<300?[s,a,c]=[o,0,r]:300<=t&&t<360&&([s,a,c]=[r,0,o]),{red:s+i,green:a+i,blue:c+i}}(this.hue,this.sat,this.light),"rgb("+(t={red:Math.round(255*e.red),green:Math.round(255*e.green),blue:Math.round(255*e.blue)}).red+","+t.green+","+t.blue+")";var t,e}increment(){this.hue=(this.hue+this.incr)%360}}class zl extends ql{constructor(){super(),this.mactionName="mjx-svg-maction"}highlightNode(t){let e;if(this.isHighlighted(t))return e={node:t.previousSibling||t,background:t.style.backgroundColor,foreground:t.style.color},e;if("svg"===t.tagName){const e={node:t,background:t.style.backgroundColor,foreground:t.style.color};return t.style.backgroundColor=this.colorString().background,t.style.color=this.colorString().foreground,e}const n=B("http://www.w3.org/2000/svg","rect");let r;if("use"===t.nodeName){const e=B("http://www.w3.org/2000/svg","g");t.parentNode.insertBefore(e,t),e.appendChild(t),r=e.getBBox(),e.parentNode.replaceChild(t,e)}else r=t.getBBox();n.setAttribute("x",(r.x-40).toString()),n.setAttribute("y",(r.y-40).toString()),n.setAttribute("width",(r.width+80).toString()),n.setAttribute("height",(r.height+80).toString());const o=t.getAttribute("transform");return o&&n.setAttribute("transform",o),n.setAttribute("fill",this.colorString().background),n.setAttribute(this.ATTR,"true"),t.parentNode.insertBefore(n,t),e={node:n,foreground:t.getAttribute("fill")},t.setAttribute("fill",this.colorString().foreground),e}setHighlighted(t){"svg"===t.tagName&&super.setHighlighted(t)}unhighlightNode(t){if("background"in t)return t.node.style.backgroundColor=t.background,void(t.node.style.color=t.foreground);t.foreground?t.node.nextSibling.setAttribute("fill",t.foreground):t.node.nextSibling.removeAttribute("fill"),t.node.parentNode.removeChild(t.node)}isMactionNode(t){let e=t.className||t.getAttribute("class");return!!e&&(e=void 0!==e.baseVal?e.baseVal:e,!!e&&!!e.match(new RegExp(this.mactionName)))}}const Ql={SVG:zl,"SVG-V3":class extends zl{constructor(){super(),this.mactionName="maction"}highlightNode(e){let n;if(this.isHighlighted(e))return n={node:e,background:this.colorString().background,foreground:this.colorString().foreground},n;if("svg"===e.tagName||"MJX-CONTAINER"===e.tagName)return n={node:e,background:e.style.backgroundColor,foreground:e.style.color},e.style.backgroundColor=this.colorString().background,e.style.color=this.colorString().foreground,n;const r=(null!==document&&void 0!==document?document:t).createElementNS("http://www.w3.org/2000/svg","rect");r.setAttribute("sre-highlighter-added","true");const o=e.getBBox();r.setAttribute("x",(o.x-40).toString()),r.setAttribute("y",(o.y-40).toString()),r.setAttribute("width",(o.width+80).toString()),r.setAttribute("height",(o.height+80).toString());const i=e.getAttribute("transform");if(i&&r.setAttribute("transform",i),r.setAttribute("fill",this.colorString().background),e.setAttribute(this.ATTR,"true"),e.parentNode.insertBefore(r,e),n={node:e,foreground:e.getAttribute("fill")},"rect"===e.nodeName){const t=new Wl({alpha:0,color:"white"});e.setAttribute("fill",t.rgba().background)}else e.setAttribute("fill",this.colorString().foreground);return n}unhighlightNode(t){const e=t.node.previousSibling;if(e&&e.hasAttribute("sre-highlighter-added"))return t.foreground?t.node.setAttribute("fill",t.foreground):t.node.removeAttribute("fill"),void t.node.parentNode.removeChild(e);t.node.style.backgroundColor=t.background,t.node.style.color=t.foreground}isMactionNode(t){return t.getAttribute("data-mml-node")===this.mactionName}getMactionNodes(t){return Array.from(M(`.//*[@data-mml-node="${this.mactionName}"]`,t))}},NativeMML:class extends ql{constructor(){super(),this.mactionName="maction"}highlightNode(t){let e=t.getAttribute("style");return e+=";background-color: "+this.colorString().background,e+=";color: "+this.colorString().foreground,t.setAttribute("style",e),{node:t}}unhighlightNode(t){let e=t.node.getAttribute("style");e=e.replace(";background-color: "+this.colorString().background,""),e=e.replace(";color: "+this.colorString().foreground,""),t.node.setAttribute("style",e)}colorString(){return this.color.rgba()}getMactionNodes(t){return Array.from(t.getElementsByTagName(this.mactionName))}isMactionNode(t){return t.tagName===this.mactionName}},"HTML-CSS":class extends ql{constructor(){super(),this.mactionName="maction"}highlightNode(t){const e={node:t,foreground:t.style.color,position:t.style.position},n=this.color.rgb();t.style.color=n.foreground,t.style.position="relative";const r=t.bbox;if(r&&r.w){const o=.05,i=0,s=k("span"),a=parseFloat(t.style.paddingLeft||"0");s.style.backgroundColor=n.background,s.style.opacity=n.alphaback.toString(),s.style.display="inline-block",s.style.height=r.h+r.d+2*o+"em",s.style.verticalAlign=-r.d+"em",s.style.marginTop=s.style.marginBottom=-o+"em",s.style.width=r.w+2*i+"em",s.style.marginLeft=a-i+"em",s.style.marginRight=-r.w-i-a+"em",t.parentNode.insertBefore(s,t),e.box=s}return e}unhighlightNode(t){const e=t.node;e.style.color=t.foreground,e.style.position=t.position,t.box&&t.box.parentNode.removeChild(t.box)}},"MML-CSS":class extends $l{constructor(){super(),this.mactionName="maction"}getMactionNodes(t){return Array.from(t.getElementsByTagName(this.mactionName))}isMactionNode(t){return t.tagName===this.mactionName}},CommonHTML:$l,CHTML:class extends $l{constructor(){super()}isMactionNode(t){var e;return(null===(e=t.tagName)||void 0===e?void 0:e.toUpperCase())===this.mactionName.toUpperCase()}getMactionNodes(t){return Array.from(t.getElementsByTagName(this.mactionName))}}};function Jl(t){return t?t.split(/,/):[]}function Zl(t,e){return t.getAttribute(e)}function tu(t){if(t.hasAttribute(Ec.TYPE)&&!t.hasAttribute(Ec.PARENT))return t;const e=j(t,Ec.TYPE);for(let t,n=0;t=e[n];n++)if(!t.hasAttribute(Ec.PARENT))return t;return t}function eu(t,e){return t.getAttribute(Ec.ID)===e?t:q(t,Ec.ID,e)[0]}function nu(t,e){return t.getAttribute(Ec.ID)===e?[t]:q(t,Ec.ID,e)}class ru{static textContent(t,e,n){if(!n&&e.textContent)return void(t.textContent=e.textContent);const r=Jl(Zl(e,Ec.OPERATOR));r.length>1&&(t.textContent=r[1])}static isPunctuated(t){return!bc.simpleCollapseStructure(t)&&t[1]&&bc.contentCollapseStructure(t[1])}constructor(t){if(this.mathml=t,this.factory=new Pr,this.nodeDict={},this.mmlRoot=tu(t),this.streeRoot=this.assembleTree(this.mmlRoot),isNaN(this.streeRoot.id))throw new I(`Failed to rebuild semantic tree for\n ${t}`);this.stree=Kc.fromNode(this.streeRoot,this.mathml),this.xml=this.stree.xml()}getTree(){return this.stree}assembleTree(t){const e=this.makeNode(t),n=Jl(Zl(t,Ec.CHILDREN)),r=Jl(Zl(t,Ec.CONTENT));if(0===r.length&&0===n.length)return ru.textContent(e,t,this.isEmpty(e,t)),e;if(r.length>0){const t=eu(this.mathml,r[0]);t&&ru.textContent(e,t,!0)}e.contentNodes=r.map(t=>this.setParent(t,e)),e.childNodes=n.map(t=>this.setParent(t,e));const o=Zl(t,Ec.COLLAPSED);return o?this.postProcess(e,o):e}makeNode(t){const e=Zl(t,Ec.TYPE),n=Zl(t,Ec.ROLE),r=Zl(t,Ec.FONT),o=Zl(t,Ec.ANNOTATION)||"",i=Zl(t,Ec.ATTRIBUTES)||"",s=Zl(t,Ec.ID),a=Zl(t,Ec.EMBELLISHED),c=Zl(t,Ec.FENCEPOINTER),l=this.createNode(parseInt(s,10));return l.type=e,l.role=n,l.font=r||st.UNKNOWN,l.parseAnnotation(o),l.parseAttributes(i),c&&(l.fencePointer=c),a&&(l.embellished=a),l}makePunctuation(t){const e=this.createNode(t);return e.updateContent(en.invisibleComma),e.role=ot.DUMMY,e}makePunctuated(t,e,n){const r=this.createNode(e[0]);r.type=nt.PUNCTUATED,r.embellished=t.embellished,r.fencePointer=t.fencePointer,r.role=n,r.addAnnotation("general","script");const o=e.splice(1,1)[0].slice(1);r.contentNodes=o.map(this.makePunctuation.bind(this)),this.collapsedChildren_(e)}makeEmpty(t,e,n){const r=this.createNode(e);r.type=nt.EMPTY,r.embellished=t.embellished,r.fencePointer=t.fencePointer,r.role=n}makeIndex(t,e,n){if(ru.isPunctuated(e))return this.makePunctuated(t,e,n),void(e=e[0]);bc.simpleCollapseStructure(e)&&!this.nodeDict[e.toString()]&&this.makeEmpty(t,e,n)}postProcess(t,e){const n=bc.fromString(e).array;if(t.type===ot.SUBSUP){const e=this.createNode(n[1][0]);return e.type=nt.SUBSCRIPT,e.role=ot.SUBSUP,t.type=nt.SUPERSCRIPT,e.embellished=t.embellished,e.fencePointer=t.fencePointer,this.makeIndex(t,n[1][2],ot.RIGHTSUB),this.makeIndex(t,n[2],ot.RIGHTSUPER),this.collapsedChildren_(n),t}if(t.type===nt.SUBSCRIPT)return this.makeIndex(t,n[2],ot.RIGHTSUB),this.collapsedChildren_(n),t;if(t.type===nt.SUPERSCRIPT)return this.makeIndex(t,n[2],ot.RIGHTSUPER),this.collapsedChildren_(n),t;if(t.type===nt.TENSOR)return this.makeIndex(t,n[2],ot.LEFTSUB),this.makeIndex(t,n[3],ot.LEFTSUPER),this.makeIndex(t,n[4],ot.RIGHTSUB),this.makeIndex(t,n[5],ot.RIGHTSUPER),this.collapsedChildren_(n),t;if(t.type===nt.PUNCTUATED){if(ru.isPunctuated(n)){const e=n.splice(1,1)[0].slice(1);t.contentNodes=e.map(this.makePunctuation.bind(this))}return t}if(t.type===ot.UNDEROVER){const e=this.createNode(n[1][0]);return t.childNodes[1].role===ot.OVERACCENT?(e.type=nt.OVERSCORE,t.type=nt.UNDERSCORE):(e.type=nt.UNDERSCORE,t.type=nt.OVERSCORE),e.role=ot.UNDEROVER,e.embellished=t.embellished,e.fencePointer=t.fencePointer,this.collapsedChildren_(n),t}return t}createNode(t){const e=this.factory.makeNode(t);return this.nodeDict[t.toString()]=e,e}collapsedChildren_(t){const e=t=>{const n=this.nodeDict[t[0]];n.childNodes=[];for(let r=1,o=t.length;r<o;r++){const o=t[r];n.childNodes.push(bc.simpleCollapseStructure(o)?this.nodeDict[o]:e(o))}return n};e(t)}setParent(t,e){const n=eu(this.mathml,t),r=this.assembleTree(n);return r.parent=e,r}isEmpty(t,e){return t.type===nt.EMPTY||(t.type===nt.TEXT||t.role===ot.SPACE)&&"MPHANTOM"===e.tagName.toUpperCase()}}const ou=new i({AbsoluteValue:["Auto","AbsEnd","Cardinality","Determinant"],Bar:["Auto","Conjugate"],Caps:["Auto","SayCaps"],CombinationPermutation:["Auto","ChoosePermute"],Currency:["Auto","Position","Prefix"],Ellipses:["Auto","AndSoOn"],Enclosed:["Auto","EndEnclose"],Exponent:["Auto","AfterPower","Ordinal","OrdinalPower","Exponent"],Fraction:["Auto","EndFrac","FracOver","General","GeneralEndFrac","Ordinal","Over","OverEndFrac","Per"],Functions:["Auto","None","Reciprocal"],Inference:["Auto","Long"],ImpliedTimes:["Auto","MoreImpliedTimes","None"],Log:["Auto","LnAsNaturalLog"],Matrix:["Auto","Combinatoric","EndMatrix","EndVector","SilentColNum","SpeakColNum","Vector"],MultiLineLabel:["Auto","Case","Constraint","Equation","Line","None","Row","Step"],MultiLineOverview:["Auto","None"],MultiLinePausesBetweenColumns:["Auto","Long","Short"],MultsymbolDot:["Auto","Dot"],MultsymbolX:["Auto","By","Cross"],Paren:["Auto","CoordPoint","Interval","Silent","Speak","SpeakNestingLevel"],Prime:["Auto","Angle","Length"],Roots:["Auto","PosNegSqRoot","PosNegSqRootEnd","RootEnd"],SetMemberSymbol:["Auto","Belongs","Element","Member","In"],Sets:["Auto","SilentBracket","woAll"],TriangleSymbol:["Auto","Delta"],Trig:["Auto","ArcTrig","TrigInverse","Reciprocal"],VerticalLine:["Auto","Divides","Given","SuchThat"]}),iu="Auto";function su(t){const e=t.split(":"),n={},r=ou.getProperties(),o=Object.keys(r);for(let t,i=0;t=e[i];i++){const e=t.split("_");if(-1===o.indexOf(e[0]))continue;const i=e[1];i&&i!==iu&&-1!==r[e[0]].indexOf(i)&&(n[e[0]]=e[1])}return n}function au(t){const e=Object.keys(t),n=[];for(let r=0;r<e.length;r++)n.push(e[r]+"_"+t[e[r]]);return n.length?n.join(":"):s.DEFAULT_VALUE}class cu extends s{static comparator(){return new lu(A.getInstance().dynamicCstr,i.createProp([s.DEFAULT_VALUES[e.LOCALE]],[s.DEFAULT_VALUES[e.MODALITY]],[s.DEFAULT_VALUES[e.DOMAIN]],[s.DEFAULT_VALUES[e.STYLE]]))}static getLocalePreferences(t){const e=t||Dn($a.getInstance().enumerate());return cu.getLocalePreferences_(e)}static relevantPreferences(t){const e=hu[t.type];if(!e)return"ImpliedTimes";const n=e[t.role]||e[""];return n?"string"==typeof n?n:function(t,e){for(const[n,r]of Object.entries(t))if(du(n,e))return r;return""}(n,t)||"ImpliedTimes":"ImpliedTimes"}static getLocalePreferences_(t){const e={};for(const n of Object.keys(t)){if(!t[n].speech||!t[n].speech.clearspeak)continue;const r=Object.keys(t[n].speech.clearspeak);if(r.length<3)continue;const o=e[n]={};for(const t in ou.getProperties()){const e=ou.getProperties()[t],n=[t+"_Auto"];if(e)for(const o of e)-1!==r.indexOf(t+"_"+o)&&n.push(t+"_"+o);o[t]=n}}return e}constructor(t,e){super(t),this.preference=e}equal(t){if(!super.equal(t))return!1;const e=Object.keys(this.preference),n=t.preference;if(e.length!==Object.keys(n).length)return!1;for(let t,r=0;t=e[r];r++)if(this.preference[t]!==n[t])return!1;return!0}}class lu extends c{constructor(t,e){super(t,e),this.preference=t instanceof cu?t.preference:{}}match(t){if(!(t instanceof cu))return super.match(t);if("default"===t.getComponents()[e.STYLE])return!0;const n=Object.keys(t.preference);for(let e,r=0;e=n[r];r++)if(this.preference[e]!==t.preference[e])return!1;return!0}compare(t,e){const n=super.compare(t,e);if(0!==n)return n;const r=t instanceof cu,o=e instanceof cu;if(!r&&o)return 1;if(r&&!o)return-1;if(!r&&!o)return 0;const i=Object.keys(t.preference).length,s=Object.keys(e.preference).length;return i>s?-1:i<s?1:0}}const uu=[["AbsoluteValue",nt.FENCED,ot.NEUTRAL],["AbsoluteValue",nt.FENCED,ot.METRIC],["Bar",nt.OVERSCORE,""],["Caps",nt.IDENTIFIER,ot.LATINLETTER,"category:Lu"],["CombinationPermutation",nt.APPL,ot.UNKNOWN],["Currency",nt.IDENTIFIER,ot.UNIT,"unit:currency"],["Currency",nt.INFIXOP,ot.UNIT,"unit:currency"],["Enclosed",nt.ENCLOSE,""],["Ellipses",nt.PUNCTUATION,ot.ELLIPSIS],["Exponent",nt.SUPERSCRIPT,""],["Fraction",nt.FRACTION,""],["Functions",nt.APPL,ot.SIMPLEFUNC],["ImpliedTimes",nt.OPERATOR,ot.IMPLICIT],["Log",nt.APPL,ot.PREFIXFUNC,"appl:Logarithm"],["Log",nt.FUNCTION,ot.PREFIXFUNC,"category:Logarithm"],["Matrix",nt.MATRIX,""],["Matrix",nt.VECTOR,""],["MultiLineLabel",nt.ROW,""],["MultiLineLabel",nt.MULTILINE,ot.LABEL],["MultiLinePausesBetweenColumns",nt.MULTILINE,ot.TABLE],["MultiLineOverview",nt.MULTILINE,""],["MultiLineLabel",nt.TABLE,ot.LABEL],["MultiLinePausesBetweenColumns",nt.TABLE,""],["MultiLineOverview",nt.TABLE,""],["MultiLineLabel",nt.CASES,ot.LABEL],["MultiLinePausesBetweenColumns",nt.CASES,""],["MultiLineOverview",nt.CASES,""],["MultsymbolDot",nt.OPERATOR,ot.MULTIPLICATION,"content:22C5"],["MultsymbolX",nt.OPERATOR,ot.MULTIPLICATION,"content:00D7"],["Paren",nt.FENCED,ot.LEFTRIGHT],["Prime",nt.PUNCTUATION,ot.PRIME],["Roots",nt.ROOT,""],["Roots",nt.SQRT,""],["SetMemberSymbol",nt.OPERATOR,ot.ELEMENT],["Sets",nt.FENCED,ot.SETEXT],["TriangleSymbol",nt.IDENTIFIER,ot.GREEKLETTER,"content:0394"],["Trig",nt.APPL,ot.PREFIXFUNC,"appl:Trigonometric"],["Trig",nt.FUNCTION,ot.PREFIXFUNC,"category:Trigonometric"],["VerticalLine",nt.PUNCTUATED,ot.VBAR],["VerticalLine",nt.PUNCTUATION,ot.VBAR],["Inference",nt.INFERENCE,""],["Inference",nt.PREMISES,""],["Inference",nt.RULELABEL,""],["Inference",nt.CONCLUSION,""]],hu=function(){const t={};for(let e,n=0;e=uu[n];n++){const n=e[0],r=e[3];let o=t[e[1]];if(o||(o={},t[e[1]]=o),!r){o[e[2]]=n;continue}let i=o[e[2]];i||(i={},o[e[2]]=i),i[r]=n}return t}();function du(t,e){const[n,r]=t.split(":");if(!n)return!1;const o=pu[n];return!!o&&o(e,r)}const pu={category:(t,e)=>wn(t.textContent)===e,content:(t,e)=>t.textContent===String.fromCodePoint(parseInt(e,16)),appl:(t,e)=>{const n=t.childNodes[0];return!!n&&wn(n.textContent)===e},unit:(t,e)=>wn(t.textContent+":unit")===e};function fu(t,e=!1){return $a.getInstance().evaluateNode(t,e)}function mu(t,e=!1){return Ha(fu(t,e))}function gu(t){const e=function(t){return fu(Kc.fromNode(t).xml())}(t);return Ha(e)}function Eu(t,e,n){const r=q(n,"id",e.id.toString())[0],o=r?Ha(fu(r)):gu(e);t.setAttribute(Ec.SPEECH,o)}function Nu(t,e,n){const r=gu(e);t.setAttribute(n,r)}function Su(t,e){const n=Tu(e);n&&t.setAttribute(Ec.PREFIX,n)}function Tu(t){const e=function(t){const e=Kc.fromRoot(t),n=M('.//*[@id="'+t.id+'"]',e.xml());let r=n[0];n.length>1&&(r=function(t,e){const n=e[0];if(!t.parent)return n;const r=[];for(;t;)r.push(t.id),t=t.parent;const o=function(t,e){for(;e.length&&e.shift().toString()===t.getAttribute("id")&&t.parentNode&&t.parentNode.parentNode;)t=t.parentNode.parentNode;return!e.length};for(let t,n=0;t=e[n];n++)if(o(t,r.slice()))return t;return n}(t,n)||r);return r}(t);return Ha(Iu(e))}function Iu(t){return t?$a.getInstance().runInSetting({modality:"prefix",strict:!0,speech:!0},function(){return $a.getInstance().evaluateNode(t)}):[]}function Au(t,e,n){const r=$(e,"maction");for(let e,o=0;e=r[o];o++){const r=q(t,"id",e.getAttribute("id"))[0];if(!r)continue;const o=e.childNodes[1],i=o.getAttribute(Ec.ID);let s=eu(t,i);if(s&&"dummy"!==s.getAttribute(Ec.TYPE))continue;if(s=r.childNodes[0],s.getAttribute("sre-highlighter-added"))continue;const a=o.getAttribute(Ec.PARENT);a&&s.setAttribute(Ec.PARENT,a),s.setAttribute(Ec.TYPE,"dummy"),s.setAttribute(Ec.ID,i),s.setAttribute("role","treeitem"),s.setAttribute("aria-level",o.getAttribute("aria-level"));q(n,"id",i)[0].setAttribute("alternative",i)}}var bu;function Ru(t){const e={};for(const[,n]of Object.entries(bu))e[n]=t.getAttribute(n);return e}function Ou(t,e){const n=$(t,"maction"),r={};for(let t,o=0;t=n[o];o++){const n=parseInt(t.getAttribute("selection")),o=Array.from(t.childNodes),i=o.filter(t=>t.hasAttribute(bu.ID))[0],s=o[n-1];if(!i||i===s)continue;const a=i.getAttribute(Ec.ID);q(e,"id",a)[0].setAttribute("alternative",a),r[t.getAttribute("id")]=Ru(i)}return r}function yu(t,e={}){const n=e.locale?{locale:e.locale}:{};return t?$a.getInstance().runInSetting(Object.assign(n,{modality:"summary",strict:!1,speech:!0}),function(){return $a.getInstance().evaluateNode(t)}):[]}function Cu(t){const e=[];return t.getAttribute("role")===ot.MGLYPH&&e.push(new kn({text:"image",personality:{}})),t.hasAttribute("href")&&e.push(new kn({text:"link",personality:{}})),$a.getInstance().speechStructure.addNode(t,e,"postfix"),e}function Lu(t){fu(t,!0);const e=$a.getInstance().speechStructure;return function(t){t.completeModality("speech",fu),t.completeModality("prefix",Iu),t.completeModality("postfix",Cu),t.completeModality("summary",yu)}(e),e.json(["none","ssml"])}function Mu(t,e=d){var n;if("speech"!==t.modality)return t;return cu.getLocalePreferences()[t.locale]?(t.domain="mathspeak"===t.domain?"clearspeak":"mathspeak",t.style=null!==(n=e[t.domain])&&void 0!==n?n:t.style,t):t}function _u(t,e){const{modality:n,domain:r,style:o,locale:i}=e;if("speech"!==n)return o;if("mathspeak"===r){const t=["default","brief","sbrief"],e=t.indexOf(o);return-1===e?o:e>=t.length-1?t[0]:t[e+1]}if("clearspeak"===r){const e=cu.getLocalePreferences()[i];if(!e)return"default";const n=cu.relevantPreferences(t),r=function(t,e){return"default"===t?iu:su(t)[e]||iu}(o,n),s=e[n].map(function(t){return t.split("_")[1]}),a=s.indexOf(r);if(-1===a)return o;const c=function(t,e,n){if("default"===t)return e+"_"+n;const r=su(t);return r[e]=n,au(r)}(o,n,a>=s.length-1?s[0]:s[a+1]);return c}return o}function vu(t){var e;const{domain:n,style:r,domain2style:o}=t,i={};if(!o)return Object.assign(i,d),i[n]=r,i;const s=o.split(",");for(const t of s){const[n,r]=t.split(/:(.*)/);i[n]=r||(null!==(e=d[n])&&void 0!==e?e:"default")}return i}function wu(t){const e=[];for(const[n,r]of Object.entries(t))e.push(`${n}:${r}`);return e.join(",")}A.getInstance().comparators.clearspeak=cu.comparator,A.getInstance().parsers.clearspeak=new class extends a{constructor(){super([e.LOCALE,e.MODALITY,e.DOMAIN,e.STYLE])}parse(t){const n=super.parse(t);let r=n.getValue(e.STYLE);const o=n.getValue(e.LOCALE),i=n.getValue(e.MODALITY);let a={};return r!==s.DEFAULT_VALUE&&(a=this.fromPreference(r),r=this.toPreference(a)),new cu({locale:o,modality:i,domain:"clearspeak",style:r},a)}fromPreference(t){return su(t)}toPreference(t){return au(t)}},function(t){t.ID="data-semantic-id",t.PARENT="data-semantic-parent",t.LEVEL="aria-level",t.POS="aria-posinset",t.ROLE="role"}(bu||(bu={}));class Du{constructor(){this.modality=Ic("speech"),this.rebuilt_=null,this.options_={}}getRebuilt(){return this.rebuilt_}setRebuilt(t){this.rebuilt_=t}computeRebuilt(t,e=!1){return this.rebuilt_&&!e||(this.rebuilt_=new ru(t)),this.rebuilt_}setOptions(t){this.options_=t||{},this.modality=Ic(this.options_.modality||"speech")}setOption(t,e){const n=this.getOptions();n[t]=e,this.setOptions(n)}getOptions(){return this.options_}generateSpeech(t,e){return this.rebuilt_||(this.rebuilt_=new ru(e)),uc(this.options_),mu(this.getRebuilt().xml)}nextRules(){this.setOptions(Mu(this.getOptions()))}nextStyle(t){this.setOption("style",_u(this.getRebuilt().nodeDict[t],this.getOptions()))}getLevel(t){return gt.MESSAGES.navigate.LEVEL+" "+t}getActionable(t){return t?t<0?gt.MESSAGES.navigate.EXPANDABLE:gt.MESSAGES.navigate.COLLAPSIBLE:""}}class Pu extends Du{getSpeech(t,e){const n=this.generateSpeech(t,e);return t.setAttribute(this.modality,n),n}}class xu extends Du{constructor(){super(...arguments),this.modality=Ic("foreground"),this.contrast=new Kl}static visitStree_(t,e,n){if(t.childNodes.length){if(t.contentNodes.length&&("punctuated"===t.type&&t.contentNodes.forEach(t=>n[t.id]=!0),"implicit"!==t.role&&e.push(t.contentNodes.map(t=>t.id))),t.childNodes.length){if("implicit"===t.role){const r=[];let o=[];for(const e of t.childNodes){const t=[];xu.visitStree_(e,t,n),t.length<=2&&r.push(t.shift()),o=o.concat(t)}return e.push(r),void o.forEach(t=>e.push(t))}t.childNodes.forEach(t=>xu.visitStree_(t,e,n))}}else n[t.id]||e.push(t.id)}getSpeech(t,e){return Zl(t,this.modality)}generateSpeech(t,e){return this.getRebuilt()||this.setRebuilt(new ru(w(e))),this.colorLeaves_(t),Zl(t,this.modality)}colorLeaves_(t){const e=[];xu.visitStree_(this.getRebuilt().streeRoot,e,{});for(const n of e){const e=this.contrast.generate();let r=!1;r=Array.isArray(n)?n.map(n=>this.colorLeave_(t,n,e)).reduce((t,e)=>t||e,!1):this.colorLeave_(t,n.toString(),e),r&&this.contrast.increment()}}colorLeave_(t,e,n){const r=eu(t,e);return!!r&&(r.setAttribute(this.modality,n),!0)}}class Uu extends Du{getSpeech(t,e){return Zl(t,this.modality)}}class Fu extends Du{getSpeech(t,e){return""}}class ku extends Du{getSpeech(t,e,n=null){this.getRebuilt()&&Au(t,e,this.getRebuilt().xml);const r=this.generateSpeech(t,e),o=this.getRebuilt().nodeDict;for(const[r,i]of Object.entries(o)){const o=eu(e,r),s=eu(t,r)||n&&eu(n,r);o&&s&&(this.modality&&this.modality!==Ec.SPEECH?Nu(s,i,this.modality):Eu(s,i,this.getRebuilt().xml),this.modality===Ec.SPEECH&&Su(s,i))}return r}}class Bu extends ku{getSpeech(t,e){return super.getSpeech(t,e),Zl(t,this.modality)}}class Gu extends Du{getSpeech(t,e){uc(this.getOptions());const n=t.getAttribute(Ec.ID);Nu(t,this.getRebuilt().streeRoot.querySelectorAll(t=>t.id.toString()===n)[0],this.modality);return t.getAttribute(Ec.SUMMARY)}}function Vu(t){return(Hu[t]||Hu.Direct)()}const Hu={Adhoc:()=>new Pu,Color:()=>new xu,Direct:()=>new Uu,Dummy:()=>new Fu,Node:()=>new Bu,Summary:()=>new Gu,Tree:()=>new ku};class ju{static factory(t,e,n,r){const o=t=>eu(r,t),i=n.nodeDict,s=o(t),a=e.map(o),c=e.map(function(t){return i[t]}),l=new ju(c,i[t]);return l.domNodes=a,l.domPrimary_=s,l.allNodes=ju.generateAllVisibleNodes_(e,a,i,r),l}static generateAllVisibleNodes_(t,e,n,r){let o=[];for(let i=0,s=t.length;i<s;i++){if(e[i]){const n=ju.getAllVisibleNodes([t[i]],r);n.length?o=o.concat(n):o.push(e[i]);continue}const s=n[t[i]];if(!s)continue;const a=s.childNodes.map(t=>t.id.toString()),c=ju.getAllVisibleNodes(a,r);o=o.concat(ju.generateAllVisibleNodes_(a,c,n,r))}return o}static getAllVisibleNodes(t,e){let n=[];for(const r of t)n=n.concat(nu(e,r));return n}constructor(t,e){this.nodes=t,this.primary=e,this.domNodes=[],this.domPrimary_=null,this.allNodes=[]}getSemanticPrimary(){return this.primary}getSemanticNodes(){return this.nodes}getNodes(){return this.allNodes}getDomNodes(){return this.domNodes}getDomPrimary(){return this.domPrimary_}toString(){return"Primary:"+this.domPrimary_+" Nodes:"+this.domNodes}clone(){const t=new ju(this.nodes,this.primary);return t.domNodes=this.domNodes,t.domPrimary_=this.domPrimary_,t.allNodes=this.allNodes,t}}var qu;!function(t){t.UP="up",t.DOWN="down",t.LEFT="left",t.RIGHT="right",t.REPEAT="repeat",t.DEPTH="depth",t.ENTER="enter",t.EXPAND="expand",t.HOME="home",t.SUMMARY="summary",t.DETAIL="detail",t.ROW="row",t.CELL="cell"}(qu||(qu={}));class $u{static resetState(t){delete $u.STATE[t]}static setState(t,e){$u.STATE[t]=e}static getState(t){return $u.STATE[t]}}$u.STATE={};class Yu{constructor(t,e,n,r){this.node=t,this.generator=e,this.highlighter=n,this.modifier=!1,this.keyMapping=new Map([[Qs.UP,this.up.bind(this)],[Qs.DOWN,this.down.bind(this)],[Qs.RIGHT,this.right.bind(this)],[Qs.LEFT,this.left.bind(this)],[Qs.TAB,this.repeat.bind(this)],[Qs.DASH,this.expand.bind(this)],[Qs.SPACE,this.depth.bind(this)],[Qs.HOME,this.home.bind(this)],[Qs.X,this.summary.bind(this)],[Qs.Z,this.detail.bind(this)],[Qs.V,this.virtualize.bind(this)],[Qs.P,this.previous.bind(this)],[Qs.U,this.undo.bind(this)],[Qs.LESS,this.previousRules.bind(this)],[Qs.GREATER,this.nextRules.bind(this)]]),this.cursors=[],this.xml_=null,this.rebuilt_=null,this.focus_=null,this.active_=!1,this.node.id?this.id=this.node.id:this.node.hasAttribute(Yu.SRE_ID_ATTR)?this.id=this.node.getAttribute(Yu.SRE_ID_ATTR):(this.node.setAttribute(Yu.SRE_ID_ATTR,Yu.ID_COUNTER.toString()),this.id=Yu.ID_COUNTER++),this.rootNode=tu(t),this.rootId=this.rootNode.getAttribute(Ec.ID),this.xmlString_=r,this.moved=qu.ENTER}getXml(){return this.xml_||(this.xml_=w(this.xmlString_)),this.xml_}getRebuilt(){return this.rebuilt_||this.rebuildStree(),this.rebuilt_}isActive(){return this.active_}activate(){this.isActive()||this.toggleActive_()}deactivate(){this.isActive()&&($u.setState(this.id,this.primaryId()),this.toggleActive_())}getFocus(t=!1){return null===this.rootId&&this.getRebuilt(),this.focus_||(this.focus_=this.singletonFocus(this.rootId)),t&&this.updateFocus(),this.focus_}setFocus(t){this.focus_=t}getDepth(){return this.levels.depth()-1}isSpeech(){return this.generator.modality===Ec.SPEECH}focusDomNodes(){return this.getFocus().getDomNodes()}focusSemanticNodes(){return this.getFocus().getSemanticNodes()}speech(){const t=this.focusDomNodes();if(!t.length)return"";const e=this.specialMove();if(null!==e)return e;switch(this.moved){case qu.DEPTH:return this.depth_();case qu.SUMMARY:return this.summary_();case qu.DETAIL:return this.detail_();default:{const e=[],n=this.focusSemanticNodes();for(let r=0,o=t.length;r<o;r++){const o=t[r],i=n[r];e.push(o?this.generator.getSpeech(o,this.getXml(),this.node):gu(i))}return this.mergePrefix_(e)}}}move(t){const e=this.keyMapping.get(t);if(!e)return null;const n=e();return!(!n||n===this.getFocus())&&(this.setFocus(n),this.moved===qu.HOME&&(this.levels=this.initLevels()),!0)}up(){return this.moved=qu.UP,this.getFocus()}down(){return this.moved=qu.DOWN,this.getFocus()}left(){return this.moved=qu.LEFT,this.getFocus()}right(){return this.moved=qu.RIGHT,this.getFocus()}repeat(){return this.moved=qu.REPEAT,this.getFocus().clone()}depth(){return this.moved=this.isSpeech()?qu.DEPTH:qu.REPEAT,this.getFocus().clone()}home(){this.moved=qu.HOME;return this.singletonFocus(this.rootId)}getBySemanticId(t){return eu(this.node,t)}primaryId(){return this.getFocus().getSemanticPrimary().id.toString()}expand(){const t=this.getFocus().getDomPrimary(),e=this.actionable_(t);return e?(this.moved=qu.EXPAND,e.dispatchEvent(new Event("click")),this.getFocus().clone()):this.getFocus()}expandable(t){return!!this.actionable_(t)&&0===t.childNodes.length}collapsible(t){return!!this.actionable_(t)&&t.childNodes.length>0}restoreState(){if(!this.highlighter)return;const t=$u.getState(this.id);if(!t)return;let e=this.getRebuilt().nodeDict[t];const n=[];for(;e;)n.push(e.id),e=e.parent;for(n.pop();n.length>0;){this.down();const t=n.pop(),e=this.findFocusOnLevel(t);if(!e)break;this.setFocus(e)}this.moved=qu.ENTER}updateFocus(){this.setFocus(ju.factory(this.getFocus().getSemanticPrimary().id.toString(),this.getFocus().getSemanticNodes().map(t=>t.id.toString()),this.getRebuilt(),this.node))}rebuildStree(){this.rebuilt_=new ru(this.getXml()),this.rootId=this.rebuilt_.stree.root.id.toString(),this.generator.setRebuilt(this.rebuilt_),this.skeleton=bc.fromTree(this.rebuilt_.stree),this.skeleton.populate(),this.focus_=this.singletonFocus(this.rootId),this.levels=this.initLevels(),Au(this.node,this.getXml(),this.rebuilt_.xml)}previousLevel(){const t=this.getFocus().getDomPrimary();return t?Zl(t,Ec.PARENT):this.getFocus().getSemanticPrimary().parent.id.toString()}nextLevel(){const t=this.getFocus().getDomPrimary();let e,n;if(t){e=Jl(Zl(t,Ec.CHILDREN)),n=Jl(Zl(t,Ec.CONTENT));const r=Zl(t,Ec.TYPE),o=Zl(t,Ec.ROLE);return this.combineContentChildren(r,o,n,e)}const r=t=>t.id.toString(),o=this.getRebuilt().nodeDict[this.primaryId()];return e=o.childNodes.map(r),n=o.contentNodes.map(r),0===e.length?[]:this.combineContentChildren(o.type,o.role,n,e)}singletonFocus(t){this.getRebuilt();const e=this.retrieveVisuals(t);return this.focusFromId(t,e)}retrieveVisuals(t){if(!this.skeleton)return[t];const e=parseInt(t,10),n=this.skeleton.subtreeNodes(e);if(!n.length)return[t];n.unshift(e);const r={},o=[];_(this.getXml());for(const t of n)r[t]||(o.push(t.toString()),r[t]=!0,this.subtreeIds(t,r));return o}subtreeIds(t,e){const n=M(`//*[@data-semantic-id="${t}"]`,this.getXml());M("*//@data-semantic-id",n[0]).forEach(t=>e[parseInt(t.textContent,10)]=!0)}focusFromId(t,e){return ju.factory(t,e,this.getRebuilt(),this.node)}summary(){return this.moved=this.isSpeech()?qu.SUMMARY:qu.REPEAT,this.getFocus().clone()}detail(){return this.moved=this.isSpeech()?qu.DETAIL:qu.REPEAT,this.getFocus().clone()}specialMove(){return null}virtualize(t){return this.cursors.push({focus:this.getFocus(),levels:this.levels,undo:t||!this.cursors.length}),this.levels=this.levels.clone(),this.getFocus().clone()}previous(){const t=this.cursors.pop();return t?(this.levels=t.levels,t.focus):this.getFocus()}undo(){let t;do{t=this.cursors.pop()}while(t&&!t.undo);return t?(this.levels=t.levels,t.focus):this.getFocus()}update(t){uc(t).then(()=>Vu("Tree").getSpeech(this.node,this.getXml()))}nextRules(){this.generator.nextRules();const t=this.generator.getOptions();return"speech"!==t.modality?this.getFocus():(this.update(t),this.moved=qu.REPEAT,this.getFocus().clone())}previousRules(){var t;this.generator.nextStyle(null===(t=this.getFocus().getSemanticPrimary())||void 0===t?void 0:t.id.toString());const e=this.generator.getOptions();return"speech"!==e.modality?this.getFocus():(this.update(e),this.moved=qu.REPEAT,this.getFocus().clone())}refocus(){let t,e=this.getFocus();for(;!e.getNodes().length;){t=this.levels.peek();const n=this.up();if(!n)break;this.setFocus(n),e=this.getFocus(!0)}this.levels.push(t),this.setFocus(e)}toggleActive_(){this.active_=!this.active_}mergePrefix_(t,e=[]){const n=this.isSpeech()?this.prefix_():"";n&&t.unshift(n);const r=this.isSpeech()?this.postfix_():"";return r&&t.push(r),ja(function(t){const e=t.map(t=>"string"==typeof t?xn.stringEmpty(t):t),n=Va.get(A.getInstance().options.markup);return n?n.merge(e):t.join()}(e.concat(t)))}prefix_(){const t=this.getFocus().getDomNodes(),e=this.getFocus().getSemanticNodes();return t[0]?Zl(t[0],Ec.PREFIX):Tu(e[0])}postfix_(){const t=this.getFocus().getDomNodes();return t[0]?Zl(t[0],Ec.POSTFIX):""}depth_(){const t=bt.getInstance().getParameter("depth");bt.getInstance().setParameter("depth",!0);const e=this.getFocus().getDomPrimary(),n=this.expandable(e)?gt.MESSAGES.navigate.EXPANDABLE:this.collapsible(e)?gt.MESSAGES.navigate.COLLAPSIBLE:"",r=gt.MESSAGES.navigate.LEVEL+" "+this.getDepth(),o=Tu(this.getFocus().getSemanticNodes()[0]),i=[new kn({text:r,personality:{}}),new kn({text:o,personality:{}}),new kn({text:n,personality:{}})];return bt.getInstance().setParameter("depth",t),ja(Ha(i))}actionable_(t){const e=null==t?void 0:t.parentNode;return e&&this.highlighter.isMactionNode(e)?e:null}summary_(){const t=this.getFocus().getSemanticPrimary().id.toString(),e=function(t,e={}){return Ha(yu(t,e))}(this.getRebuilt().xml.getAttribute("id")===t?this.getRebuilt().xml:q(this.getRebuilt().xml,"id",t)[0]);return this.mergePrefix_([e])}detail_(){const t=this.getFocus().getSemanticPrimary().id.toString(),e=this.getRebuilt().xml.getAttribute("id")===t?this.getRebuilt().xml:q(this.getRebuilt().xml,"id",t)[0],n=e.getAttribute("alternative");e.removeAttribute("alternative");const r=mu(e),o=this.mergePrefix_([r]);return e.setAttribute("alternative",n),o}}Yu.ID_COUNTER=0,Yu.SRE_ID_ATTR="sre-explorer-id";class Xu extends Yu{up(){return null}down(){return null}left(){return null}right(){return null}repeat(){return null}depth(){return null}home(){return null}getDepth(){return 0}initLevels(){return null}combineContentChildren(t,e,n,r){return[]}findFocusOnLevel(t){return null}}class Wu{constructor(){this.level_=[]}push(t){this.level_.push(t)}pop(){return this.level_.pop()}peek(){return this.level_[this.level_.length-1]||null}indexOf(t){const e=this.peek();return e?e.indexOf(t):null}find(t){const e=this.peek();if(!e)return null;for(let n=0,r=e.length;n<r;n++)if(t(e[n]))return e[n];return null}get(t){const e=this.peek();return!e||t<0||t>=e.length?null:e[t]}depth(){return this.level_.length}clone(){const t=new Wu;return t.level_=this.level_.slice(0),t}toString(){let t="";for(let e,n=0;e=this.level_[n];n++)t+="\n"+e.map(function(t){return t.toString()});return t}}class Ku extends Yu{constructor(t,e,n,r){super(t,e,n,r),this.node=t,this.generator=e,this.highlighter=n,this.levels=null,this.restoreState()}initLevels(){const t=new Wu;return t.push([this.getFocus()]),t}up(){super.up();const t=this.previousLevel();if(!t)return null;this.levels.pop();return this.levels.find(function(e){return e.getSemanticNodes().some(function(e){return e.id.toString()===t})})}down(){super.down();const t=this.nextLevel();return 0===t.length?null:(this.levels.push(t),t[0])}combineContentChildren(t,e,n,r){switch(t){case nt.RELSEQ:case nt.INFIXOP:case nt.MULTIREL:return this.makePairList(r,n);case nt.PREFIXOP:return[this.focusFromId(r[0],n.concat(r))];case nt.POSTFIXOP:return[this.focusFromId(r[0],r.concat(n))];case nt.MATRIX:case nt.VECTOR:case nt.FENCED:return[this.focusFromId(r[0],[n[0],r[0],n[1]])];case nt.CASES:return[this.focusFromId(r[0],[n[0],r[0]])];case nt.PUNCTUATED:return e===ot.TEXT?r.map(this.singletonFocus.bind(this)):r.length===n.length?n.map(this.singletonFocus.bind(this)):this.combinePunctuations(r,n,[],[]);case nt.APPL:return[this.focusFromId(r[0],[r[0],n[0]]),this.singletonFocus(r[1])];case nt.ROOT:return[this.singletonFocus(r[0]),this.singletonFocus(r[1])];default:return r.map(this.singletonFocus.bind(this))}}combinePunctuations(t,e,n,r){if(0===t.length)return r;const o=t.shift(),i=e.shift();return o===i?(n.push(i),this.combinePunctuations(t,e,n,r)):(e.unshift(i),n.push(o),t.length===e.length?(r.push(this.focusFromId(o,n.concat(e))),r):(r.push(this.focusFromId(o,n)),this.combinePunctuations(t,e,[],r)))}makePairList(t,e){if(0===t.length)return[];if(1===t.length)return[this.singletonFocus(t[0])];const n=[this.singletonFocus(t.shift())];for(let r=0,o=t.length;r<o;r++)n.push(this.focusFromId(t[r],[e[r],t[r]]));return n}left(){super.left();const t=this.levels.indexOf(this.getFocus());if(null===t)return null;const e=this.levels.get(t-1);return e||null}right(){super.right();const t=this.levels.indexOf(this.getFocus());if(null===t)return null;const e=this.levels.get(t+1);return e||null}findFocusOnLevel(t){return this.levels.find(e=>e.getSemanticPrimary().id===t)}}class zu extends Yu{constructor(t,e,n,r){super(t,e,n,r),this.node=t,this.generator=e,this.highlighter=n,this.levels=null,this.restoreState()}initLevels(){const t=new Wu;return t.push([this.primaryId()]),t}up(){super.up();const t=this.previousLevel();return t?(this.levels.pop(),this.singletonFocus(t)):null}down(){super.down();const t=this.nextLevel();if(0===t.length)return null;const e=this.singletonFocus(t[0]);return e&&this.levels.push(t),e}combineContentChildren(t,e,n,r){switch(t){case nt.RELSEQ:case nt.INFIXOP:case nt.MULTIREL:return ir(r,n);case nt.PREFIXOP:return n.concat(r);case nt.POSTFIXOP:return r.concat(n);case nt.MATRIX:case nt.VECTOR:case nt.FENCED:return r.unshift(n[0]),r.push(n[1]),r;case nt.CASES:return r.unshift(n[0]),r;case nt.PUNCTUATED:return e===ot.TEXT?ir(r,n):r;case nt.APPL:return[r[0],n[0],r[1]];case nt.ROOT:return[r[0],r[1]];default:return r}}left(){super.left();const t=this.levels.indexOf(this.primaryId());if(null===t)return null;const e=this.levels.get(t-1);return e?this.singletonFocus(e):null}right(){super.right();const t=this.levels.indexOf(this.primaryId());if(null===t)return null;const e=this.levels.get(t+1);return e?this.singletonFocus(e):null}findFocusOnLevel(t){return this.singletonFocus(t.toString())}focusDomNodes(){return[this.getFocus().getDomPrimary()]}focusSemanticNodes(){return[this.getFocus().getSemanticPrimary()]}}class Qu extends zu{constructor(t,e,n,r){super(t,e,n,r),this.node=t,this.generator=e,this.highlighter=n,this.firstJump=null,this.key_=null,this.row_=0,this.currentTable_=null,this.keyMapping.set(Qs.ZERO,this.jumpCell.bind(this)),this.keyMapping.set(Qs.ONE,this.jumpCell.bind(this)),this.keyMapping.set(Qs.TWO,this.jumpCell.bind(this)),this.keyMapping.set(Qs.THREE,this.jumpCell.bind(this)),this.keyMapping.set(Qs.FOUR,this.jumpCell.bind(this)),this.keyMapping.set(Qs.FIVE,this.jumpCell.bind(this)),this.keyMapping.set(Qs.SIX,this.jumpCell.bind(this)),this.keyMapping.set(Qs.SEVEN,this.jumpCell.bind(this)),this.keyMapping.set(Qs.EIGHT,this.jumpCell.bind(this)),this.keyMapping.set(Qs.NINE,this.jumpCell.bind(this))}move(t){this.key_=t;const e=super.move(t);return this.modifier=!1,e}up(){return this.moved=qu.UP,this.eligibleCell_()?this.verticalMove_(!1):super.up()}down(){return this.moved=qu.DOWN,this.eligibleCell_()?this.verticalMove_(!0):super.down()}jumpCell(){if(!this.isInTable_()||null===this.key_)return this.getFocus();if(this.moved===qu.ROW){this.moved=qu.CELL;const t=this.key_-Qs.ZERO;return this.isLegalJump_(this.row_,t)?this.jumpCell_(this.row_,t):this.getFocus()}const t=this.key_-Qs.ZERO;return t>this.currentTable_.childNodes.length?this.getFocus():(this.row_=t,this.moved=qu.ROW,this.getFocus().clone())}undo(){const t=super.undo();return t===this.firstJump&&(this.firstJump=null),t}eligibleCell_(){const t=this.getFocus().getSemanticPrimary();return this.modifier&&t.type===nt.CELL&&-1!==Qu.ELIGIBLE_CELL_ROLES.indexOf(t.role)}verticalMove_(t){const e=this.previousLevel();if(!e)return null;const n=this.getFocus(),r=this.levels.indexOf(this.primaryId()),o=this.levels.pop(),i=this.levels.indexOf(e),s=this.levels.get(t?i+1:i-1);if(!s)return this.levels.push(o),null;this.setFocus(this.singletonFocus(s));const a=this.nextLevel();return a[r]?(this.levels.push(a),this.singletonFocus(a[r])):(this.setFocus(n),this.levels.push(o),null)}jumpCell_(t,e){this.firstJump?this.virtualize(!1):(this.firstJump=this.getFocus(),this.virtualize(!0));const n=this.currentTable_.id.toString();let r;do{r=this.levels.pop()}while(-1===r.indexOf(n));this.levels.push(r),this.setFocus(this.singletonFocus(n)),this.levels.push(this.nextLevel());const o=this.currentTable_.childNodes[t-1];return this.setFocus(this.singletonFocus(o.id.toString())),this.levels.push(this.nextLevel()),this.singletonFocus(o.childNodes[e-1].id.toString())}isLegalJump_(t,e){const n=q(this.getRebuilt().xml,"id",this.currentTable_.id.toString())[0];if(!n||n.hasAttribute("alternative"))return!1;const r=this.currentTable_.childNodes[t-1];if(!r)return!1;const o=q(n,"id",r.id.toString())[0];return!(!o||o.hasAttribute("alternative"))&&!(!r||!r.childNodes[e-1])}isInTable_(){let t=this.getFocus().getSemanticPrimary();for(;t;){if(-1!==Qu.ELIGIBLE_TABLE_TYPES.indexOf(t.type))return this.currentTable_=t,!0;t=t.parent}return!1}}Qu.ELIGIBLE_CELL_ROLES=[ot.DETERMINANT,ot.ROWVECTOR,ot.BINOMIAL,ot.SQUAREMATRIX,ot.MULTILINE,ot.MATRIX,ot.VECTOR,ot.CASES,ot.TABLE],Qu.ELIGIBLE_TABLE_TYPES=[nt.MULTILINE,nt.MATRIX,nt.VECTOR,nt.CASES,nt.TABLE];const Ju={dummy:(t,e,n,r)=>new Xu(t,e,n,r),semantic:(t,e,n,r)=>new Ku(t,e,n,r),syntax:(t,e,n,r)=>new zu(t,e,n,r),table:(t,e,n,r)=>new Qu(t,e,n,r)};class Zu{static stringify_(t){return t?t.toString():t}constructor(t,e){this.name=t,this.process=e.processor,this.postprocess=e.postprocessor||((t,e)=>t),this.processor=this.postprocess?function(t){return this.postprocess(this.process(t),t)}:this.process,this.print=e.print||Zu.stringify_,this.pprint=e.pprint||this.print}}Zu.LocalState={walker:null,speechGenerator:null,highlighter:null};class th extends Zu{static getKey_(t){return"string"==typeof t?Qs[t.toUpperCase()]:t}constructor(t,e){super(t,e),this.key=e.key||th.getKey_}}const eh=new Map;function nh(t){eh.set(t.name,t)}function rh(t){const e=eh.get(t);if(!e)throw new I("Unknown processor "+t);return e}function oh(t,e){const n=rh(t);try{return n.processor(e)}catch(t){if(t instanceof I)throw t;throw new I(`Processing error for expression\n ${e}`)}}function ih(t,e){const n=rh(t);try{const t=n.processor(e);return A.getInstance().options.pprint?n.pprint(t):n.print(t)}catch(t){if(t instanceof I)throw t;throw new I(`Processing error for expression\n ${e}`)}}function sh(t){return t.children?(t.children&&t.children.forEach(t=>t.child=!0),t.content&&t.content.forEach(t=>t.cont=!0),t.children=bc.combineContentChildren(t.type,t.role,t.content||[],t.children||[]),t.children.forEach(t=>sh(t)),t):t}function ah(t,e,n,r={}){var o;if(t.options=r,t.mactions=Ou(e,n),!1===r.enableSpeech)return;t.speech=Lu(n);const i=null===(o=n.childNodes[0])||void 0===o?void 0:o.getAttribute("id"),s=j(n,"href").length;if(s){const e=`${s} ${1===s?"link":"links"}`;t.speech[i]["postfix-none"]=t.speech[i]["postfix-none"]?t.speech[i]["postfix-none"]+`, ${e}`:e,t.speech[i]["postfix-ssml"]=t.speech[i]["postfix-ssml"]?t.speech[i]["postfix-ssml"]+` <break time="250ms"/> ${e}`:e}t.label=t.speech[i]["speech-none"]+(t.speech[i]["postfix-none"]?`, ${t.speech[i]["postfix-none"]}`:""),t.ssml=t.speech[i]["speech-ssml"]+(t.speech[i]["postfix-ssml"]?` <prosody pitch="+30%" rate="+20%"> ${t.speech[i]["postfix-ssml"]} </prosody>`:""),t.translations=Object.assign({},gt.MESSAGES.navigate)}nh(new Zu("semantic",{processor:function(t){return Qc(w(t),A.getInstance().options)},postprocessor:function(t,e){const n=A.getInstance().options.speech;if(n===u.NONE)return t;const r=X(t);let o=mu(r,!0);if(n===u.SHALLOW)return t.setAttribute("speech",ja(o)),t;const i=M(".//*[@id]",t),s=M(".//*[@id]",r);for(let t,e,n=0;t=i[n],e=s[n];n++)o=mu(e),t.setAttribute("speech",ja(o));return t},pprint:function(t){return V(t.toString())}})),nh(new Zu("speech",{processor:function(t){return ja(Ha(fu(Qc(w(t),A.getInstance().options),!0)))},pprint:function(t){const e=t.toString();return Va.get(A.getInstance().options.markup)instanceof ga?V(e):e}})),nh(new Zu("json",{processor:function(t){return Jc(w(t),A.getInstance().options).toJson()},postprocessor:function(t,e){const n=A.getInstance().options.speech;if(n===u.NONE)return t;const r=Qc(w(e),A.getInstance().options),o=mu(r);if(n===u.SHALLOW)return t.stree.speech=ja(o),t;const i=t=>{const e=mu(M(`.//*[@id=${t.id}]`,r)[0]);t.speech=ja(e),t.children&&t.children.forEach(i)};return i(t.stree),t},print:function(t){return JSON.stringify(t)},pprint:function(t){return JSON.stringify(t,null,2)}})),nh(new Zu("vis",{processor:function(t){const e=Jc(w(t),A.getInstance().options).toJson();return e.stree=sh(e.stree),e},print:function(t){return JSON.stringify(t)},pprint:function(t){return JSON.stringify(t,null,2)}})),nh(new Zu("description",{processor:function(t){return fu(Qc(w(t),A.getInstance().options),!0)},print:function(t){return JSON.stringify(t)},pprint:function(t){return JSON.stringify(t,null,2)}})),nh(new Zu("enriched",{processor:function(t){return function(t,e){const n=w(t);try{return Hl(n,e)}catch(t){return console.error(t),n}}(t,A.getInstance().options)},postprocessor:function(t,e){const n=tu(t);let r;switch(A.getInstance().options.speech){case u.NONE:break;case u.SHALLOW:r=Vu("Adhoc"),r.getSpeech(n,t);break;case u.DEEP:r=Vu("Tree"),r.getSpeech(t,t)}return t},pprint:function(t){return V(t.toString())}})),nh(new Zu("rebuild",{processor:function(t){return new ru(w(t)).stree.xml()},pprint:function(t){return V(t.toString())}})),nh(new Zu("walker",{processor:function(t){const e=Vu("Node");Zu.LocalState.speechGenerator=e,e.setOptions({modality:A.getInstance().options.modality,locale:A.getInstance().options.locale,domain:A.getInstance().options.domain,style:A.getInstance().options.style}),Zu.LocalState.highlighter=function(t,e,n){const r=new Wl(t,e),o="NativeMML"===n.renderer&&"Safari"===n.browser?"MML-CSS":"SVG"===n.renderer&&"v3"===n.browser?"SVG-V3":n.renderer,i=new(Ql[o]||Ql.NativeMML);return i.setColor(r),i}({color:"black"},{color:"white"},{renderer:"NativeMML"});const n=oh("enriched",t),r=function(t,e){const n=rh(t);return A.getInstance().options.pprint?n.pprint(e):n.print(e)}("enriched",n);return Zu.LocalState.walker=function(t,e,n,r,o){return(Ju[t.toLowerCase()]||Ju.dummy)(e,n,r,o)}(A.getInstance().options.walker,n,e,Zu.LocalState.highlighter,r),Zu.LocalState.walker},print:function(t){return Zu.LocalState.walker.speech()}})),nh(new th("move",{processor:function(t){if(!Zu.LocalState.walker)return null;return!1===Zu.LocalState.walker.move(t)?function(t){const e=Va.get(A.getInstance().options.markup);return e?e.error(t):""}(t):Zu.LocalState.walker.speech()}})),nh(new Zu("number",{processor:function(t){const e=parseInt(t,10);return isNaN(e)?"":gt.NUMBERS.numberToWords(e)}})),nh(new Zu("ordinal",{processor:function(t){const e=parseInt(t,10);return isNaN(e)?"":gt.NUMBERS.wordOrdinal(e)}})),nh(new Zu("numericOrdinal",{processor:function(t){const e=parseInt(t,10);return isNaN(e)?"":gt.NUMBERS.numericOrdinal(e)}})),nh(new Zu("vulgar",{processor:function(t){const[e,n]=t.split("/").map(t=>parseInt(t,10));return isNaN(e)||isNaN(n)?"":oh("speech",`<mfrac><mn>${e}</mn><mn>${n}</mn></mfrac>`)}})),nh(new Zu("latex",{processor:function(t){return"braille"===A.getInstance().options.modality&&"euro"===A.getInstance().options.locale||console.info("LaTeX input currently only works for Euro Braille output. Please use the latex-to-speech package from npm for general LaTeX input to SRE."),oh("speech",`<math data-latex="${t}"></math>`)}})),nh(new Zu("rebuildStree",{processor:function(t){return new ru(w(t))}})),nh(new Zu("speechStructure",{processor:function(t){const e=w(t);let n;try{n=new ru(e).stree.xml()}catch(t){n=Qc(e,A.getInstance().options)}return Ou(e,n),Lu(n)},print:function(t){return JSON.stringify(t)},pprint:function(t){return JSON.stringify(t,null,2)}})),nh(new Zu("workerSpeechStructure",{processor:function(t){const e=w(t);let n;try{n=new ru(e).stree.xml()}catch(t){n=Qc(e,A.getInstance().options)}A.getInstance().options.automark=!0;const r={};return ah(r,e,n),r},print:function(t){return JSON.stringify(t)},pprint:function(t){return JSON.stringify(t,null,2)}}));var ch=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}c((r=r.apply(t,e||[])).next())})};const lh=E.u.VERSION;function uh(t){return ch(this,void 0,void 0,function*(){return uc(t)})}function hh(){return function(){const t=A.getInstance().json();return t.json=p.f.jsonPath,t}()}function dh(){A.getInstance().reset()}function ph(){return ch(this,void 0,void 0,function*(){return uh({}).then(()=>b.getall())})}const fh=ic;function mh(t){return Oh("speech",t)}function gh(t){return Oh("semantic",t)}function Eh(t){return Oh("json",t)}function Nh(t){return Oh("vis",t)}function Sh(t){return Oh("description",t)}function Th(t){return Oh("enriched",t)}function Ih(t){return Oh("number",t)}function Ah(t){return Oh("ordinal",t)}function bh(t){return Oh("numericOrdinal",t)}function Rh(t){return Oh("vulgar",t)}function Oh(t,e){return oh(t,e)}const yh={};function Ch(t,e,r){switch(A.getInstance().mode){case n.ASYNC:return function(t,e,n){return ch(this,void 0,void 0,function*(){const r=yield p.f.fs.promises.readFile(e,{encoding:"utf8"}),o=ih(t,r);if(n)try{p.f.fs.promises.writeFile(n,o)}catch(t){throw new I("Can not write to file: "+n)}return o})}(t,e,r);case n.SYNC:return function(t,e,n){const r=function(t){let e;try{e=p.f.fs.readFileSync(t,{encoding:"utf8"})}catch(e){throw new I("Can not open file: "+t)}return e}(e),o=ih(t,r);if(n)try{p.f.fs.writeFileSync(n,o)}catch(t){throw new I("Can not write to file: "+n)}return o}(t,e,r);default:throw new I(`Cannot process files in ${A.getInstance().mode} mode`)}}function Lh(t){return ih("walker",t)}function Mh(t){return function(t,e){const n=rh(t),r=n instanceof th?n.key(e):e,o=n.processor(r);return A.getInstance().options.pprint?n.pprint(o):n.print(o)}("move",t)}function _h(t){const e=t||0;b.getall().then(()=>process.exit(e))}function vh(t){return Oh("speechStructure",t)}function wh(t,e){return ch(this,void 0,void 0,function*(){const n=w(t),r=new ru(n),o=vu(e);return e.domain2style=wu(o),Fh(n,r.stree.xml(),e)})}function Dh(t,e){return ch(this,void 0,void 0,function*(){const n=w(t),r=new ru(n),o=vu(e);return(e=Mu(e,o)).domain2style=wu(o),Fh(n,r.stree.xml(),e)})}function Ph(t,e,n){return ch(this,void 0,void 0,function*(){const r=w(t),o=new ru(r),i=vu(e);return e.style=_u(o.nodeDict[n],e),i[e.domain]=e.style,e.domain2style=wu(i),Fh(r,o.stree.xml(),e)})}function xh(t){return ch(this,void 0,void 0,function*(){return cu.getLocalePreferences()[t.locale]})}function Uh(t,e){return ch(this,void 0,void 0,function*(){var n;const r=w(t),o=new ru(r),i=null!==(n=o.stree.root.querySelectorAll(t=>t.id.toString()===e)[0])&&void 0!==n?n:o.stree.root;return cu.relevantPreferences(i)})}function Fh(t,e,n){return ch(this,void 0,void 0,function*(){var r;yield uh(n),A.getInstance().options.automark=!0;const o={};if(ah(o,t,e,n),!1===n.enableBraille)return o;yield uh({modality:"braille",locale:n.braille,domain:"default",style:"default"});const i=null===(r=e.childNodes[0])||void 0===r?void 0:r.getAttribute("id");return o.braille=function(t){fu(t,!0);const e=$a.getInstance().speechStructure;return e.completeModality("braille",fu),e.json(["none"])}(e),o.braillelabel=o.braille[i]["braille-none"],o})}yh.toSpeech=function(t,e){return Ch("speech",t,e)},yh.toSemantic=function(t,e){return Ch("semantic",t,e)},yh.toJson=function(t,e){return Ch("json",t,e)},yh.toDescription=function(t,e){return Ch("description",t,e)},yh.toEnriched=function(t,e){return Ch("enriched",t,e)};const kh=m;p.f.documentSupported||p.f.webworker?uh({mode:n.HTTP}).then(()=>uh({})):uh({mode:n.SYNC}).then(()=>uh({mode:n.ASYNC}));var Bh=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}c((r=r.apply(t,e||[])).next())})};class Gh{constructor(){this.setup={mode:n.SYNC},this.processors=[],this.output=Gh.process.stdout,this.dp=new p.f.xmldom.DOMParser({onError:(t,e)=>{throw new I("XML DOM error!")}})}set(t,e,n){this.setup[t]=void 0===e||e}processor(t){this.processors.push(t)}loadLocales(){return Bh(this,void 0,void 0,function*(){for(const t of E.u.LOCALES.keys())yield uh({locale:t})})}enumerate(){return Bh(this,arguments,void 0,function*(t=!1){const e=uh(this.setup),n=s.DEFAULT_ORDER.slice(0,-1);return(t?this.loadLocales():e).then(()=>b.getall().then(()=>{const t=n.map(t=>t.length),e=(e,n)=>{t[n]=Math.max.apply(null,Object.keys(e).map(t=>t.length).concat(t[n]))},r=(t,e)=>t+new Array(e-t.length+1).join(" ");let o=$a.getInstance().enumerate();o=Dn(o);const i=[];e(o,0);for(const[n,s]of Object.entries(o)){let a=!0;e(s,1);for(const[c,l]of Object.entries(s)){let s=!0;e(l,2);for(const[e,u]of Object.entries(l)){const l=Object.keys(u).sort();if("clearspeak"===e){let l=!0;const u=cu.getLocalePreferences(o)[n];if(!u)continue;for(const o of Object.values(u))i.push([r(a?n:"",t[0]),r(s?c:"",t[1]),r(l?e:"",t[2]),o.join(", ")]),a=!1,s=!1,l=!1}else i.push([r(a?n:"",t[0]),r(s?c:"",t[1]),r(e,t[2]),l.join(", ")]);a=!1,s=!1}}}let s=0;const a=n.map(e=>r(e,t[s++])),c=Gh.commander.opts().pprint,l=t.map(t=>new Array(t+1).join(c?"-":"="));c||(l[s-1]=l[s-1]+"========================"),i.unshift(l),i.unshift(a);let u=i.map(t=>t.join(" | "));c&&(u=u.map(t=>`| ${t} |`),u.unshift(`# Options SRE v${lh}\n`)),console.info(u.join("\n"))}))})}execute(t){b.getall().then(()=>{this.runProcessors_((t,e)=>this.output.write(Ch(t,e)+"\n"),t)})}readline(){Gh.process.stdin.setEncoding("utf8");const t=p.f.extRequire("readline").createInterface({input:Gh.process.stdin,output:this.output});let e="";t.on("line",(n=>{e+=n,this.readExpression_(e)&&t.close()}).bind(this)),t.on("close",(()=>{this.runProcessors_((e,n)=>{t.output.write(ih(e,n)+"\n")},e),ph().then(()=>g.getInstance().exit(()=>_h(0)))}).bind(this))}commandLine(){return Bh(this,void 0,void 0,function*(){const t=Gh.commander,n=o,r=(t=>(e,n)=>this.set(t,e,n)).bind(this),i=this.processor.bind(this);t.version(n.version).usage("[options] <file ...>").option("-i, --input [name]","Input file [name]. (Deprecated)").option("-o, --output [name]","Output file [name]. Defaults to stdout.").option("-d, --domain [name]","Speech rule set [name]. See --options for details.",r(e.DOMAIN),s.DEFAULT_VALUES[e.DOMAIN]).option("-s, --style [name]","Speech style [name]. See --options for details.",r(e.STYLE),s.DEFAULT_VALUES[e.STYLE]).option("-c, --locale [code]","Locale [code].",r(e.LOCALE),s.DEFAULT_VALUES[e.LOCALE]).option("-b, --modality [name]","Modality [name].",r(e.MODALITY),s.DEFAULT_VALUES[e.MODALITY]).option("-k, --markup [name]","Generate speech output with markup tags.",r("markup"),"none").option("-e, --automark","Automatically set marks for external reference.",r("automark")).option("-L, --linebreaks","Linebreak marking in 2D output.",r("linebreaks")).option("-r, --rate [value]","Base rate [value] for tagged speech output.",r("rate"),"100").option("-p, --speech","Generate speech output (default).",()=>i("speech")).option("-a, --audit","Generate auditory descriptions (JSON format).",()=>i("description")).option("-j, --json","Generate JSON of semantic tree.",()=>i("json")).option("-J, --vis","Generate JSON for semantic visualization.",()=>i("vis")).option("-x, --xml","Generate XML of semantic tree.",()=>i("semantic")).option("-m, --mathml","Generate enriched MathML.",()=>i("enriched")).option("-u, --rebuild","Rebuild semantic tree from enriched MathML.",()=>i("rebuild")).option("-T, --speechStructure","Return speech structure only.",()=>i("speechStructure")).option("-W, --workerStructure","Return worker speech structure only.",()=>i("workerSpeechStructure")).option("-t, --latex","Accepts LaTeX input for certain locale/modality combinations.",()=>i("latex")).option("-g, --generate <depth>","Include generated speech in enriched MathML (with -m option only).",r("speech"),"none").option("-w, --structure","Include structure attribute in enriched MathML (with -m option only).",r("structure")).option("-A, --aria","Include aria tree annotations MathML (with -m and -w option only).",r("aria")).option("-P, --pprint","Pretty print output whenever possible.",r("pprint")).option("-f, --rules [name]","Loads a local rule file [name].",r("rules")).option("-C, --subiso [name]","Supplementary country code (or similar) for the given locale.",r("subiso")).option("-N, --number","Translate number to word.",()=>i("number")).option("-O, --ordinal","Translate number to ordinal.",()=>i("ordinal"),"ordinal").option("-S, --numeric","Translate number to numeric ordinal.",()=>i("numericOrdinal")).option("-F, --vulgar","Translate vulgar fraction to word. Provide vulgar fraction as slash seperated numbers.",()=>i("vulgar")).option("-v, --verbose","Verbose mode.").option("-l, --log [name]","Log file [name].").option("--opt","List engine setup options. Output as markdown with -P option.").option("--opt-all","List engine setup options for all available locales. Output as markdown with -P option.").on("option:opt",()=>{this.enumerate().then(()=>_h(0))}).on("option:opt-all",()=>{this.enumerate(!0).then(()=>_h(0))}).parse(Gh.process.argv),yield ph().then(()=>uh(this.setup));const a=Gh.commander.opts();a.output&&(this.output=p.f.fs.createWriteStream(a.output)),a.verbose&&(yield g.getInstance().init(a.log)),a.input&&this.execute(a.input),Gh.commander.args.length?(Gh.commander.args.forEach(this.execute.bind(this)),ph().then(()=>g.getInstance().exit(()=>_h(0)))):this.readline()})}runProcessors_(t,e){try{this.processors.length||this.processors.push("speech"),e&&this.processors.forEach(n=>t(n,e))}catch(t){console.error(t.name+": "+t.message),g.getInstance().exit(()=>Gh.process.exit(1))}}readExpression_(t){try{const e=t.replace(/(&|#|;)/g,"");this.dp.parseFromString(e,"text/xml")}catch(t){return!1}return!0}}Gh.process=p.f.extRequire("process"),Gh.commander=p.f.documentSupported||p.f.webworker?null:p.f.extRequire("commander").program;const Vh=Gh,Hh=E.u})(),__webpack_exports__})());